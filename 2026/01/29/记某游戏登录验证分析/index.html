<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>记某游戏登录验证分析 | Illunight的收藏品</title><meta name="author" content="Illunight"><meta name="copyright" content="Illunight"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="终于放寒假了……重操旧业，写点博客。 记录一款一直有在追踪的Unity游戏，它发布公开的windows版和赞助特供的安卓版，为了防止一人赞助到处分享，安卓版在进入主界面之前就会要求登录认证，windows版在进入画廊时要求认证。可以通过Patreon提供的接口在线验证，也可以采取半离线验证的方式，将一串序列号发送给Discord的机器人，机器人返回验证码，使用验证码登录。 最开始它用Mono架构，">
<meta property="og:type" content="article">
<meta property="og:title" content="记某游戏登录验证分析">
<meta property="og:url" content="https://xelinquency.github.io/2026/01/29/%E8%AE%B0%E6%9F%90%E6%B8%B8%E6%88%8F%E7%99%BB%E5%BD%95%E9%AA%8C%E8%AF%81%E5%88%86%E6%9E%90/">
<meta property="og:site_name" content="Illunight的收藏品">
<meta property="og:description" content="终于放寒假了……重操旧业，写点博客。 记录一款一直有在追踪的Unity游戏，它发布公开的windows版和赞助特供的安卓版，为了防止一人赞助到处分享，安卓版在进入主界面之前就会要求登录认证，windows版在进入画廊时要求认证。可以通过Patreon提供的接口在线验证，也可以采取半离线验证的方式，将一串序列号发送给Discord的机器人，机器人返回验证码，使用验证码登录。 最开始它用Mono架构，">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://xelinquency.github.io/img/404.jpg">
<meta property="article:published_time" content="2026-01-29T06:41:41.000Z">
<meta property="article:modified_time" content="2026-02-02T10:29:25.085Z">
<meta property="article:author" content="Illunight">
<meta property="article:tag" content="2026">
<meta property="article:tag" content="Reverse">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://xelinquency.github.io/img/404.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "记某游戏登录验证分析",
  "url": "https://xelinquency.github.io/2026/01/29/%E8%AE%B0%E6%9F%90%E6%B8%B8%E6%88%8F%E7%99%BB%E5%BD%95%E9%AA%8C%E8%AF%81%E5%88%86%E6%9E%90/",
  "image": "https://xelinquency.github.io/img/404.jpg",
  "datePublished": "2026-01-29T06:41:41.000Z",
  "dateModified": "2026-02-02T10:29:25.085Z",
  "author": [
    {
      "@type": "Person",
      "name": "Illunight",
      "url": "https://xelinquency.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="https://xelinquency.github.io/2026/01/29/%E8%AE%B0%E6%9F%90%E6%B8%B8%E6%88%8F%E7%99%BB%E5%BD%95%E9%AA%8C%E8%AF%81%E5%88%86%E6%9E%90/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="DBE1_SX4G9tMN1JolnkxhQxmkqC7KxJHBS654vVGjaE"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.json","preload":false,"top_n_per_article":1,"unescape":true,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: true,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '记某游戏登录验证分析',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/icon.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">12</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/%E7%AC%94%E8%AE%B0/"><i class="fa-fw fas fa-pen-nib"></i><span> 笔记</span></a></div><div class="menus_item"><a class="site-page" href="/friends"><i class="fa-fw fas fa-users-line"></i><span> 友链</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 列表</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/game/"><i class="fa-fw fas fa-paw"></i><span> 游戏</span></a></li><li><a class="site-page child" href="/special/"><i class="fa-fw fas fa-clipboard-question"></i><span> ???</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/404.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/favicon.ico" alt="Logo"><span class="site-name">Illunight的收藏品</span></a><a class="nav-page-title" href="/"><span class="site-name">记某游戏登录验证分析</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/%E7%AC%94%E8%AE%B0/"><i class="fa-fw fas fa-pen-nib"></i><span> 笔记</span></a></div><div class="menus_item"><a class="site-page" href="/friends"><i class="fa-fw fas fa-users-line"></i><span> 友链</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 列表</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/game/"><i class="fa-fw fas fa-paw"></i><span> 游戏</span></a></li><li><a class="site-page child" href="/special/"><i class="fa-fw fas fa-clipboard-question"></i><span> ???</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">记某游戏登录验证分析</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2026-01-29T06:41:41.000Z" title="发表于 2026-01-29 14:41:41">2026-01-29</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2026-02-02T10:29:25.085Z" title="更新于 2026-02-02 18:29:25">2026-02-02</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">6.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>29分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p>终于放寒假了……重操旧业，写点博客。</p>
<p>记录一款一直有在追踪的Unity游戏，它发布公开的windows版和赞助特供的安卓版，为了防止一人赞助到处分享，安卓版在进入主界面之前就会要求登录认证，windows版在进入画廊时要求认证。可以通过Patreon提供的接口在线验证，也可以采取半离线验证的方式，将一串序列号发送给Discord的机器人，机器人返回验证码，使用验证码登录。</p>
<p>最开始它用Mono架构，主要的函数都存储在Assembly-CSharp.dll中，使用dnspy可以看到几乎完全一致的源码，修改也很方便；几个版本之后进行了一些混淆，但是函数逻辑没有大改，审计一下还是可以明白——主要是那时候没有ChatGPT老师和Gemini老师，单单把函数名和类名混淆就能够难倒我了。最后它终于用上了il2cpp，源码全都没有了，只好看汇编代码，慢慢啃吧。Gemini老师救我！</p>
<p>il2cpp时代也一直有一些破解版流出，多半是直接跳过登录界面，并设置最终的返回值为1(True)。这种修改程序控制流的方法很容易被针对，可能引发闪退等，因此还需要将验证时涉及的所有函数检查一遍，绕过所有闪退的分支。</p>
<p>笔者能力不太足，不太会分析完整流程，全靠Gemini和IDA mcp。动控制流在闪退和卡死之间反复横跳，就是进不去，于是不如另辟蹊径，看看这个“半”离线的验证有多离线。为了不读ARM的汇编，就先拿windows版试试水，我实在不想看到各种奇怪的TBNZ了。</p>
<p>Gemini说这个方法全程没有联网通信，让我看看。</p>
<h2 id="老师我不想再看到sub-xxx了">老师我不想再看到sub_xxx了</h2>
<p>第一步当然是用global-metadata.dat还原一些函数符号和字符串，由于il2cpp将C#代码转换成了native的C++，但是C#的特性不能丢失，因此需要保留符号，大部分函数都可以用metadata还原，还原之后的结果很鲜明，名字很清晰的是库函数，乱糟糟的是游戏的函数，这也能减轻一些分析工作量。</p>
<p>感谢我们伟大的<a target="_blank" rel="noopener" href="https://github.com/Perfare/Il2CppDumper">Il2CppDumper</a>…它导出了四个文件和一个文件夹，分别是</p>
<ul>
<li>
<p>il2cpp.h：头文件，包含程序中的结构体、共同体等数据结构。例如下面这个不知名结构体（）</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MethodInfo_12D1B80</span> &#123;</span></span><br><span class="line">	Il2CppMethodPointer methodPointer;</span><br><span class="line">	Il2CppMethodPointer virtualMethodPointer;</span><br><span class="line">	InvokerMethod invoker_method;</span><br><span class="line">	<span class="type">const</span> <span class="type">char</span>* name;</span><br><span class="line">	System_Collections_Generic_List_T__c *klass;</span><br><span class="line">	<span class="type">const</span> Il2CppType *return_type;</span><br><span class="line">	<span class="type">const</span> Il2CppType** parameters;</span><br><span class="line">	<span class="type">const</span> Il2CppRGCTXData* rgctx_data;</span><br><span class="line">	<span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">	&#123;</span></span><br><span class="line">		<span class="type">const</span> <span class="type">void</span>* genericMethod;</span><br><span class="line">		<span class="type">const</span> <span class="type">void</span>* genericContainerHandle;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="type">uint32_t</span> token;</span><br><span class="line">	<span class="type">uint16_t</span> flags;</span><br><span class="line">	<span class="type">uint16_t</span> iflags;</span><br><span class="line">	<span class="type">uint16_t</span> slot;</span><br><span class="line">	<span class="type">uint8_t</span> parameters_count;</span><br><span class="line">	<span class="type">uint8_t</span> bitflags;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>script.json：函数签名与地址的对应关系，虽然看起来还是有很多奇怪的地方，比如下划线之类的。具体的细节等到IDA中再看。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;Address&quot;</span><span class="punctuation">:</span> <span class="number">8404496</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;Name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;StoryCharacterAppearance.KJBNJFJGOBF$$LFABPAFPJML&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;Signature&quot;</span><span class="punctuation">:</span> <span class="string">&quot;UnityEngine_Sprite_o* StoryCharacterAppearance_KJBNJFJGOBF__LFABPAFPJML (StoryCharacterAppearance_KJBNJFJGOBF_o* __this, int32_t FJOKBEOHOMP, System_String_o* GBAGOEMADCD, const MethodInfo* method);&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;TypeSignature&quot;</span><span class="punctuation">:</span> <span class="string">&quot;iiiii&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;Address&quot;</span><span class="punctuation">:</span> <span class="number">8398384</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;Name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;StoryCharacterAppearance.KJBNJFJGOBF$$HAABBCKKNNE&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;Signature&quot;</span><span class="punctuation">:</span> <span class="string">&quot;System_ValueTuple_int__Sprite__o StoryCharacterAppearance_KJBNJFJGOBF__HAABBCKKNNE (StoryCharacterAppearance_KJBNJFJGOBF_o* __this, System_String_o* PAENHOCOOGG, System_String_o* GBAGOEMADCD, const MethodInfo* method);&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;TypeSignature&quot;</span><span class="punctuation">:</span> <span class="string">&quot;iiiii&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;Address&quot;</span><span class="punctuation">:</span> <span class="number">8407424</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;Name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;StoryCharacterAppearance.KJBNJFJGOBF$$NJONCPKBFPP&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;Signature&quot;</span><span class="punctuation">:</span> <span class="string">&quot;UnityEngine_Sprite_o* StoryCharacterAppearance_KJBNJFJGOBF__NJONCPKBFPP (StoryCharacterAppearance_KJBNJFJGOBF_o* __this, int32_t FJOKBEOHOMP, System_String_o* GBAGOEMADCD, const MethodInfo* method);&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;TypeSignature&quot;</span><span class="punctuation">:</span> <span class="string">&quot;iiiii&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>stringliteral.json：字符串，这些字符串和metadata中的并不相同，更像是库函数会用到的字符串，总之也导出了。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Test Error from Thread&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;address&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x2D9DFC0&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;CharIndex&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;address&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x2D9DFE8&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;align-self&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;address&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x2D9DFF0&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;IsLatin-1Supplement&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;address&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x2D9E020&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;size must be \u003C= buffer.Length - offset&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;address&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x2D9E028&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot; standalone=&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;address&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x2D9E050&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>dump.cs：恢复出的大致C#代码，代码中没有函数体，因此还是只能去看汇编。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Namespace: Gamexxx.View</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">LoginView</span> : <span class="title">ViewItem</span> <span class="comment">// TypeDefIndex: 2206</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">// Fields</span></span><br><span class="line">	<span class="keyword">private</span> Patreon NDODOCMEOPD; <span class="comment">// 0x48</span></span><br><span class="line">	<span class="keyword">private</span> Action MMJAKNHAJAN; <span class="comment">// 0x50</span></span><br><span class="line">	<span class="keyword">private</span> Text PPMEGACKABO; <span class="comment">// 0x58</span></span><br><span class="line">	<span class="keyword">private</span> InputField LHNNLPOPGNG; <span class="comment">// 0x60</span></span><br><span class="line">	<span class="keyword">private</span> GameObject ELCLHBECKLJ; <span class="comment">// 0x68</span></span><br><span class="line">	<span class="keyword">private</span> GameObject CIFEJIHJJOF; <span class="comment">// 0x70</span></span><br><span class="line">	<span class="keyword">private</span> <span class="built_in">string</span> OPDJLGGICOL; <span class="comment">// 0x78</span></span><br><span class="line">	[<span class="meta">ConversationPopup(False, True)</span>]</span><br><span class="line">	<span class="keyword">private</span> <span class="built_in">string</span> MOEDNKCPNEO; <span class="comment">// 0x80</span></span><br><span class="line">	<span class="keyword">private</span> CanvasGroup DAKKHAJGMNI; <span class="comment">// 0x88</span></span><br><span class="line">	<span class="keyword">private</span> GameObject MOCMFKLDAAH; <span class="comment">// 0x90</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// Methods</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// RVA: 0x690CB0 Offset: 0x6900B0 VA: 0x180690CB0</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">DPKPEDADGNP</span>()</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// RVA: 0x6925A0 Offset: 0x6919A0 VA: 0x1806925A0</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">IPHBDJPAOAA</span>(<span class="params"><span class="built_in">string</span> NMIMHINJJHA</span>)</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// RVA: 0x694180 Offset: 0x693580 VA: 0x180694180</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">OFGJPKPADJH</span>(<span class="params">Transform DICMALINFFD</span>)</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// RVA: 0x692740 Offset: 0x691B40 VA: 0x180692740</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">JFLGMGPBJEI</span>()</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// RVA: 0x5ED1B0 Offset: 0x5EC5B0 VA: 0x1805ED1B0</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">JJJBJAHFFLO</span>()</span> &#123; &#125;</span><br><span class="line">    </span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>DummyDll：将大的GameAssembly.dll拆解成Mono架构的小dll，这样我们可以只专注于Assembly-CSharp.dll，不用管其他的库函数。当然，这些小dll用dnspy打开看也没有函数体。</p>
</li>
</ul>
<h2 id="快学啊IDA">快学啊IDA</h2>
<p>Il2CppDumper附带一些ida_py3.py之类的脚本，可以将提取出的信息接入IDA中。</p>
<p>（十万个sub_xxx谁敢看）</p>
<p><img src="noscript.png" alt="noscript"></p>
<p>选中File-&gt;Script file…，再选中ida_with_struct_py3.py，将刚生成的script.json和il2cpp.h选上，稍等片刻，我们就有了一些写着Unity的方法，这些名字不明不白的是混淆后的类和函数。</p>
<p><img src="scriptdone.png" alt="scriptdone"></p>
<h2 id="我们的目标是：Discord验证！">我们的目标是：Discord验证！</h2>
<p>随便看看没发现什么，Shift+F12也没搜到这些字符串，看来另有玄机。经过测试，直接点击log in会提示Empty String，随便输入code会提示This code is incorrect，直接全文搜索一下这俩，Ctrl+F大法好。</p>
<p><img src="login.png" alt="login"></p>
<p><img src="string.png" alt="string"></p>
<p>搜到了一个Init，看起来是测bug用的？不管，总之是看到奇怪的<code>StringLiteral_11511</code>，点进去发现这也不是具体的字符串，只是一个数值，但是注释里有这个字符串。咨询了Gemini知道它对应的字符串存储在metadata中，如果要修改，应该去找metadata。</p>
<p><img src="string2.png" alt="string2"></p>
<p>按X查一个交叉引用。同样的方法搜索一下Empty string。</p>
<p><img src="string3.png" alt="string3"></p>
<p><img src="string4.png" alt="string4"></p>
<p>同时出现在这两个字符串的xref的只有<code>MAPMGCMPMAM$$MDMJCNKJPBD</code>，我们先看这个函数。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line">il2cpp:0000000180805F30 ; bool MAPMGCMPMAM__MDMJCNKJPBD(System_String_o *HBLNEJNOOBL, const MethodInfo *method)</span><br><span class="line">il2cpp:0000000180805F30 MAPMGCMPMAM$$MDMJCNKJPBD proc near      ; CODE XREF: Gamexxx_View_LoginView$$DIICNKOGNAJ+2A↑p</span><br><span class="line">il2cpp:0000000180805F30                                         ; Gamexxx_View_LoginView$$DOFKAGPLKEH+2A↑p ...</span><br><span class="line">il2cpp:0000000180805F30                 push    rbx</span><br><span class="line">il2cpp:0000000180805F32                 sub     rsp, 20h</span><br><span class="line">il2cpp:0000000180805F36                 cmp     cs:byte_182F66C0C, 0</span><br><span class="line">il2cpp:0000000180805F3D                 mov     rbx, rcx</span><br><span class="line">il2cpp:0000000180805F40                 jnz     short loc_180805F85</span><br><span class="line">il2cpp:0000000180805F42                 lea     rcx, Method$EGJHFIOEIAD_IIPIJJMJOLF_OJFCJJBIDAK___ ; Method$EGJHFIOEIAD.IIPIJJMJOLF&lt;OJFCJJBIDAK&gt;()</span><br><span class="line">il2cpp:0000000180805F49                 call    sub_180290560</span><br><span class="line">il2cpp:0000000180805F4E                 lea     rcx, EGJHFIOEIAD_TypeInfo ; EGJHFIOEIAD_TypeInfo</span><br><span class="line">il2cpp:0000000180805F55                 call    sub_180290560</span><br><span class="line">il2cpp:0000000180805F5A                 lea     rcx, Singleton_ViewManager__TypeInfo ; Singleton&lt;ViewManager&gt;_TypeInfo</span><br><span class="line">il2cpp:0000000180805F61                 call    sub_180290560</span><br><span class="line">il2cpp:0000000180805F66                 lea     rcx, StringLiteral_13071 ; Empty String.</span><br><span class="line">il2cpp:0000000180805F6D                 call    sub_180290560</span><br><span class="line">il2cpp:0000000180805F72                 lea     rcx, StringLiteral_11511 ; This code is incorrect, please check and try again.</span><br><span class="line">il2cpp:0000000180805F79                 call    sub_180290560</span><br><span class="line">il2cpp:0000000180805F7E                 mov     cs:byte_182F66C0C, 1</span><br><span class="line">il2cpp:0000000180805F85</span><br><span class="line">il2cpp:0000000180805F85 loc_180805F85:                          ; CODE XREF: MAPMGCMPMAM$$MDMJCNKJPBD+10↑j</span><br><span class="line">il2cpp:0000000180805F85                 test    rbx, rbx</span><br><span class="line">il2cpp:0000000180805F88                 jz      loc_1808060B9</span><br><span class="line">il2cpp:0000000180805F8E                 cmp     dword ptr [rbx+10h], 0</span><br><span class="line">il2cpp:0000000180805F92                 jz      loc_180806089</span><br><span class="line">il2cpp:0000000180805F98                 movzx   ecx, cs:byte_182F66BFE</span><br><span class="line">il2cpp:0000000180805F9F                 test    cl, cl</span><br><span class="line">il2cpp:0000000180805FA1                 jnz     short loc_180805FB7</span><br><span class="line">il2cpp:0000000180805FA3                 lea     rcx, MAPMGCMPMAM_TypeInfo ; MAPMGCMPMAM_TypeInfo</span><br><span class="line">il2cpp:0000000180805FAA                 call    sub_180290560</span><br><span class="line">il2cpp:0000000180805FAF                 mov     cl, 1</span><br><span class="line">il2cpp:0000000180805FB1                 mov     cs:byte_182F66BFE, cl</span><br><span class="line">il2cpp:0000000180805FB7</span><br><span class="line">il2cpp:0000000180805FB7 loc_180805FB7:                          ; CODE XREF: MAPMGCMPMAM$$MDMJCNKJPBD+71↑j</span><br><span class="line">il2cpp:0000000180805FB7                 mov     rdx, cs:MAPMGCMPMAM_TypeInfo ; MAPMGCMPMAM_TypeInfo</span><br><span class="line">il2cpp:0000000180805FBE                 mov     rax, [rdx+0B8h]</span><br><span class="line">il2cpp:0000000180805FC5                 mov     r8, [rax]</span><br><span class="line">il2cpp:0000000180805FC8                 test    r8, r8</span><br><span class="line">il2cpp:0000000180805FCB                 jz      loc_180806081</span><br><span class="line">il2cpp:0000000180805FD1                 cmp     qword ptr [r8+10h], 0</span><br><span class="line">il2cpp:0000000180805FD6                 jz      loc_180806081</span><br><span class="line">il2cpp:0000000180805FDC                 test    cl, cl</span><br><span class="line">il2cpp:0000000180805FDE                 jnz     short loc_180805FFA</span><br><span class="line">il2cpp:0000000180805FE0                 lea     rcx, MAPMGCMPMAM_TypeInfo ; MAPMGCMPMAM_TypeInfo</span><br><span class="line">il2cpp:0000000180805FE7                 call    sub_180290560</span><br><span class="line">il2cpp:0000000180805FEC                 mov     rdx, cs:MAPMGCMPMAM_TypeInfo ; MAPMGCMPMAM_TypeInfo</span><br><span class="line">il2cpp:0000000180805FF3                 mov     cs:byte_182F66BFE, 1</span><br><span class="line">il2cpp:0000000180805FFA</span><br><span class="line">il2cpp:0000000180805FFA loc_180805FFA:                          ; CODE XREF: MAPMGCMPMAM$$MDMJCNKJPBD+AE↑j</span><br><span class="line">il2cpp:0000000180805FFA                 mov     rax, [rdx+0B8h]</span><br><span class="line">il2cpp:0000000180806001                 mov     rcx, [rax]</span><br><span class="line">il2cpp:0000000180806004                 test    rcx, rcx</span><br><span class="line">il2cpp:0000000180806007                 jz      loc_1808060B9</span><br><span class="line">il2cpp:000000018080600D                 mov     rcx, [rcx+10h]  ; this</span><br><span class="line">il2cpp:0000000180806011                 test    rcx, rcx</span><br><span class="line">il2cpp:0000000180806014                 jz      loc_1808060B9</span><br><span class="line">il2cpp:000000018080601A                 xor     r8d, r8d        ; method</span><br><span class="line">il2cpp:000000018080601D                 mov     rdx, rbx        ; HBLNEJNOOBL</span><br><span class="line">il2cpp:0000000180806020                 call    FJFKHBFABDJ$$MDMJCNKJPBD</span><br><span class="line">il2cpp:0000000180806025                 test    al, al</span><br><span class="line">il2cpp:0000000180806027                 jz      short loc_180806059</span><br><span class="line">il2cpp:0000000180806029                 xor     ecx, ecx        ; method</span><br><span class="line">il2cpp:000000018080602B                 call    MAPMGCMPMAM$$HGJLFCJDLHJ</span><br><span class="line">il2cpp:0000000180806030 ; ---------------------------------------------------------------------------</span><br><span class="line">il2cpp:0000000180806030                 mov     rcx, cs:EGJHFIOEIAD_TypeInfo ; EGJHFIOEIAD_TypeInfo</span><br><span class="line">il2cpp:0000000180806037                 cmp     dword ptr [rcx+0E4h], 0</span><br><span class="line">il2cpp:000000018080603E                 jnz     short loc_180806045</span><br><span class="line">il2cpp:0000000180806040                 call    il2cpp_runtime_class_init</span><br><span class="line">il2cpp:0000000180806045</span><br><span class="line">il2cpp:0000000180806045 loc_180806045:                          ; CODE XREF: MAPMGCMPMAM$$MDMJCNKJPBD+10E↑j</span><br><span class="line">il2cpp:0000000180806045                 mov     rcx, cs:Method$EGJHFIOEIAD_IIPIJJMJOLF_OJFCJJBIDAK___ ; method</span><br><span class="line">il2cpp:000000018080604C                 call    EGJHFIOEIAD$$IIPIJJMJOLF_object__6452636656</span><br><span class="line">il2cpp:0000000180806051                 mov     al, 1</span><br><span class="line">il2cpp:0000000180806053                 add     rsp, 20h</span><br><span class="line">il2cpp:0000000180806057                 pop     rbx</span><br><span class="line">il2cpp:0000000180806058                 retn</span><br><span class="line">il2cpp:0000000180806059 ; ---------------------------------------------------------------------------</span><br><span class="line">il2cpp:0000000180806059</span><br><span class="line">il2cpp:0000000180806059 loc_180806059:                          ; CODE XREF: MAPMGCMPMAM$$MDMJCNKJPBD+F7↑j</span><br><span class="line">il2cpp:0000000180806059                 mov     rax, cs:Singleton_ViewManager__TypeInfo ; Singleton&lt;ViewManager&gt;_TypeInfo</span><br><span class="line">il2cpp:0000000180806060                 mov     rcx, [rax+0B8h]</span><br><span class="line">il2cpp:0000000180806067                 mov     rcx, [rcx]      ; this</span><br><span class="line">il2cpp:000000018080606A                 test    rcx, rcx</span><br><span class="line">il2cpp:000000018080606D                 jz      short loc_1808060B9</span><br><span class="line">il2cpp:000000018080606F                 mov     rdx, cs:StringLiteral_11511 ; OIBNBEKDHJK</span><br><span class="line">il2cpp:0000000180806076                 xor     r9d, r9d        ; method</span><br><span class="line">il2cpp:0000000180806079                 xor     r8d, r8d        ; NOFFKECEGCF</span><br><span class="line">il2cpp:000000018080607C                 call    ViewManager$$ShowFadeOutTip</span><br><span class="line">il2cpp:0000000180806081</span><br><span class="line">il2cpp:0000000180806081 loc_180806081:                          ; CODE XREF: MAPMGCMPMAM$$MDMJCNKJPBD+9B↑j</span><br><span class="line">il2cpp:0000000180806081                                         ; MAPMGCMPMAM$$MDMJCNKJPBD+A6↑j</span><br><span class="line">il2cpp:0000000180806081                 xor     al, al</span><br><span class="line">il2cpp:0000000180806083                 add     rsp, 20h</span><br><span class="line">il2cpp:0000000180806087                 pop     rbx</span><br><span class="line">il2cpp:0000000180806088                 retn</span><br><span class="line">il2cpp:0000000180806089 ; ---------------------------------------------------------------------------</span><br><span class="line">il2cpp:0000000180806089</span><br><span class="line">il2cpp:0000000180806089 loc_180806089:                          ; CODE XREF: MAPMGCMPMAM$$MDMJCNKJPBD+62↑j</span><br><span class="line">il2cpp:0000000180806089                 mov     rax, cs:Singleton_ViewManager__TypeInfo ; Singleton&lt;ViewManager&gt;_TypeInfo</span><br><span class="line">il2cpp:0000000180806090                 mov     rcx, [rax+0B8h]</span><br><span class="line">il2cpp:0000000180806097                 mov     rcx, [rcx]      ; this</span><br><span class="line">il2cpp:000000018080609A                 test    rcx, rcx</span><br><span class="line">il2cpp:000000018080609D                 jz      short loc_1808060B9</span><br><span class="line">il2cpp:000000018080609F                 mov     rdx, cs:StringLiteral_13071 ; OIBNBEKDHJK</span><br><span class="line">il2cpp:00000001808060A6                 xor     r9d, r9d        ; method</span><br><span class="line">il2cpp:00000001808060A9                 xor     r8d, r8d        ; NOFFKECEGCF</span><br><span class="line">il2cpp:00000001808060AC                 call    ViewManager$$ShowFadeOutTip</span><br><span class="line">il2cpp:00000001808060B1                 xor     al, al</span><br><span class="line">il2cpp:00000001808060B3                 add     rsp, 20h</span><br><span class="line">il2cpp:00000001808060B7                 pop     rbx</span><br><span class="line">il2cpp:00000001808060B8                 retn</span><br><span class="line">il2cpp:00000001808060B9 ; ---------------------------------------------------------------------------</span><br><span class="line">il2cpp:00000001808060B9</span><br><span class="line">il2cpp:00000001808060B9 loc_1808060B9:                          ; CODE XREF: MAPMGCMPMAM$$MDMJCNKJPBD+58↑j</span><br><span class="line">il2cpp:00000001808060B9                                         ; MAPMGCMPMAM$$MDMJCNKJPBD+D7↑j ...</span><br><span class="line">il2cpp:00000001808060B9                 call    sub_180290800</span><br><span class="line">il2cpp:00000001808060B9 ; ---------------------------------------------------------------------------</span><br><span class="line">il2cpp:00000001808060BE                 db 0CCh</span><br><span class="line">il2cpp:00000001808060BF algn_1808060BF:                         ; DATA XREF: .pdata:0000000183295ACC↓o</span><br><span class="line">il2cpp:00000001808060BF                 align 20h</span><br><span class="line">il2cpp:00000001808060BF MAPMGCMPMAM$$MDMJCNKJPBD endp</span><br></pre></td></tr></table></figure>
<p>由于metadata的信息都在注释里，汇编实际上比F5反编译包含了更多的信息，或者实在不行让AI帮忙也可。在注释中看到了LoginView，这个函数多半与登录有关联了。</p>
<p>开头一段不断重复<code>lea xxx</code>和<code>call sub_180290560</code>，推测是在绑定具体的值，获取之后就设置<code>cs:byte_182F66C0C</code>为1，再次调用该函数不必重复获取。<code>test  rbx, rbx</code>判断字符串指针<code>*HBLNEJNOOBL</code>是否为空，<code>cmp  dword ptr [rbx+10h], 0</code>比较字符串长度是否为0。指针为空属于异常，将进入<code>sub_180290800</code>，这不在我们的分析范围，因此我们从字符串长度为0开始。</p>
<h3 id="字符串长度为0">字符串长度为0</h3>
<p>这部分相对简单，进入<code>loc_180806089</code>后最终call了<code>ViewManager$$ShowFadeOutTip</code>，参数用到了<code>cs:StringLiteral_13071</code>，也就是 <strong>Empty String.</strong> ，可以猜测这就是弹出通知的函数。</p>
<h3 id="正常比对">正常比对</h3>
<p>还是把F5对照放出来看比较好（）不然我看不懂，全是Gemini在看。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">bool</span> <span class="title function_">MAPMGCMPMAM__MDMJCNKJPBD</span><span class="params">(System_String_o *HBLNEJNOOBL, <span class="type">const</span> MethodInfo *method)</span></span><br><span class="line">&#123;</span><br><span class="line">  System_String_o *v2; <span class="comment">// rbx</span></span><br><span class="line">  __int64 v3; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v4; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v5; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v6; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">char</span> v7; <span class="comment">// cl</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">HFKOMCEPCAL_o</span> *<span class="title">NLMHIDLAECP</span>;</span> <span class="comment">// r8</span></span><br><span class="line"></span><br><span class="line">  v2 = HBLNEJNOOBL;</span><br><span class="line">  <span class="keyword">if</span> ( !byte_182F66C0C )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_180290560(&amp;Method_EGJHFIOEIAD_IIPIJJMJOLF_OJFCJJBIDAK___, method);</span><br><span class="line">    sub_180290560(&amp;EGJHFIOEIAD_TypeInfo, v3);</span><br><span class="line">    sub_180290560(&amp;Singleton_ViewManager__TypeInfo, v4);</span><br><span class="line">    sub_180290560(&amp;StringLiteral_13071, v5);</span><br><span class="line">    sub_180290560(&amp;StringLiteral_11511, v6);</span><br><span class="line">    byte_182F66C0C = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( !v2 )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_20;</span><br><span class="line">  <span class="keyword">if</span> ( v2-&gt;fields._stringLength )</span><br><span class="line">  &#123;</span><br><span class="line">    v7 = byte_182F66BFE;</span><br><span class="line">    <span class="keyword">if</span> ( !byte_182F66BFE )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_180290560(&amp;MAPMGCMPMAM_TypeInfo, method);</span><br><span class="line">      v7 = <span class="number">1</span>;</span><br><span class="line">      byte_182F66BFE = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    method = (<span class="type">const</span> MethodInfo *)MAPMGCMPMAM_TypeInfo;</span><br><span class="line">    NLMHIDLAECP = MAPMGCMPMAM_TypeInfo-&gt;static_fields-&gt;NLMHIDLAECP;</span><br><span class="line">    <span class="keyword">if</span> ( !NLMHIDLAECP || !NLMHIDLAECP-&gt;fields.loginSave )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> ( !v7 )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_180290560(&amp;MAPMGCMPMAM_TypeInfo, MAPMGCMPMAM_TypeInfo);</span><br><span class="line">      method = (<span class="type">const</span> MethodInfo *)MAPMGCMPMAM_TypeInfo;</span><br><span class="line">      byte_182F66BFE = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    HBLNEJNOOBL = *(System_String_o **)method[<span class="number">2</span>].virtualMethodPointer;</span><br><span class="line">    <span class="keyword">if</span> ( HBLNEJNOOBL )</span><br><span class="line">    &#123;</span><br><span class="line">      HBLNEJNOOBL = (System_String_o *)HBLNEJNOOBL-&gt;fields;</span><br><span class="line">      <span class="keyword">if</span> ( HBLNEJNOOBL )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( FJFKHBFABDJ__MDMJCNKJPBD((FJFKHBFABDJ_o *)HBLNEJNOOBL, v2, <span class="number">0</span>) )</span><br><span class="line">          MAPMGCMPMAM__HGJLFCJDLHJ(<span class="number">0</span>);</span><br><span class="line">        HBLNEJNOOBL = (System_String_o *)Singleton_ViewManager__TypeInfo-&gt;static_fields-&gt;Instance;</span><br><span class="line">        <span class="keyword">if</span> ( HBLNEJNOOBL )</span><br><span class="line">        &#123;</span><br><span class="line">          ViewManager__ShowFadeOutTip((ViewManager_o *)HBLNEJNOOBL, (System_String_o *)StringLiteral_11511, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">          <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_20:</span><br><span class="line">    sub_180290800(HBLNEJNOOBL, method);</span><br><span class="line">  &#125;</span><br><span class="line">  HBLNEJNOOBL = (System_String_o *)Singleton_ViewManager__TypeInfo-&gt;static_fields-&gt;Instance;</span><br><span class="line">  <span class="keyword">if</span> ( !HBLNEJNOOBL )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_20;</span><br><span class="line">  ViewManager__ShowFadeOutTip((ViewManager_o *)HBLNEJNOOBL, StringLiteral_13071, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>前两个跳转都不满足的话，加载<code>MAPMGCMPMAM_TypeInfo</code>并设置<code>cs:byte_182F66BFE = 1</code>表示已绑定。接下来的<code>loc_180805FB7</code>对照F5，是<code>NLMHIDLAECP = MAPMGCMPMAM_TypeInfo-&gt;static_fields-&gt;NLMHIDLAECP;</code>这一行（我也不知道为什么寄存器r8变成了这么大一串东西……），两个<code>jz</code>跳转如果有满足的就会跳转到<code>loc_180806081</code>，直接退出，因此这对应<code>if ( !NLMHIDLAECP || !NLMHIDLAECP-&gt;fields.loginSave ) return 0;</code>。接下来又有一次绑定<code>MAPMGCMPMAM_TypeInfo</code>的过程，不太懂，不过也不重要。</p>
<p><code>loc_180805FFA</code>部分，第一、二个验证call到了<code>loc_1808060B9</code>，和字符串指针为空的结果一样，略过。接下来调用了<code>FJFKHBFABDJ$$MDMJCNKJPBD</code>，根据这个函数的返回值决定跳转到<code>loc_180806059</code>还是调用<code>MAPMGCMPMAM$$HGJLFCJDLHJ</code>。前者的参数有<code>cs:StringLiteral_11511</code>，也就是 <strong>This code is incorrect, please check and try again.</strong> ，那么后者应该才是验证成功，这下更应该看<code>FJFKHBFABDJ$$MDMJCNKJPBD</code>了。</p>
<h3 id="验证方法">验证方法</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line">il2cpp:00000001806FDFE0 ; bool FJFKHBFABDJ__MDMJCNKJPBD(FJFKHBFABDJ_o *this, System_String_o *HBLNEJNOOBL, const MethodInfo *method)</span><br><span class="line">il2cpp:00000001806FDFE0 FJFKHBFABDJ$$MDMJCNKJPBD proc near      ; CODE XREF: FJFKHBFABDJ$$AMKCOMHIBKJ+19E↑p</span><br><span class="line">il2cpp:00000001806FDFE0                                         ; MAPMGCMPMAM$$MDMJCNKJPBD+F0↓p</span><br><span class="line">il2cpp:00000001806FDFE0                                         ; DATA XREF: ...</span><br><span class="line">il2cpp:00000001806FDFE0</span><br><span class="line">il2cpp:00000001806FDFE0 arg_0           = qword ptr  8</span><br><span class="line">il2cpp:00000001806FDFE0 arg_8           = qword ptr  10h</span><br><span class="line">il2cpp:00000001806FDFE0 arg_10          = qword ptr  18h</span><br><span class="line">il2cpp:00000001806FDFE0</span><br><span class="line">il2cpp:00000001806FDFE0                 mov     [rsp+arg_8], rbx</span><br><span class="line">il2cpp:00000001806FDFE5                 mov     [rsp+arg_10], rbp</span><br><span class="line">il2cpp:00000001806FDFEA                 push    rsi</span><br><span class="line">il2cpp:00000001806FDFEB                 sub     rsp, 20h</span><br><span class="line">il2cpp:00000001806FDFEF                 cmp     cs:byte_182F66094, 0</span><br><span class="line">il2cpp:00000001806FDFF6                 mov     rbp, rdx</span><br><span class="line">il2cpp:00000001806FDFF9                 mov     rsi, rcx</span><br><span class="line">il2cpp:00000001806FDFFC                 jnz     short loc_1806FE065</span><br><span class="line">il2cpp:00000001806FDFFE                 lea     rcx, UnityEngine_Application_TypeInfo ; UnityEngine.Application_TypeInfo</span><br><span class="line">il2cpp:00000001806FE005                 call    sub_180290560</span><br><span class="line">il2cpp:00000001806FE00A                 lea     rcx, Method$Newtonsoft_Json_Linq_Extensions_Value_bool___ ; Method$Newtonsoft.Json.Linq.Extensions.Value&lt;bool&gt;()</span><br><span class="line">il2cpp:00000001806FE011                 call    sub_180290560</span><br><span class="line">il2cpp:00000001806FE016                 lea     rcx, StringLiteral_14551 ; &lt;RSAKeyValue&gt;&lt;Modulus&gt;kqb7YKFSoVfwpjfZozOf+/CBWZr52i6vGxz2qiGh+jyB5I0fwlSK9hLIFdxfJCgnbwnX6G7Eaj1XZ7zXDWg7iII7FEiwHMNmosKgpMsfnoFF8ow4T4+pzmvYJS0DSOYNZyTzl0wnoD0Sf2FafvtlltNv8tNZGSo/3m9gTF7h1Z6gfJPjnwYJWFkYNbp8EMKhgrju5XElJqZILHfbb4kOQx9jIf745YLsxj8nlI7Fe4n+fN2m5OtweTj45zgZx3sFkmPZ1BGP4kxQScBXUty6scioUskMZDZLvc210x32ZELoLaj3r1eznvurfJt81RAEttCQ7u1E1j8p+JmCo81MjQ==&lt;/Modulus&gt;&lt;Exponent&gt;AQAB&lt;/Exponent&gt;&lt;P&gt;zoaxu3zYHGWQaMvXXgFVGINbf5sFFrfJP104euD7TRQowhgV2kjgrPA65je5vn6e18YQ/SpCgoxFRF80Fohwh0vDAaiszdZjEkZLfOzNbmfKrnrpmPTzUkAlM9FCKqzFY/RMs/rV0jAnA19LvMu1lsXKiVC1vXzYwdg/vecUIAk=&lt;/P&gt;&lt;Q&gt;tch/CSr6UNPfl2SPHEFcei/ORCrG7YiF49UVb6wpOdxpGHXw/NJjStwqT8Cd5heTSA+BS4JmFh2TtagZdGmQ6VqhbnreHRDsEJxLKph9JrM6G7LVXvAGcRFi8ymA10ev3/53SnKsmsALs0w2ruTk3v6FjawUliart0qljhq/oWU=&lt;/Q&gt;&lt;DP&gt;cOknBm/s3ymP2BuJtXVZBrvaLFueXptARYo7tMKH4c4hsmvklqC9ZQ85xF+3BzTGtwUsiJywHBuASy8ZlTAnBXEgPinvv+Fz7KvN3ZDBh5jrMJU2XU+eL9ut+zRuzlIC4PDRdpyuhemZirhw+dkNgE7GumgL1HsLLn+B6dsKH7E=&lt;/DP&gt;&lt;DQ&gt;nZAUdHjZENgktI+H7+DDbHElYzaEyHyOOOWIOAxMi4d9XKNV533gbJGa5xe4hSioE0zFMBLts3udfVYg</span><br><span class="line">il2cpp:00000001806FE01D                 call    sub_180290560</span><br><span class="line">il2cpp:00000001806FE022                 lea     rcx, StringLiteral_782 ; is_production</span><br><span class="line">il2cpp:00000001806FE029                 call    sub_180290560</span><br><span class="line">il2cpp:00000001806FE02E                 lea     rcx, StringLiteral_11321 ; device_identifier</span><br><span class="line">il2cpp:00000001806FE035                 call    sub_180290560</span><br><span class="line">il2cpp:00000001806FE03A                 lea     rcx, StringLiteral_7302 ; app_version</span><br><span class="line">il2cpp:00000001806FE041                 call    sub_180290560</span><br><span class="line">il2cpp:00000001806FE046                 lea     rcx, StringLiteral_5200 ; random_discord</span><br><span class="line">il2cpp:00000001806FE04D                 call    sub_180290560</span><br><span class="line">il2cpp:00000001806FE052                 lea     rcx, StringLiteral_12129 ; Discord Login</span><br><span class="line">il2cpp:00000001806FE059                 call    sub_180290560</span><br><span class="line">il2cpp:00000001806FE05E                 mov     cs:byte_182F66094, 1</span><br><span class="line">il2cpp:00000001806FE065</span><br><span class="line">il2cpp:00000001806FE065 loc_1806FE065:                          ; CODE XREF: FJFKHBFABDJ$$MDMJCNKJPBD+1C↑j</span><br><span class="line">il2cpp:00000001806FE065                 mov     rcx, cs:StringLiteral_14551 ; HHEFFLMAGMB</span><br><span class="line">il2cpp:00000001806FE06C                 xor     r8d, r8d        ; method</span><br><span class="line">il2cpp:00000001806FE06F                 mov     rdx, rbp        ; OIBNBEKDHJK</span><br><span class="line">il2cpp:00000001806FE072                 mov     [rsp+28h+arg_0], rdi</span><br><span class="line">il2cpp:00000001806FE077                 call    JLBNKGPMECB$$CKNKCBAAJAP</span><br><span class="line">il2cpp:00000001806FE07C                 xor     edx, edx        ; method</span><br><span class="line">il2cpp:00000001806FE07E                 mov     rcx, rax        ; value</span><br><span class="line">il2cpp:00000001806FE081                 mov     rbx, rax</span><br><span class="line">il2cpp:00000001806FE084                 call    System_String$$IsNullOrEmpty</span><br><span class="line">il2cpp:00000001806FE089                 test    al, al</span><br><span class="line">il2cpp:00000001806FE08B                 jnz     loc_1806FE238</span><br><span class="line">il2cpp:00000001806FE091                 xor     edx, edx        ; method</span><br><span class="line">il2cpp:00000001806FE093                 mov     rcx, rbx        ; json</span><br><span class="line">il2cpp:00000001806FE096                 call    Newtonsoft_Json_Linq_JObject$$Parse</span><br><span class="line">il2cpp:00000001806FE09B                 mov     rdi, rax</span><br><span class="line">il2cpp:00000001806FE09E                 test    rax, rax</span><br><span class="line">il2cpp:00000001806FE0A1                 jz      loc_1806FE24F</span><br><span class="line">il2cpp:00000001806FE0A7                 mov     rdx, cs:StringLiteral_11321 ; propertyName</span><br><span class="line">il2cpp:00000001806FE0AE                 xor     r8d, r8d        ; method</span><br><span class="line">il2cpp:00000001806FE0B1                 mov     rcx, rax        ; this</span><br><span class="line">il2cpp:00000001806FE0B4                 call    Newtonsoft_Json_Linq_JObject$$get_Item_6467784000</span><br><span class="line">il2cpp:00000001806FE0B9                 test    rax, rax</span><br><span class="line">il2cpp:00000001806FE0BC                 jz      loc_1806FE24F</span><br><span class="line">il2cpp:00000001806FE0C2                 mov     rdx, [rax]</span><br><span class="line">il2cpp:00000001806FE0C5                 mov     rcx, rax</span><br><span class="line">il2cpp:00000001806FE0C8                 mov     r8, [rdx+168h]</span><br><span class="line">il2cpp:00000001806FE0CF                 mov     rdx, [rdx+170h]</span><br><span class="line">il2cpp:00000001806FE0D6                 call    r8</span><br><span class="line">il2cpp:00000001806FE0D9                 xor     ecx, ecx        ; method</span><br><span class="line">il2cpp:00000001806FE0DB                 mov     rbx, rax</span><br><span class="line">il2cpp:00000001806FE0DE                 call    UnityEngine_SystemInfo$$get_deviceUniqueIdentifier</span><br><span class="line">il2cpp:00000001806FE0E3                 xor     r8d, r8d        ; method</span><br><span class="line">il2cpp:00000001806FE0E6                 mov     rdx, rax        ; b</span><br><span class="line">il2cpp:00000001806FE0E9                 mov     rcx, rbx        ; a</span><br><span class="line">il2cpp:00000001806FE0EC                 call    System_String$$op_Inequality</span><br><span class="line">il2cpp:00000001806FE0F1                 test    al, al</span><br><span class="line">il2cpp:00000001806FE0F3                 jnz     loc_1806FE238</span><br><span class="line">il2cpp:00000001806FE0F9                 mov     rdx, cs:StringLiteral_5200 ; propertyName</span><br><span class="line">il2cpp:00000001806FE100                 xor     r8d, r8d        ; method</span><br><span class="line">il2cpp:00000001806FE103                 mov     rcx, rdi        ; this</span><br><span class="line">il2cpp:00000001806FE106                 call    Newtonsoft_Json_Linq_JObject$$get_Item_6467784000</span><br><span class="line">il2cpp:00000001806FE10B                 test    rax, rax</span><br><span class="line">il2cpp:00000001806FE10E                 jz      loc_1806FE24F</span><br><span class="line">il2cpp:00000001806FE114                 mov     rdx, [rax]</span><br><span class="line">il2cpp:00000001806FE117                 mov     rcx, rax</span><br><span class="line">il2cpp:00000001806FE11A                 mov     r8, [rdx+168h]</span><br><span class="line">il2cpp:00000001806FE121                 mov     rdx, [rdx+170h]</span><br><span class="line">il2cpp:00000001806FE128                 call    r8</span><br><span class="line">il2cpp:00000001806FE12B                 mov     rdx, [rsi+20h]  ; b</span><br><span class="line">il2cpp:00000001806FE12F                 xor     r8d, r8d        ; method</span><br><span class="line">il2cpp:00000001806FE132                 mov     rcx, rax        ; a</span><br><span class="line">il2cpp:00000001806FE135                 call    System_String$$op_Inequality</span><br><span class="line">il2cpp:00000001806FE13A                 test    al, al</span><br><span class="line">il2cpp:00000001806FE13C                 jnz     loc_1806FE238</span><br><span class="line">il2cpp:00000001806FE142                 mov     rdx, cs:StringLiteral_7302 ; propertyName</span><br><span class="line">il2cpp:00000001806FE149                 xor     r8d, r8d        ; method</span><br><span class="line">il2cpp:00000001806FE14C                 mov     rcx, rdi        ; this</span><br><span class="line">il2cpp:00000001806FE14F                 call    Newtonsoft_Json_Linq_JObject$$get_Item_6467784000</span><br><span class="line">il2cpp:00000001806FE154                 test    rax, rax</span><br><span class="line">il2cpp:00000001806FE157                 jz      loc_1806FE24F</span><br><span class="line">il2cpp:00000001806FE15D                 mov     rdx, [rax]</span><br><span class="line">il2cpp:00000001806FE160                 mov     rcx, rax</span><br><span class="line">il2cpp:00000001806FE163                 mov     r8, [rdx+168h]</span><br><span class="line">il2cpp:00000001806FE16A                 mov     rdx, [rdx+170h]</span><br><span class="line">il2cpp:00000001806FE171                 call    r8</span><br><span class="line">il2cpp:00000001806FE174                 mov     rcx, cs:UnityEngine_Application_TypeInfo ; UnityEngine.Application_TypeInfo</span><br><span class="line">il2cpp:00000001806FE17B                 mov     rbx, rax</span><br><span class="line">il2cpp:00000001806FE17E                 cmp     dword ptr [rcx+0E4h], 0</span><br><span class="line">il2cpp:00000001806FE185                 jnz     short loc_1806FE18C</span><br><span class="line">il2cpp:00000001806FE187                 call    il2cpp_runtime_class_init</span><br><span class="line">il2cpp:00000001806FE18C</span><br><span class="line">il2cpp:00000001806FE18C loc_1806FE18C:                          ; CODE XREF: FJFKHBFABDJ$$MDMJCNKJPBD+1A5↑j</span><br><span class="line">il2cpp:00000001806FE18C                 xor     ecx, ecx        ; method</span><br><span class="line">il2cpp:00000001806FE18E                 call    UnityEngine_Application$$get_version</span><br><span class="line">il2cpp:00000001806FE193                 xor     r8d, r8d        ; method</span><br><span class="line">il2cpp:00000001806FE196                 mov     rdx, rax        ; b</span><br><span class="line">il2cpp:00000001806FE199                 mov     rcx, rbx        ; a</span><br><span class="line">il2cpp:00000001806FE19C                 call    System_String$$op_Inequality</span><br><span class="line">il2cpp:00000001806FE1A1                 test    al, al</span><br><span class="line">il2cpp:00000001806FE1A3                 jnz     loc_1806FE238</span><br><span class="line">il2cpp:00000001806FE1A9                 mov     rax, cs:StringLiteral_12129 ; Discord Login</span><br><span class="line">il2cpp:00000001806FE1B0                 lea     rcx, [rsi+40h]</span><br><span class="line">il2cpp:00000001806FE1B4                 mov     [rsi+40h], rax</span><br><span class="line">il2cpp:00000001806FE1B8                 mov     rdx, cs:StringLiteral_12129 ; Discord Login</span><br><span class="line">il2cpp:00000001806FE1BF                 call    sub_18028F8B0</span><br><span class="line">il2cpp:00000001806FE1C4                 mov     rcx, cs:UnityEngine_Application_TypeInfo ; UnityEngine.Application_TypeInfo</span><br><span class="line">il2cpp:00000001806FE1CB                 cmp     dword ptr [rcx+0E4h], 0</span><br><span class="line">il2cpp:00000001806FE1D2                 jnz     short loc_1806FE1D9</span><br><span class="line">il2cpp:00000001806FE1D4                 call    il2cpp_runtime_class_init</span><br><span class="line">il2cpp:00000001806FE1D9</span><br><span class="line">il2cpp:00000001806FE1D9 loc_1806FE1D9:                          ; CODE XREF: FJFKHBFABDJ$$MDMJCNKJPBD+1F2↑j</span><br><span class="line">il2cpp:00000001806FE1D9                 xor     ecx, ecx        ; method</span><br><span class="line">il2cpp:00000001806FE1DB                 call    UnityEngine_Application$$get_version</span><br><span class="line">il2cpp:00000001806FE1E0                 lea     rcx, [rsi+30h]</span><br><span class="line">il2cpp:00000001806FE1E4                 mov     [rsi+30h], rax</span><br><span class="line">il2cpp:00000001806FE1E8                 mov     rdx, rax</span><br><span class="line">il2cpp:00000001806FE1EB                 call    sub_18028F8B0</span><br><span class="line">il2cpp:00000001806FE1F0                 lea     rcx, [rsi+28h]</span><br><span class="line">il2cpp:00000001806FE1F4                 mov     [rsi+28h], rbp</span><br><span class="line">il2cpp:00000001806FE1F8                 mov     rdx, rbp</span><br><span class="line">il2cpp:00000001806FE1FB                 call    sub_18028F8B0</span><br><span class="line">il2cpp:00000001806FE200                 mov     rdx, cs:StringLiteral_782 ; propertyName</span><br><span class="line">il2cpp:00000001806FE207                 xor     r8d, r8d        ; method</span><br><span class="line">il2cpp:00000001806FE20A                 mov     rcx, rdi        ; this</span><br><span class="line">il2cpp:00000001806FE20D                 call    Newtonsoft_Json_Linq_JObject$$get_Item_6467784000</span><br><span class="line">il2cpp:00000001806FE212                 mov     rdx, cs:Method$Newtonsoft_Json_Linq_Extensions_Value_bool___ ; method</span><br><span class="line">il2cpp:00000001806FE219                 mov     rcx, rax        ; value</span><br><span class="line">il2cpp:00000001806FE21C                 call    Newtonsoft_Json_Linq_Extensions$$Value_bool_</span><br><span class="line">il2cpp:00000001806FE221                 test    al, al</span><br><span class="line">il2cpp:00000001806FE223                 mov     edx, 1</span><br><span class="line">il2cpp:00000001806FE228                 mov     ecx, 64h ; &#x27;d&#x27;</span><br><span class="line">il2cpp:00000001806FE22D                 movzx   eax, dl</span><br><span class="line">il2cpp:00000001806FE230                 cmovz   ecx, edx</span><br><span class="line">il2cpp:00000001806FE233                 mov     [rsi+38h], ecx</span><br><span class="line">il2cpp:00000001806FE236                 jmp     short loc_1806FE23A</span><br><span class="line">il2cpp:00000001806FE238 ; ---------------------------------------------------------------------------</span><br><span class="line">il2cpp:00000001806FE238</span><br><span class="line">il2cpp:00000001806FE238 loc_1806FE238:                          ; CODE XREF: FJFKHBFABDJ$$MDMJCNKJPBD+AB↑j</span><br><span class="line">il2cpp:00000001806FE238                                         ; FJFKHBFABDJ$$MDMJCNKJPBD+113↑j ...</span><br><span class="line">il2cpp:00000001806FE238                 xor     al, al</span><br><span class="line">il2cpp:00000001806FE23A</span><br><span class="line">il2cpp:00000001806FE23A loc_1806FE23A:                          ; CODE XREF: FJFKHBFABDJ$$MDMJCNKJPBD+256↑j</span><br><span class="line">il2cpp:00000001806FE23A                 mov     rdi, [rsp+28h+arg_0]</span><br><span class="line">il2cpp:00000001806FE23F                 mov     rbx, [rsp+28h+arg_8]</span><br><span class="line">il2cpp:00000001806FE244                 mov     rbp, [rsp+28h+arg_10]</span><br><span class="line">il2cpp:00000001806FE249                 add     rsp, 20h</span><br><span class="line">il2cpp:00000001806FE24D                 pop     rsi</span><br><span class="line">il2cpp:00000001806FE24E                 retn</span><br><span class="line">il2cpp:00000001806FE24F ; ---------------------------------------------------------------------------</span><br><span class="line">il2cpp:00000001806FE24F</span><br><span class="line">il2cpp:00000001806FE24F loc_1806FE24F:                          ; CODE XREF: FJFKHBFABDJ$$MDMJCNKJPBD+C1↑j</span><br><span class="line">il2cpp:00000001806FE24F                                         ; FJFKHBFABDJ$$MDMJCNKJPBD+DC↑j ...</span><br><span class="line">il2cpp:00000001806FE24F                 call    sub_180290800</span><br><span class="line">il2cpp:00000001806FE24F ; ---------------------------------------------------------------------------</span><br><span class="line">il2cpp:00000001806FE254                 db 0CCh</span><br><span class="line">il2cpp:00000001806FE255 algn_1806FE255:                         ; DATA XREF: .pdata:0000000183289CD0↓o</span><br><span class="line">il2cpp:00000001806FE255                 align 20h</span><br><span class="line">il2cpp:00000001806FE255 FJFKHBFABDJ$$MDMJCNKJPBD endp</span><br></pre></td></tr></table></figure>
<p>笨笨程序员用了RSA加密，但是它放了私钥……<code>StringLiteral_14551</code>包含p,q，虽然不知道为什么私钥没写全，后面还有dq和d，但只知道p都够解密了。我说一点题外话，严重怀疑它们的程序员对加密只是一知半解，只知道公钥加密，私钥解密，客户端验证code需要解密，就把私钥放在客户端了（）这里应该将私钥放在Discord，做一个签名，客户端用公钥验签才符合安全需求。</p>
<p><s>能不能给我个致谢</s></p>
<p>对应的F5反编译也放一放，</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">bool</span> <span class="title function_">FJFKHBFABDJ__MDMJCNKJPBD</span><span class="params">(FJFKHBFABDJ_o *this, System_String_o *HBLNEJNOOBL, <span class="type">const</span> MethodInfo *method)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v5; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v6; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v7; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v8; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v9; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v10; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v11; <span class="comment">// rdx</span></span><br><span class="line">  System_String_o *v12; <span class="comment">// rbx</span></span><br><span class="line">  Newtonsoft_Json_Linq_JObject_o *v13; <span class="comment">// rax</span></span><br><span class="line">  Newtonsoft_Json_Linq_JObject_o *v14; <span class="comment">// rdi</span></span><br><span class="line">  Newtonsoft_Json_Linq_JToken_o *Item_6467784000; <span class="comment">// rax</span></span><br><span class="line">  System_String_o *v16; <span class="comment">// rbx</span></span><br><span class="line">  System_String_o *deviceUniqueIdentifier; <span class="comment">// rax</span></span><br><span class="line">  Newtonsoft_Json_Linq_JToken_o *v18; <span class="comment">// rax</span></span><br><span class="line">  System_String_o *v19; <span class="comment">// rax</span></span><br><span class="line">  Newtonsoft_Json_Linq_JToken_o *v20; <span class="comment">// rax</span></span><br><span class="line">  System_String_o *v21; <span class="comment">// rbx</span></span><br><span class="line">  System_String_o *version; <span class="comment">// rax</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">System_String_o</span> *<span class="title">v23</span>;</span> <span class="comment">// rax</span></span><br><span class="line">  Newtonsoft_Json_Linq_JToken_o *v24; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">bool</span> v25; <span class="comment">// zf</span></span><br><span class="line">  <span class="type">int32_t</span> v26; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">bool</span> result; <span class="comment">// al</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( !byte_182F66094 )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_180290560(&amp;UnityEngine_Application_TypeInfo, HBLNEJNOOBL);</span><br><span class="line">    sub_180290560(&amp;Method_Newtonsoft_Json_Linq_Extensions_Value_bool___, v5);</span><br><span class="line">    sub_180290560(&amp;StringLiteral_14551, v6);</span><br><span class="line">    sub_180290560(&amp;StringLiteral_782, v7);</span><br><span class="line">    sub_180290560(&amp;StringLiteral_11321, v8);</span><br><span class="line">    sub_180290560(&amp;StringLiteral_7302, v9);</span><br><span class="line">    sub_180290560(&amp;StringLiteral_5200, v10);</span><br><span class="line">    sub_180290560(&amp;StringLiteral_12129, v11);</span><br><span class="line">    byte_182F66094 = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v12 = JLBNKGPMECB__CKNKCBAAJAP(StringLiteral_14551, HBLNEJNOOBL, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( System_String__IsNullOrEmpty(v12, <span class="number">0</span>) )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  v13 = Newtonsoft_Json_Linq_JObject__Parse(v12, <span class="number">0</span>);</span><br><span class="line">  v14 = v13;</span><br><span class="line">  <span class="keyword">if</span> ( !v13 )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_19;</span><br><span class="line">  Item_6467784000 = Newtonsoft_Json_Linq_JObject__get_Item_6467784000(v13, StringLiteral_11321, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !Item_6467784000 )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_19;</span><br><span class="line">  v16 = (System_String_o *)((__int64 (__fastcall *)(Newtonsoft_Json_Linq_JToken_o *, <span class="type">const</span> MethodInfo *))Item_6467784000-&gt;klass-&gt;vtable._3_ToString.methodPtr)(</span><br><span class="line">                             Item_6467784000,</span><br><span class="line">                             Item_6467784000-&gt;klass-&gt;vtable._3_ToString.method);</span><br><span class="line">  deviceUniqueIdentifier = UnityEngine_SystemInfo__get_deviceUniqueIdentifier(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( System_String__op_Inequality(v16, deviceUniqueIdentifier, <span class="number">0</span>) )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  v18 = Newtonsoft_Json_Linq_JObject__get_Item_6467784000(v14, (System_String_o *)StringLiteral_5200, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !v18 )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_19;</span><br><span class="line">  v19 = (System_String_o *)((__int64 (__fastcall *)(Newtonsoft_Json_Linq_JToken_o *, <span class="type">const</span> MethodInfo *))v18-&gt;klass-&gt;vtable._3_ToString.methodPtr)(</span><br><span class="line">                             v18,</span><br><span class="line">                             v18-&gt;klass-&gt;vtable._3_ToString.method);</span><br><span class="line">  <span class="keyword">if</span> ( System_String__op_Inequality(v19, this-&gt;fields.discordRandomStr, <span class="number">0</span>) )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  v20 = Newtonsoft_Json_Linq_JObject__get_Item_6467784000(v14, StringLiteral_7302, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !v20 )</span><br><span class="line">LABEL_19:</span><br><span class="line">    sub_180290800();</span><br><span class="line">  v21 = (System_String_o *)((__int64 (__fastcall *)(Newtonsoft_Json_Linq_JToken_o *, <span class="type">const</span> MethodInfo *))v20-&gt;klass-&gt;vtable._3_ToString.methodPtr)(</span><br><span class="line">                             v20,</span><br><span class="line">                             v20-&gt;klass-&gt;vtable._3_ToString.method);</span><br><span class="line">  <span class="keyword">if</span> ( !*(&amp;UnityEngine_Application_TypeInfo-&gt;_2.cctor_finished + <span class="number">1</span>) )</span><br><span class="line">    il2cpp_runtime_class_init();</span><br><span class="line">  version = UnityEngine_Application__get_version(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( System_String__op_Inequality(v21, version, <span class="number">0</span>) )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  this-&gt;fields.LEFNABCJADK = StringLiteral_12129;</span><br><span class="line">  sub_18028F8B0(&amp;this-&gt;fields.LEFNABCJADK, StringLiteral_12129);</span><br><span class="line">  <span class="keyword">if</span> ( !*(&amp;UnityEngine_Application_TypeInfo-&gt;_2.cctor_finished + <span class="number">1</span>) )</span><br><span class="line">    il2cpp_runtime_class_init();</span><br><span class="line">  v23 = UnityEngine_Application__get_version(<span class="number">0</span>);</span><br><span class="line">  this-&gt;fields.loginVersion = v23;</span><br><span class="line">  sub_18028F8B0(&amp;this-&gt;fields.loginVersion, v23);</span><br><span class="line">  this-&gt;fields.discordLoginSaveStr = HBLNEJNOOBL;</span><br><span class="line">  sub_18028F8B0(&amp;this-&gt;fields.discordLoginSaveStr, HBLNEJNOOBL);</span><br><span class="line">  v24 = Newtonsoft_Json_Linq_JObject__get_Item_6467784000(v14, StringLiteral_782, <span class="number">0</span>);</span><br><span class="line">  v25 = !Newtonsoft_Json_Linq_Extensions__Value_bool_(</span><br><span class="line">           (System_Collections_Generic_IEnumerable_JToken__o *)v24,</span><br><span class="line">           Method_Newtonsoft_Json_Linq_Extensions_Value_bool___);</span><br><span class="line">  v26 = <span class="number">100</span>;</span><br><span class="line">  result = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v25 )</span><br><span class="line">    v26 = <span class="number">1</span>;</span><br><span class="line">  this-&gt;fields.CDPNMBDPOAM = v26;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我没细看，大致是调用<code>JLBNKGPMECB__CKNKCBAAJAP</code>函数进行解密，它是一个标准的base64解码+RSA OAEP，解密的结果经过<code>Newtonsoft_Json_Linq_JObject__Parse</code>解析为Json。</p>
<p><code>Newtonsoft_Json_Linq_JObject__get_Item_6467784000</code>和<code>(System_String_o *)((__int64 (__fastcall *)(Newtonsoft_Json_Linq_JToken_o *, const MethodInfo *))xxx-&gt;klass-&gt;vtable._3_ToString.methodPtr)</code>提取<code>StringLiteral_11321 (device_identifier)</code>，<code>StringLiteral_5200 (random_discord)</code>和<code>StringLiteral_7302 (app_version)</code>，并和真实的<code>deviceUniqueIdentifier</code>，<code>this-&gt;fields.discordRandomStr</code>，<code>version</code>比对，只要有不一致就返回0。</p>
<p>以上三项通过后就验证完成了……才怪。程序先将<code>this-&gt;fields.LEFNABCJADK</code>设置为 <strong>Discord Login</strong> ，<code>this-&gt;fields.loginVersion</code>设置为当前版本，<code>this-&gt;fields.discordLoginSaveStr</code>设置为参数字符串，最后又获取了<code>StringLiteral_782 (is_production)</code>，如果<code>is_production = False</code>，将<code>v26</code>设置为1，否则保持为100，更新字段<code>this-&gt;fields.CDPNMBDPOAM</code>。</p>
<p>那么，Discord发回的验证码应该是使用公钥加密的，包含device_identifier，random_discord，app_version和is_production的Json字符串。由于我们也有公钥（有私钥就有公钥），我们现在的目标是构造上面这四个值。最后一项不在比对的范围内，因此最核心的目标是找到前三者。</p>
<p>现在我们假设自己是Discord的Bot，我该如何知道应该发回什么code呢？我需要用户提供的ID code。考虑到：同一用户可能使用不同设备，同一设备的random_discord可能不同，请求验证的版本可能不同，这样的话，ID code应当包含以上所有信息，才能覆盖全部可能，保证提供验证服务。</p>
<p>那么，我们来解密ID code吧！</p>
<h2 id="ID-code？似是故人来">ID code？似是故人来</h2>
<p>复制出来的ID code大致如下，而且每次复制的都不一样。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1KyCcFHvVNeJCGEDnJ9/5HxqyhnlHerBWgrNwbrYnVXytJ860MwMBnYwMVSqeoKiv1DKB9Ts8a5zIWXdzuHi7oZXytc2gbk8/4fA6hoRlsYDjzRjBIgDyR1STaojYOrNh3DK8e8MysBjTM1jrI6u8eIDZOfj5qAtyRSBFCH90nsu/R+qoHcR4+4kmCztRoWqamR4rIJ1Z0A0rTphSIZnYZeSSX3fGol6qjmNeuZNsWwx8Oz7koBjwJhm0KCUE0w4eXkgN841yCt3r/ueCbwd+Pg98T4YESirlhe+qTzcmgUPWJoNRXEcgFZrYzwn/SFUubwurf/16D0e3Cmh3qwpPA==</span><br></pre></td></tr></table></figure>
<p>看这个形式，估计还是一个base64，解码后试着用私钥解密一下发现解密不了，继续看吧。</p>
<p>让Gemini Cli分析了所有LoginView中的函数，梳理验证逻辑，它找到了生成并复制ID code的是函数<code>Gamexxx_View_LoginView$$BCEKIAMPMOI</code>，从这里开始继续往下。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">il2cpp:000000018068F590 ; void Gamexxx_View_LoginView__BCEKIAMPMOI(Gamexxx_View_LoginView_o *this, const MethodInfo *method)</span><br><span class="line">il2cpp:000000018068F590 Gamexxx_View_LoginView$$BCEKIAMPMOI proc near</span><br><span class="line">il2cpp:000000018068F590                                         ; DATA XREF: .data:0000000182D45298↓o</span><br><span class="line">il2cpp:000000018068F590                                         ; .pdata:0000000183284C24↓o</span><br><span class="line">il2cpp:000000018068F590</span><br><span class="line">il2cpp:000000018068F590 var_8           = qword ptr -8</span><br><span class="line">il2cpp:000000018068F590 NOFFKECEGCF     = System_Nullable_float__o ptr  18h</span><br><span class="line">il2cpp:000000018068F590</span><br><span class="line">il2cpp:000000018068F590                 sub     rsp, 28h</span><br><span class="line">il2cpp:000000018068F594                 cmp     cs:byte_182F65D60, 0</span><br><span class="line">il2cpp:000000018068F59B                 jnz     short loc_18068F5D4</span><br><span class="line">il2cpp:000000018068F59D                 lea     rcx, UnityEngine_GUIUtility_TypeInfo ; UnityEngine.GUIUtility_TypeInfo</span><br><span class="line">il2cpp:000000018068F5A4                 call    sub_180290560</span><br><span class="line">il2cpp:000000018068F5A9                 lea     rcx, Method$System_Nullable_float___ctor__ ; Method$System.Nullable&lt;float&gt;..ctor()</span><br><span class="line">il2cpp:000000018068F5B0                 call    sub_180290560</span><br><span class="line">il2cpp:000000018068F5B5                 lea     rcx, Singleton_ViewManager__TypeInfo ; Singleton&lt;ViewManager&gt;_TypeInfo</span><br><span class="line">il2cpp:000000018068F5BC                 call    sub_180290560</span><br><span class="line">il2cpp:000000018068F5C1                 lea     rcx, StringLiteral_8571 ; The code has been copied</span><br><span class="line">il2cpp:000000018068F5C8                 call    sub_180290560</span><br><span class="line">il2cpp:000000018068F5CD                 mov     cs:byte_182F65D60, 1</span><br><span class="line">il2cpp:000000018068F5D4</span><br><span class="line">il2cpp:000000018068F5D4 loc_18068F5D4:                          ; CODE XREF: Gamexxx_View_LoginView$$BCEKIAMPMOI+B↑j</span><br><span class="line">il2cpp:000000018068F5D4                 xor     ecx, ecx        ; method</span><br><span class="line">il2cpp:000000018068F5D6                 mov     [rsp+28h+var_8], rbx</span><br><span class="line">il2cpp:000000018068F5DB                 call    MAPMGCMPMAM$$LMKINBNNDCN</span><br><span class="line">il2cpp:000000018068F5E0                 test    rax, rax</span><br><span class="line">il2cpp:000000018068F5E3                 jz      loc_18068F66E</span><br><span class="line">il2cpp:000000018068F5E9                 xor     edx, edx        ; method</span><br><span class="line">il2cpp:000000018068F5EB                 mov     rcx, rax        ; this</span><br><span class="line">il2cpp:000000018068F5EE                 call    FJFKHBFABDJ$$FANOELKBMAM</span><br><span class="line">il2cpp:000000018068F5F3                 mov     rcx, cs:UnityEngine_GUIUtility_TypeInfo ; UnityEngine.GUIUtility_TypeInfo</span><br><span class="line">il2cpp:000000018068F5FA                 mov     rbx, rax</span><br><span class="line">il2cpp:000000018068F5FD                 cmp     dword ptr [rcx+0E4h], 0</span><br><span class="line">il2cpp:000000018068F604                 jnz     short loc_18068F60B</span><br><span class="line">il2cpp:000000018068F606                 call    il2cpp_runtime_class_init</span><br><span class="line">il2cpp:000000018068F60B</span><br><span class="line">il2cpp:000000018068F60B loc_18068F60B:                          ; CODE XREF: Gamexxx_View_LoginView$$BCEKIAMPMOI+74↑j</span><br><span class="line">il2cpp:000000018068F60B                 xor     edx, edx        ; method</span><br><span class="line">il2cpp:000000018068F60D                 mov     rcx, rbx        ; value</span><br><span class="line">il2cpp:000000018068F610                 call    UnityEngine_GUIUtility$$set_systemCopyBuffer</span><br><span class="line">il2cpp:000000018068F615                 mov     rax, cs:Singleton_ViewManager__TypeInfo ; Singleton&lt;ViewManager&gt;_TypeInfo</span><br><span class="line">il2cpp:000000018068F61C                 mov     r8, cs:Method$System_Nullable_float___ctor__ ; method</span><br><span class="line">il2cpp:000000018068F623                 movss   xmm1, cs:flt_1824F3C40 ; value</span><br><span class="line">il2cpp:000000018068F62B                 mov     rcx, [rax+0B8h]</span><br><span class="line">il2cpp:000000018068F632                 mov     rbx, [rcx]</span><br><span class="line">il2cpp:000000018068F635                 lea     rcx, [rsp+28h+NOFFKECEGCF] ; this</span><br><span class="line">il2cpp:000000018068F63A                 mov     qword ptr [rsp+28h+NOFFKECEGCF.fields.hasValue], 0</span><br><span class="line">il2cpp:000000018068F643                 call    System_Nullable_float_$$_ctor</span><br><span class="line">il2cpp:000000018068F648                 test    rbx, rbx</span><br><span class="line">il2cpp:000000018068F64B                 jz      short loc_18068F66E</span><br><span class="line">il2cpp:000000018068F64D                 mov     r8, qword ptr [rsp+28h+NOFFKECEGCF.fields.hasValue] ; NOFFKECEGCF</span><br><span class="line">il2cpp:000000018068F652                 xor     r9d, r9d        ; method</span><br><span class="line">il2cpp:000000018068F655                 mov     rdx, cs:StringLiteral_8571 ; OIBNBEKDHJK</span><br><span class="line">il2cpp:000000018068F65C                 mov     rcx, rbx        ; this</span><br><span class="line">il2cpp:000000018068F65F                 call    ViewManager$$ShowFadeOutTip</span><br><span class="line">il2cpp:000000018068F664                 mov     rbx, [rsp+28h+var_8]</span><br><span class="line">il2cpp:000000018068F669                 add     rsp, 28h</span><br><span class="line">il2cpp:000000018068F66D                 retn</span><br><span class="line">il2cpp:000000018068F66E ; ---------------------------------------------------------------------------</span><br><span class="line">il2cpp:000000018068F66E</span><br><span class="line">il2cpp:000000018068F66E loc_18068F66E:                          ; CODE XREF: Gamexxx_View_LoginView$$BCEKIAMPMOI+53↑j</span><br><span class="line">il2cpp:000000018068F66E                                         ; Gamexxx_View_LoginView$$BCEKIAMPMOI+BB↑j</span><br><span class="line">il2cpp:000000018068F66E                 call    sub_180290800</span><br><span class="line">il2cpp:000000018068F66E ; ---------------------------------------------------------------------------</span><br><span class="line">il2cpp:000000018068F673                 db 0CCh</span><br><span class="line">il2cpp:000000018068F674 algn_18068F674:                         ; DATA XREF: .pdata:0000000183284C24↓o</span><br><span class="line">il2cpp:000000018068F674                 align 20h</span><br><span class="line">il2cpp:000000018068F674 Gamexxx_View_LoginView$$BCEKIAMPMOI endp</span><br></pre></td></tr></table></figure>
<p>对应反编译：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">Gamexxx_View_LoginView__BCEKIAMPMOI</span><span class="params">(Gamexxx_View_LoginView_o *this, <span class="type">const</span> MethodInfo *method)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v2; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v3; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v4; <span class="comment">// rdx</span></span><br><span class="line">  FJFKHBFABDJ_o *v5; <span class="comment">// rax</span></span><br><span class="line">  System_String_o *v6; <span class="comment">// rbx</span></span><br><span class="line">  ViewManager_o *Instance; <span class="comment">// rbx</span></span><br><span class="line">  System_Nullable_float__o NOFFKECEGCF; <span class="comment">// [rsp+40h] [rbp+18h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( !byte_182F65D60 )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_180290560(&amp;UnityEngine_GUIUtility_TypeInfo, method);</span><br><span class="line">    sub_180290560(&amp;Method_System_Nullable_float___ctor__, v2);</span><br><span class="line">    sub_180290560(&amp;Singleton_ViewManager__TypeInfo, v3);</span><br><span class="line">    sub_180290560(&amp;StringLiteral_8571, v4);</span><br><span class="line">    byte_182F65D60 = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v5 = MAPMGCMPMAM__LMKINBNNDCN(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !v5 )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_8;</span><br><span class="line">  v6 = FJFKHBFABDJ__FANOELKBMAM(v5, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !*(&amp;UnityEngine_GUIUtility_TypeInfo-&gt;_2.cctor_finished + <span class="number">1</span>) )</span><br><span class="line">    il2cpp_runtime_class_init(UnityEngine_GUIUtility_TypeInfo);</span><br><span class="line">  UnityEngine_GUIUtility__set_systemCopyBuffer(v6, <span class="number">0</span>);</span><br><span class="line">  Instance = Singleton_ViewManager__TypeInfo-&gt;static_fields-&gt;Instance;</span><br><span class="line">  NOFFKECEGCF = <span class="number">0</span>;</span><br><span class="line">  System_Nullable_float____ctor((System_Nullable_float__o)&amp;NOFFKECEGCF, <span class="number">4.0</span>, Method_System_Nullable_float___ctor__);</span><br><span class="line">  <span class="keyword">if</span> ( !Instance )</span><br><span class="line">LABEL_8:</span><br><span class="line">    sub_180290800();</span><br><span class="line">  ViewManager__ShowFadeOutTip(Instance, StringLiteral_8571, NOFFKECEGCF, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>还是熟悉的一堆<code>sub_180290560</code>，绑定若干外部值。使用<code>MAPMGCMPMAM__LMKINBNNDCN</code>先获取登录存档实例，再用<code>FJFKHBFABDJ__FANOELKBMAM</code>生成凭证。最后<code>UnityEngine_GUIUtility__set_systemCopyBuffer</code>将结果放到复制buffer，最后弹出提示，参数是<code>StringLiteral_8571 (The code has been copied)</code>。</p>
<p>为什么前面Empty string之后有一个点，这里又没有……</p>
<p>看一下这俩函数吧。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">FJFKHBFABDJ_o *<span class="title function_">MAPMGCMPMAM__LMKINBNNDCN</span><span class="params">(<span class="type">const</span> MethodInfo *method)</span></span><br><span class="line">&#123;</span><br><span class="line">  FJFKHBFABDJ_o *result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( !byte_182F66BFE )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_180290560(&amp;MAPMGCMPMAM_TypeInfo);</span><br><span class="line">    byte_182F66BFE = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  result = (FJFKHBFABDJ_o *)MAPMGCMPMAM_TypeInfo-&gt;static_fields-&gt;NLMHIDLAECP;</span><br><span class="line">  <span class="keyword">if</span> ( result )</span><br><span class="line">    <span class="keyword">return</span> (FJFKHBFABDJ_o *)result-&gt;fields.patreonLoginAccount;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>它获取了<code>MAPMGCMPMAM_TypeInfo-&gt;static_fields-&gt;NLMHIDLAECP;</code>，如果获取到了，就取出它的<code>fields.patreonLoginAccount</code>存储的patreon登录信息，但是如果result为0，那返回result干什么……</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">il2cpp:0000000180805EE0 ; FJFKHBFABDJ_o *MAPMGCMPMAM__LMKINBNNDCN(const MethodInfo *method)</span><br><span class="line">il2cpp:0000000180805EE0 MAPMGCMPMAM$$LMKINBNNDCN proc near      ; CODE XREF: Gamexxx_View_LoginView$$BCEKIAMPMOI+4B↑p</span><br><span class="line">il2cpp:0000000180805EE0                                         ; Gamexxx_View_LoginView$$BHOEBAPFFAD+4B↑p ...</span><br><span class="line">il2cpp:0000000180805EE0                 sub     rsp, 28h</span><br><span class="line">il2cpp:0000000180805EE4                 cmp     cs:byte_182F66BFE, 0</span><br><span class="line">il2cpp:0000000180805EEB                 jnz     short loc_180805F00</span><br><span class="line">il2cpp:0000000180805EED                 lea     rcx, MAPMGCMPMAM_TypeInfo ; MAPMGCMPMAM_TypeInfo</span><br><span class="line">il2cpp:0000000180805EF4                 call    sub_180290560</span><br><span class="line">il2cpp:0000000180805EF9                 mov     cs:byte_182F66BFE, 1</span><br><span class="line">il2cpp:0000000180805F00</span><br><span class="line">il2cpp:0000000180805F00 loc_180805F00:                          ; CODE XREF: MAPMGCMPMAM$$LMKINBNNDCN+B↑j</span><br><span class="line">il2cpp:0000000180805F00                 mov     rax, cs:MAPMGCMPMAM_TypeInfo ; MAPMGCMPMAM_TypeInfo</span><br><span class="line">il2cpp:0000000180805F07                 mov     rcx, [rax+0B8h]</span><br><span class="line">il2cpp:0000000180805F0E                 mov     rax, [rcx]</span><br><span class="line">il2cpp:0000000180805F11                 test    rax, rax</span><br><span class="line">il2cpp:0000000180805F14                 jz      short loc_180805F1F</span><br><span class="line">il2cpp:0000000180805F16                 mov     rax, [rax+10h]</span><br><span class="line">il2cpp:0000000180805F1A                 add     rsp, 28h</span><br><span class="line">il2cpp:0000000180805F1E                 retn</span><br><span class="line">il2cpp:0000000180805F1F ; ---------------------------------------------------------------------------</span><br><span class="line">il2cpp:0000000180805F1F</span><br><span class="line">il2cpp:0000000180805F1F loc_180805F1F:                          ; CODE XREF: MAPMGCMPMAM$$LMKINBNNDCN+34↑j</span><br><span class="line">il2cpp:0000000180805F1F                 add     rsp, 28h</span><br><span class="line">il2cpp:0000000180805F23                 retn</span><br><span class="line">il2cpp:0000000180805F23 ; ---------------------------------------------------------------------------</span><br><span class="line">il2cpp:0000000180805F24 algn_180805F24:                         ; DATA XREF: .pdata:0000000183295AC0↓o</span><br><span class="line">il2cpp:0000000180805F24                 align 10h</span><br><span class="line">il2cpp:0000000180805F24 MAPMGCMPMAM$$LMKINBNNDCN endp</span><br></pre></td></tr></table></figure>
<p>额，汇编就长这样，那行吧，尊重编译器的决定。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">System_String_o *<span class="title function_">FJFKHBFABDJ__FANOELKBMAM</span><span class="params">(FJFKHBFABDJ_o *this, <span class="type">const</span> MethodInfo *method)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v3; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v4; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v5; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v6; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v7; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v8; <span class="comment">// rdx</span></span><br><span class="line">  Newtonsoft_Json_Linq_JObject_o *v9; <span class="comment">// rbx</span></span><br><span class="line">  System_String_o *deviceUniqueIdentifier; <span class="comment">// rsi</span></span><br><span class="line">  Newtonsoft_Json_Linq_JToken_o *v11; <span class="comment">// rax</span></span><br><span class="line">  System_String_o *version; <span class="comment">// rax</span></span><br><span class="line">  Newtonsoft_Json_Linq_JToken_o *v13; <span class="comment">// rax</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">System_String_o</span> *<span class="title">v14</span>;</span> <span class="comment">// rax</span></span><br><span class="line">  Newtonsoft_Json_Linq_JToken_o *v15; <span class="comment">// rax</span></span><br><span class="line">  System_String_o *v16; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( !byte_182F66091 )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_180290560(&amp;UnityEngine_Application_TypeInfo, method);</span><br><span class="line">    sub_180290560(&amp;Newtonsoft_Json_Linq_JObject_TypeInfo, v3);</span><br><span class="line">    sub_180290560(&amp;Newtonsoft_Json_Linq_JToken_TypeInfo, v4);</span><br><span class="line">    sub_180290560(&amp;StringLiteral_11321, v5);</span><br><span class="line">    sub_180290560(&amp;StringLiteral_7302, v6);</span><br><span class="line">    sub_180290560(&amp;StringLiteral_5200, v7);</span><br><span class="line">    sub_180290560(&amp;StringLiteral_14545, v8);</span><br><span class="line">    byte_182F66091 = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v9 = (Newtonsoft_Json_Linq_JObject_o *)sub_1802907B0(Newtonsoft_Json_Linq_JObject_TypeInfo);</span><br><span class="line">  Newtonsoft_Json_Linq_JObject___ctor(v9, <span class="number">0</span>);</span><br><span class="line">  deviceUniqueIdentifier = UnityEngine_SystemInfo__get_deviceUniqueIdentifier(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !*(&amp;Newtonsoft_Json_Linq_JToken_TypeInfo-&gt;_2.cctor_finished + <span class="number">1</span>) )</span><br><span class="line">    il2cpp_runtime_class_init(Newtonsoft_Json_Linq_JToken_TypeInfo);</span><br><span class="line">  v11 = Newtonsoft_Json_Linq_JToken__op_Implicit_6467848256(deviceUniqueIdentifier, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !v9 )</span><br><span class="line">    sub_180290800();</span><br><span class="line">  Newtonsoft_Json_Linq_JObject__set_Item_6467784448(v9, StringLiteral_11321, v11, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !*(&amp;UnityEngine_Application_TypeInfo-&gt;_2.cctor_finished + <span class="number">1</span>) )</span><br><span class="line">    il2cpp_runtime_class_init(UnityEngine_Application_TypeInfo);</span><br><span class="line">  version = UnityEngine_Application__get_version(<span class="number">0</span>);</span><br><span class="line">  v13 = Newtonsoft_Json_Linq_JToken__op_Implicit_6467848256(version, <span class="number">0</span>);</span><br><span class="line">  Newtonsoft_Json_Linq_JObject__set_Item_6467784448(v9, StringLiteral_7302, v13, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( System_String__IsNullOrEmpty(this-&gt;fields.discordRandomStr, <span class="number">0</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    FJFKHBFABDJ__OCMPMHFEPIJ(this, <span class="number">0</span>);</span><br><span class="line">    v14 = JLBNKGPMECB__LNCFFFNFKPC(<span class="number">15</span>, <span class="number">0</span>);</span><br><span class="line">    this-&gt;fields.discordRandomStr = v14;</span><br><span class="line">    sub_18028F8B0(&amp;this-&gt;fields.discordRandomStr, v14);</span><br><span class="line">    MAPMGCMPMAM__NPIBGGPMOLD(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  v15 = Newtonsoft_Json_Linq_JToken__op_Implicit_6467848256(this-&gt;fields.discordRandomStr, <span class="number">0</span>);</span><br><span class="line">  Newtonsoft_Json_Linq_JObject__set_Item_6467784448(v9, (System_String_o *)StringLiteral_5200, v15, <span class="number">0</span>);</span><br><span class="line">  v16 = (System_String_o *)((__int64 (__fastcall *)(Newtonsoft_Json_Linq_JObject_o *, <span class="type">const</span> MethodInfo *))v9-&gt;klass-&gt;vtable._3_ToString.methodPtr)(</span><br><span class="line">                             v9,</span><br><span class="line">                             v9-&gt;klass-&gt;vtable._3_ToString.method);</span><br><span class="line">  <span class="keyword">return</span> JLBNKGPMECB__KLCJIOLLNCL(StringLiteral_14545, v16, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>第二个函数是真正拼凑信息的，<code>deviceUniqueIdentifier</code>和<code>version</code>直接用Unity的API获取，<code>discordRandomStr</code>如果为空，就新建一个15字符长的Str，保存到<code>this-&gt;fields.discordRandomStr</code>中。<code>sub_18028F8B0</code>看起来就很像在保存。</p>
<p>这样所有信息都齐全了，用<code>(System_String_o *)((__int64 (__fastcall *)(Newtonsoft_Json_Linq_JObject_o *, const MethodInfo *))v9-&gt;klass-&gt;vtable._3_ToString.methodPtr)</code>转换为字符串，并经过函数<code>JLBNKGPMECB__KLCJIOLLNCL</code>……等等，这个类名有点熟悉，前面解密的时候有一个<code>JLBNKGPMECB__CKNKCBAAJAP</code>，类是相同的，只是方法不同。</p>
<p>这个方法也很清晰，是用<code>StringLiteral_14545</code>作为公钥加密然后base64编码。这个密钥和刚才分析到的私钥不匹配，难怪解密不了。问题来了，这次是一个加密，程序员知道留下公钥，我没有私钥没法解密这些信息，那该怎么办？</p>
<h2 id="字符串，Look-at-me">字符串，Look at me!</h2>
<p>既然公钥和私钥都硬编码在字符串里，那改一下字符串，能让程序直接用上吗？</p>
<p>StringLiteral_14551：你看看我呢</p>
<p><img src="lookatme.png" alt="lookatme"></p>
<p>IDA里没有这些字符串，前面提到了字符串存储在metadata中，但是其实到这个时候我想到要改了才去问（）总之该去metadata里找了。</p>
<p><img src="010.png" alt="010"></p>
<p>搜索 <strong>&lt;RSA</strong> ，能搜到五处，一个个看，发现2E1…开头的是公钥(StringLiteral_14545)模数，kqb…开头的是私钥(StringLiteral_14551)模数，它们果然在metadata里。关于RSA就不再细说了，总之将公钥的模数(Modulus)和指数(Exponent)替换成私钥对应的部分，就可以用这个私钥解密。</p>
<p>修改过后的ID code就能够正确解密了，记得要去掉OAEP Padding，单纯解密得到的依然是乱码。</p>
<p>这样流程就十分清楚了，从ID code中获取信息，重组为一个新的Json，加密后填入验证框中。由于加解密使用的都是我们已知的密钥，<s>我们自己</s>AI就可以写一个注册机，替代Discord bot。</p>
<p>仅对当前版本（v0.2.27）有效，不保证前后版本兼容。使用文章中提到的编码方式（不是加密方式）进行了编码，看完文章或者有一些敏锐的感觉就能解了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ZnJvbSBDcnlwdG8uUHVibGljS2V5IGltcG9ydCBSU0EgIyDlkb3ku6TooYzovpPlhaUgcGlwIGluc3RhbGwgcHljcnlwdG9kb21lIOWuieijheebuOW6lOeahOi9r+S7tuWMhQpmcm9tIENyeXB0by5DaXBoZXIgaW1wb3J0IFBLQ1MxX09BRVAKZnJvbSBDcnlwdG8uSGFzaCBpbXBvcnQgU0hBMQppbXBvcnQganNvbgppbXBvcnQgYmFzZTY0CmltcG9ydCBiaW5hc2NpaQoKZGVmIGRlY3J5cHRfSURjb2RlKHByaXZhdGVfa2V5X3BlbSwgYmFzZTY0X2VuY3J5cHRlZF9zdHIpOgogICAgIiIiCiAgICDop6Plr4blh73mlbDvvJrovpPlhaUgQmFzZTY0IOWtl+espuS4su+8jOi+k+WHuuino+aekOWQjueahCBKU09OIOWvueixoQogICAgIiIiCiAgICB0cnk6CiAgICAgICAgZW5jcnlwdGVkX2J5dGVzID0gYmFzZTY0LmI2NGRlY29kZShiYXNlNjRfZW5jcnlwdGVkX3N0cikKICAgICAgICBrZXkgPSBSU0EuaW1wb3J0X2tleShwcml2YXRlX2tleV9wZW0pCiAgICAgICAgCiAgICAgICAgIyDliJvlu7rop6Plr4blmagKICAgICAgICAjIOW/hemhu+aMh+WumiBoYXNoQWxnbz1TSEEx77yM5Zug5Li6QyPpu5jorqTliqDlr4bml7bnlKjnmoTmmK8gU0hBMQogICAgICAgIGNpcGhlciA9IFBLQ1MxX09BRVAubmV3KGtleSwgaGFzaEFsZ289U0hBMSkKICAgICAgICBkZWNyeXB0ZWRfYnl0ZXMgPSBjaXBoZXIuZGVjcnlwdChlbmNyeXB0ZWRfYnl0ZXMpCiAgICAgICAgCiAgICAgICAgIyDovazkuLrlrZfnrKbkuLLlubbop6PmnpAgSlNPTgogICAgICAgIGpzb25fc3RyID0gZGVjcnlwdGVkX2J5dGVzLmRlY29kZSgndXRmLTgnKQogICAgICAgIHBheWxvYWQgPSBqc29uLmxvYWRzKGpzb25fc3RyKQogICAgICAgIAogICAgICAgIHByaW50KGYiWytdIOino+WvhuaIkOWKnyEg5Y6f5aeLIFBheWxvYWQg5pWw5o2uOiIpCiAgICAgICAgcHJpbnQoanNvbi5kdW1wcyhwYXlsb2FkLCBpbmRlbnQ9NCwgZW5zdXJlX2FzY2lpPUZhbHNlKSkKICAgICAgICByZXR1cm4gcGF5bG9hZAoKICAgIGV4Y2VwdCBWYWx1ZUVycm9yIGFzIGU6CiAgICAgICAgcHJpbnQoZiJbIV0g6Kej5a+G5aSx6LSlOiDlr4bpkqXkuI3ljLnphY3miJbloavlhYXplJnor68gKFBhZGRpbmcgRXJyb3Ip44CC6K+m5oOFOiB7ZX0iKQogICAgZXhjZXB0IGJpbmFzY2lpLkVycm9yOgogICAgICAgIHByaW50KGYiWyFdIOino+WvhuWksei0pTog6L6T5YWl55qE5LiN5piv5pyJ5pWI55qEIEJhc2U2NCDlrZfnrKbkuLLjgIIiKQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50KGYiWyFdIOWPkeeUn+acquefpemUmeivrzoge2V9IikKICAgIHJldHVybiBOb25lCgpkZWYgZ2VuZXJhdGVfbGljZW5zZShwcml2YXRlX2tleV9wZW0sIGRldmljZV9pZCwgcmFuZG9tX2Rpc2NvcmQsIGFwcF92ZXJzaW9uKToKICAgICIiIgogICAg5Yqg5a+G5Ye95pWw77ya6L6T5YWl5L+h5oGv77yM6L6T5Ye65Yqg5a+G5ZCO55qEIEJhc2U2NCDlrZfnrKbkuLIKICAgICIiIgogICAgdHJ5OgogICAgICAgIGtleSA9IFJTQS5pbXBvcnRfa2V5KHByaXZhdGVfa2V5X3BlbSkKICAgICAgICAKICAgICAgICBwYXlsb2FkID0gewogICAgICAgICAgICAiZGV2aWNlX2lkZW50aWZpZXIiOiBkZXZpY2VfaWQsCiAgICAgICAgICAgICJhcHBfdmVyc2lvbiI6IGFwcF92ZXJzaW9uLAogICAgICAgICAgICAicmFuZG9tX2Rpc2NvcmQiOiByYW5kb21fZGlzY29yZCwKICAgICAgICAgICAgImlzX3Byb2R1Y3Rpb24iOiBUcnVlCiAgICAgICAgfQogICAgICAgIAogICAgICAgIGpzb25fZGF0YSA9IGpzb24uZHVtcHMocGF5bG9hZCkKICAgICAgICBkYXRhX2J5dGVzID0ganNvbl9kYXRhLmVuY29kZSgndXRmLTgnKQogICAgICAgIAogICAgICAgIGNpcGhlciA9IFBLQ1MxX09BRVAubmV3KGtleSwgaGFzaEFsZ289U0hBMSkKICAgICAgICBlbmNyeXB0ZWRfYnl0ZXMgPSBjaXBoZXIuZW5jcnlwdChkYXRhX2J5dGVzKQogICAgICAgIGxpY2Vuc2Vfa2V5ID0gYmFzZTY0LmI2NGVuY29kZShlbmNyeXB0ZWRfYnl0ZXMpLmRlY29kZSgndXRmLTgnKQogICAgICAgIAogICAgICAgIHJldHVybiBsaWNlbnNlX2tleQoKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBwcmludChmIlshXSDliqDlr4bnlJ/miJDlpLHotKU6IHtlfSIpCiAgICByZXR1cm4gTm9uZQoKIyA9PT09PT09PT09PT09PT09PSDphY3nva7ljLrln58gPT09PT09PT09PT09PT09PT0KCk1ZX1BSSVZBVEVfS0VZID0gIiIiLS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBa3FiN1lLRlNvVmZ3cGpmWm96T2YrL0NCV1pyNTJpNnZHeHoycWlHaCtqeUI1STBmCndsU0s5aExJRmR4ZkpDZ25id25YNkc3RWFqMVhaN3pYRFdnN2lJSTdGRWl3SE1ObW9zS2dwTXNmbm9GRjhvdzQKVDQrcHptdllKUzBEU09ZTlp5VHpsMHdub0QwU2YyRmFmdnRsbHROdjh0TlpHU28vM205Z1RGN2gxWjZnZkpQagpud1lKV0ZrWU5icDhFTUtoZ3JqdTVYRWxKcVpJTEhmYmI0a09ReDlqSWY3NDVZTHN4ajhubEk3RmU0bitmTjJtCjVPdHdlVGo0NXpnWngzc0ZrbVBaMUJHUDRreFFTY0JYVXR5NnNjaW9Vc2tNWkRaTHZjMjEweDMyWkVMb0xhajMKcjFlem52dXJmSnQ4MVJBRXR0Q1E3dTFFMWo4cCtKbUNvODFNalFJREFRQUJBb0lCQVFDRkRUQjJMQWJ1MFAxSgpvTlE1Q0VaMjZtNUFvS1ZjZVF4dldlakUxRHpEN28rZWp4Y29WVkc2RGJJd2V6NXFiRy9TZ3lpNi9Yd0FNMlVRCmZqalNOaVlGSkxwN0hiT0NkUm15UTBoQ0d2TzE5KzFCTUV5S2lubnlDTkFTY25OUGVVRGh1cG15UStxVHE3VVQKa256clJpU1dJWUNvMjIwenNxdzluK2pMZ1MzOWcwd2tOWkRMa0t4dE11ZVROZk5wUlBxZC8zT05nMkNFK3IxVwpwaVNoRWJuZ2dQNVAyVWkyMkVXa1JVSzZpeDJ5VmZWdzdLVXdBQjBTVFRMTmJsNW1lYWRPTWUxdXRjb0syUmFQClNUZnlGMDA1S3IxcDkyby9RZWszNmllK1RVOEYvSm1xd1VFUHBITTdjcUVDOEc0b0dPdzNRYTdocXlnUDhXY3MKakJNaEEybGhBb0dCQU02R3NidDgyQnhsa0dqTDExNEJWUmlEVzMrYkJSYTN5VDlkT0hyZyswMFVLTUlZRmRwSQo0S3p3T3VZM3ViNStudGZHRVAwcVFvS01SVVJmTkJhSWNJZEx3d0dvck0zV1l4SkdTM3pzelc1bnlxNTY2WmowCjgxSkFKVFBSUWlxc3hXUDBUTFA2MWRJd0p3TmZTN3pMdFpiRnlvbFF0YjE4Mk1IWVA3M25GQ0FKQW9HQkFMWEkKZndrcStsRFQzNWRranh4QlhIb3Z6a1FxeHUySWhlUFZGVytzS1RuY2FSaDE4UHpTWTByY0trL0FuZVlYazBnUApnVXVDWmhZZGs3V29HWFJwa09sYW9XNTYzaDBRN0JDY1N5cVlmU2F6T2h1eTFWN3dCbkVSWXZNcGdOZEhyOS8rCmQwcHlySnJBQzdOTU5xN2s1TjcraFkyc0ZKWW1xN2RLcFk0YXY2RmxBb0dBY09rbkJtL3MzeW1QMkJ1SnRYVloKQnJ2YUxGdWVYcHRBUllvN3RNS0g0YzRoc212a2xxQzlaUTg1eEYrM0J6VEd0d1VzaUp5d0hCdUFTeThabFRBbgpCWEVnUGludnYrRno3S3ZOM1pEQmg1anJNSlUyWFUrZUw5dXQrelJ1emxJQzRQRFJkcHl1aGVtWmlyaHcrZGtOCmdFN0d1bWdMMUhzTExuK0I2ZHNLSDdFQ2dZRUFuWkFVZEhqWkVOZ2t0SStINytERGJIRWxZemFFeUh5T09PV0kKT0F4TWk0ZDlYS05WNTMzZ2JKR2E1eGU0aFNpb0UwekZNQkx0czN1ZGZWWWdBaVJDWTlHWG5UQklkMzhrYmwxYQpWYWhveWZPTmlWYWYxVE5ORWhJVTUxbHhBS2gxVER5L1h6czRXc1hkSG1NUC90WU5meSt6eVJGL29vb1FTc1liCjY2bEpzblVDZ1lBdXRjL3Q0UVBYeVVlL2FSVkc4ODBtMkdBWVBIYjNPcGFJUnRRdUNpQ0xlM2p6S0R0QnR4RFoKTXlQbWtUQ1g1Mk40SVExeDhuRlF3eWppdnJ1elNQOFVaYzBsSkJKMTJqNVpIckhrVHJIdXNnUk9qOHoySWRBOQpaZnkvUzF4ckRJb0IyZ01kOFh1OGh1M0FMS1ZDZjJWWGhBQnMvSmRYdHR2UUlYTXA4SzVzN2c9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQoiIiIKCiMgPT09PT09PT09PT09PT09PT0g5Li756iL5bqP5YWl5Y+jID09PT09PT09PT09PT09PT09CgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgcHJpbnQoIj09PSBVbml0eSBHYW1lIExpY2Vuc2UgVG9vbCAoRGVjcnlwdCAmIFJlLWVuY3J5cHQpID09PVxuIikKICAgIAogICAgIyAxLiDovpPlhaXliqDlr4ZJRCBjb2RlCiAgICB0YXJnZXRfZW5jcnlwdGVkX3N0ciA9ICcuLi4nCgogICAgcHJpbnQoIi0iICogNjApCiAgICBwcmludCgiU3RlcCAxOiDmraPlnKjlsJ3or5Xop6Plr4YuLi4iKQogICAgCiAgICAjIDIuIOiwg+eUqOino+WvhgogICAgZGVjcnlwdGVkX2RhdGEgPSBkZWNyeXB0X0lEY29kZShNWV9QUklWQVRFX0tFWSwgdGFyZ2V0X2VuY3J5cHRlZF9zdHIpCiAgICAKICAgIGlmIGRlY3J5cHRlZF9kYXRhOgogICAgICAgIHByaW50KCItIiAqIDYwKQogICAgICAgIHByaW50KCJTdGVwIDI6IOS9v+eUqOino+WvhuaVsOaNrumHjeaWsOWKoOWvhi4uLiIpCiAgICAgICAgCiAgICAgICAgIyDku47op6Plr4bmlbDmja7kuK3mj5Dlj5blrZfmrrUKICAgICAgICBkZXZpY2VfaWQgPSBkZWNyeXB0ZWRfZGF0YS5nZXQoImRldmljZV9pZGVudGlmaWVyIiwgIiIpCiAgICAgICAgcmFuZG9tX2Rpc2NvcmQgPSBkZWNyeXB0ZWRfZGF0YS5nZXQoInJhbmRvbV9kaXNjb3JkIiwgIiIpCiAgICAgICAgYXBwX3ZlcnNpb24gPSBkZWNyeXB0ZWRfZGF0YS5nZXQoImFwcF92ZXJzaW9uIiwgIiIpCiAgICAgICAgCiAgICAgICAgIyAzLiDph43mlrDliqDlr4YKICAgICAgICBuZXdfbGljZW5zZSA9IGdlbmVyYXRlX2xpY2Vuc2UoCiAgICAgICAgICAgIE1ZX1BSSVZBVEVfS0VZLCAKICAgICAgICAgICAgZGV2aWNlX2lkLCAKICAgICAgICAgICAgcmFuZG9tX2Rpc2NvcmQsIAogICAgICAgICAgICBhcHBfdmVyc2lvbgogICAgICAgICkKICAgICAgICAKICAgICAgICBpZiBuZXdfbGljZW5zZToKICAgICAgICAgICAgcHJpbnQoZiJcblsrXSDliqDlr4bmiJDlip/vvIFjb2Rl5aaC5LiL77yaIikKICAgICAgICAgICAgcHJpbnQoIi0iICogNjApCiAgICAgICAgICAgIHByaW50KG5ld19saWNlbnNlKQogICAgICAgICAgICBwcmludCgiLSIgKiA2MCk=</span><br></pre></td></tr></table></figure>
<h2 id="后记">后记</h2>
<p>我终于不用动控制流了……大概吧，控制流留给懂的人看就好。我老老实实（其实不然）按照步骤验证就行，反正程序也不知道，程序会认为我真的从bot那里获得了码。</p>
<p>看到RSA属实是虎躯一震，我一个搞密码学的最喜欢它，然后看到了私钥（）怎么会有这种事情，做梦都要笑醒。不过即使客户端只存了公钥也没关系，毕竟我可以改，自己生成一组密钥就行了，宗旨是提取出信息。</p>
<p>这种邪恶的方法肯定不是我先想到的(×)从<a target="_blank" rel="noopener" href="https://www.52pojie.cn/forum.php?mod=viewthread&amp;tid=2062393">这里</a>得到的灵感，第一次看到也是惊为天人，再加上这里密钥全是可打印字符串，更好动手脚了。希望这个方法能存活久一点喵~</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://xelinquency.github.io/">Illunight</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://xelinquency.github.io/2026/01/29/%E8%AE%B0%E6%9F%90%E6%B8%B8%E6%88%8F%E7%99%BB%E5%BD%95%E9%AA%8C%E8%AF%81%E5%88%86%E6%9E%90/">https://xelinquency.github.io/2026/01/29/%E8%AE%B0%E6%9F%90%E6%B8%B8%E6%88%8F%E7%99%BB%E5%BD%95%E9%AA%8C%E8%AF%81%E5%88%86%E6%9E%90/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://XELINQUENCY.github.io" target="_blank">Illunight的收藏品</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/2026/">2026</a><a class="post-meta__tags" href="/tags/Reverse/">Reverse</a></div><div class="post-share"><div class="social-share" data-image="/img/404.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related  no-desc" href="/2025/11/26/%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E6%94%BB%E5%87%BB%E5%AE%9E%E9%AA%8C/" title="缓冲区溢出攻击实验"><img class="cover" src="/img/404.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">缓冲区溢出攻击实验</div></div></div></a><a class="pagination-related  no-desc" href="/2026/02/04/2026FurryCTF%E9%A2%98%E8%A7%A3/" title="2026FurryCTF题解"><img class="cover" src="/img/404.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">2026FurryCTF题解</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related no-desc" href="/2026/02/04/2026FurryCTF%E9%A2%98%E8%A7%A3/" title="2026FurryCTF题解"><img class="cover" src="/img/404.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-04</div><div class="info-item-2">2026FurryCTF题解</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/icon.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Illunight</div><div class="author-info-description">CTF, Furry and others</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">12</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div><a id="card-info-btn"><i></i><span>点开看看这是个啥</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/XELINQUENCY" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://res.abeim.cn/api/qq/?qq=3778180207" target="_blank" title="QQ"><i class="fab fa-qq" style="color: #302425;"></i></a><a class="social-icon" href="mailto:xelinquency@outlook.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">子雨的碎碎念博客！启用于2025年7月</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%80%81%E5%B8%88%E6%88%91%E4%B8%8D%E6%83%B3%E5%86%8D%E7%9C%8B%E5%88%B0sub-xxx%E4%BA%86"><span class="toc-number">1.</span> <span class="toc-text">老师我不想再看到sub_xxx了</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BF%AB%E5%AD%A6%E5%95%8AIDA"><span class="toc-number">2.</span> <span class="toc-text">快学啊IDA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%88%91%E4%BB%AC%E7%9A%84%E7%9B%AE%E6%A0%87%E6%98%AF%EF%BC%9ADiscord%E9%AA%8C%E8%AF%81%EF%BC%81"><span class="toc-number">3.</span> <span class="toc-text">我们的目标是：Discord验证！</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%95%BF%E5%BA%A6%E4%B8%BA0"><span class="toc-number">3.1.</span> <span class="toc-text">字符串长度为0</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A3%E5%B8%B8%E6%AF%94%E5%AF%B9"><span class="toc-number">3.2.</span> <span class="toc-text">正常比对</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AA%8C%E8%AF%81%E6%96%B9%E6%B3%95"><span class="toc-number">3.3.</span> <span class="toc-text">验证方法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ID-code%EF%BC%9F%E4%BC%BC%E6%98%AF%E6%95%85%E4%BA%BA%E6%9D%A5"><span class="toc-number">4.</span> <span class="toc-text">ID code？似是故人来</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%EF%BC%8CLook-at-me"><span class="toc-number">5.</span> <span class="toc-text">字符串，Look at me!</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%8E%E8%AE%B0"><span class="toc-number">6.</span> <span class="toc-text">后记</span></a></li></ol></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;2025 - 2026 By Illunight</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.2</a></span></div><div class="footer_custom_text">幻夜子雨想要留下flag{Th4nk5_f0R_V1siTing!}</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><div class="js-pjax"><script>(() => {
  const loadMathjax = () => {
    if (!window.MathJax) {
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          tags: 'none',
        },
        chtml: {
          scale: 1.1
        },
        options: {
          enableMenu: true,
          renderActions: {
            findScript: [10, doc => {
              for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
                const display = !!node.type.match(/; *mode=display/)
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
                const text = document.createTextNode('')
                node.parentNode.replaceChild(text, node)
                math.start = {node: text, delim: '', n: 0}
                math.end = {node: text, delim: '', n: 0}
                doc.math.push(math)
              }
            }, '']
          }
        }
      }

      const script = document.createElement('script')
      script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
      script.id = 'MathJax-script'
      script.async = true
      document.head.appendChild(script)
    } else {
      MathJax.startup.document.state(0)
      MathJax.texReset()
      MathJax.typesetPromise()
    }
  }

  btf.addGlobalFn('encrypt', loadMathjax, 'mathjax')
  window.pjax ? loadMathjax() : window.addEventListener('load', loadMathjax)
})()</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>(() => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => fn())
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      const usePjax = true
      true
        ? (usePjax ? pjax.loadUrl('/404.html') : window.location.href = '/404.html')
        : window.location.href = e.request.responseURL
    }
  })
})()</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="在知识的荒原里找到你需要的" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>